import{s as Yt,o as Qt,n as $t}from"../chunks/scheduler.18a86fab.js";import{S as St,i as xt,g as n,s as t,r as U,A as zt,h as y,f as s,c as a,j as Xt,u as o,x as i,k as Et,y as Lt,a as M,v as p,d as w,t as d,w as T}from"../chunks/index.98837b22.js";import{T as Vt}from"../chunks/Tip.77304350.js";import{C as c}from"../chunks/CodeBlock.8d0c2e8a.js";import{H as J,E as Ht}from"../chunks/getInferenceSnippets.06c2775f.js";function Ft(Ie){let C,r="Modular Transformers isn’t meant to replace the modeling code, and if your model isn’t based on an existing model, you’ll need to add a <code>modeling.py</code> file manually. Likewise, if a configuration, tokenization or processing file can’t easily inherit from a similar file, you can add that file directly.";return{c(){C=n("p"),C.innerHTML=r},l(j){C=y(j,"P",{"data-svelte-h":!0}),i(C)!=="svelte-1wc3n5d"&&(C.innerHTML=r)},m(j,m){M(j,C,m)},p:$t,d(j){j&&s(C)}}}function Ot(Ie){let C,r='Refer to the <a href="./auto_docstring">Documeting a model</a> guide for more information about how you can use the <code>@auto_docstring</code> decorator to help automatically generate consistent docstring arguments.';return{c(){C=n("p"),C.innerHTML=r},l(j){C=y(j,"P",{"data-svelte-h":!0}),i(C)!=="svelte-194dxdw"&&(C.innerHTML=r)},m(j,m){M(j,C,m)},p:$t,d(j){j&&s(C)}}}function Dt(Ie){let C,r,j,m,u,fe,f,AM="Modular Transformers lowers the bar for contributing models and significantly reduces the code required to add a model by allowing imports and inheritance.",be,b,_M='One of Transformers’ core design feature is the <a href="https://huggingface.co/blog/transformers-design-philosophy" rel="nofollow">single model, single file</a> policy. Model components - such as attention layers - are repeated across many files and any independent implementations tend to diverge as fixes and changes are applied to specific parts of the code.',Ae,A,ZM='The <a href="./pr_checks#check-copies"><code># Copied from</code></a> statements prevents the code from diverging, and it is enforced by our continuous integration tests and local commands. The downside is that this approach is tedious and adds significantly more lines of code, most of which is boilerplate.',_e,_,Ze,Z,GM="Modular Transformers addresses these issues by adding a <em>modular</em> file to a model folder. The modular file can import code from other models and inherit code from other classes unlike traditional modeling and processing files.",Ge,h,Be,G,BM="A modular file contains model, processor, and configuration class code that would otherwise be in separate files under the single model, single file policy.",ke,B,kM="Model users still import and use the single-file interface they’ve grown familiar with. In doing so, we hope to enable simpler contributions while sticking to our philosophy.",Re,k,ge,R,RM="A linter “unravels” the modular file into a <code>modeling.py</code> file to preserve the single model, single file directory structure (modeling, processor, etc.). Inheritance is flattened to only a <strong>single</strong> level.",ve,g,gM="Run the command below to automatically generate a <code>modeling.py</code> file from a modular file (assuming the snake lowercase name of the model you want to convert is <code>your_model</code>).",We,v,Ne,W,vM="For example:",Xe,N,WM="<li>If a configuration class inherits from another class, but adds and deletes an argument, the generated file directly references it if an argument is added or completely removes it if an argument is deleted.</li> <li>If a class inherits from another, like <code>GemmaModel(LlamaModel)</code>, the dependencies are automatically inferred. All submodules are also automatically inferred from the superclass.</li> <li>If a new function is defined in the modular file and used inside classes, the linter automatically infers these as well.</li>",Ee,X,NM="You should be able to write everything (tokenizer, image processor, model, config, etc.) in a modular and their corresponding single-files are generated.",Ve,E,XM="The example below demonstrates how a model can be added with significantly fewer lines of code with Modular Transformers.",$e,V,Ye,$,EM="BERT and RoBERTa, two very similar models, differ solely in how the embedding layer is implemented.",Qe,Y,VM="Instead of redefining the model entirely, consider the <code>modular_roberta.py</code> file shown below for the modeling and configuration classes (the tokenizer isn’t shown in this example).",Se,Q,xe,S,$M="If you don’t use the defined dependency, you’ll receive the following error.",ze,x,Le,z,He,L,YM='The easiest way to start is by browsing Transformers for a model similar to yours in order to inherit from it. Some good starting points are <a href="./model_doc/mistral">Mistral</a>, <a href="./model_doc/qwen2">Qwen2</a>, <a href="./model_doc/cohere">Cohere</a> and <a href="./model_doc/cohere2">Cohere2</a>, and <a href="./model_doc/llama">Llama</a>. Refer to the table below for components your model might be using and where you can inherit from.',Fe,H,QM="<thead><tr><th>Component</th> <th>Model</th></tr></thead> <tbody><tr><td>Mixture of expert</td> <td>SwitchTransformers or Mixtral</td></tr> <tr><td>Interleaved (and/or partial) rotary embedding</td> <td>GLM, Phi</td></tr> <tr><td>State space models</td> <td>Jamba, Bamba, Zamba, Mamba2</td></tr> <tr><td>Recurrent hidden states</td> <td>Gemma2</td></tr> <tr><td>Sliding window attention/full attention patterns per layer</td> <td>Gemma2, Cohere2</td></tr> <tr><td>QKV clipping</td> <td>Olmo</td></tr> <tr><td>QK normalization</td> <td>Olmo2, Cohere</td></tr> <tr><td>Fused QKV (not recommended)</td> <td>Phi3</td></tr></tbody>",Oe,F,SM='This section will walk you through how to implement <a href="./model_doc/olmo2">Olmo2</a> from <a href="./model_doc/olmo">Olmo</a> with modular Transformers (you can refer to the original <a href="https://github.com/huggingface/transformers/blob/main/src/transformers/models/olmo2/modular_olmo2.py" rel="nofollow">modeling.py</a> file).',De,O,Pe,D,xM="The modular <code>Olmo2Config</code> is shown below.",Ke,P,qe,K,zM="There are three points where the <code>Olmo2Config</code> is different from the original <code>OlmoConfig</code>.",ls,q,LM="<li>The default value of most arguments have changed.</li> <li>There is a new argument, <code>rms_norm_eps</code>.</li> <li>The <code>clip_qkv</code> argument isn’t used anymore.</li>",es,ll,HM="For the new default values and argument, overwrite the <code>__init__</code> function with the new default values and add <code>rms_norm_eps</code>. Assign <code>rms_norm_eps</code> to <code>self</code> in the body of <code>__init__</code>. For the <code>clip_qkv</code> argument, use <code>del self.clip_qkv</code> to remove the assignment of this attribute in the unraveled code (post-linter conversion).",ss,el,FM="Notice how the <code>super().__init__(...)</code> is used. Typically, it calls the parent <code>__init__</code>.",Ms,sl,OM="But in modular Transformers, if there is a call like <code>super().my_function(...)</code>, the linter takes the body of <code>my_function</code> in the parent and unravels it where the call to <code>super().my_function(...)</code> occurred. The <code>del self.clip_qkv</code> statement removes the reference to <code>self.clip_qkv</code> in the unraveled body.",ts,Ml,DM="<code>del self.</code> and <code>super().my_function(..)</code> work together, and it should always be placed after <code>super().my_function(...)</code>. You can add whatever you want <em>before</em> calling <code>super()</code>, and it is placed before the parents body.",as,tl,ns,al,ys,nl,PM="Nothing needs to be modified in <code>LlamaRMSNorm</code>. The linter unravels the exact content of <code>LlamaRMSNorm</code> into <code>Olmo2RMSNorm</code>. References to Llama in the docstrings, type hints, and comments are also changed to Olmo2.",is,yl,Us,il,KM="The modular <code>Olmo2Attention</code> is shown below.",os,Ul,ps,ol,qM="The <code>super().__init__(...)</code> copies the parent definition and adds 2 new layers from <code>Olmo2RMSNorm</code>. The forward pass needs to be overwritten to use these 2 new layers. A pass with the norm layers is added before projecting with <code>q_proj</code> and <code>k_proj</code>. To make it easier, the <code>eager_attention_forward</code> function is directly imported from Llama and the <code>apply_rotary_pos_emb</code> is imported from Olmo.",ws,pl,lt="The linter automatically adds these imported functions in the final <code>modeling_olmo2.py</code> file by copying their definitions from the source files. The <code>rotate_half</code> and <code>repeat_kv</code> functions are also added because they are used inside <code>apply_rotary_pos_emb</code> and <code>eager_attention_forward</code>.",ds,wl,et="The <code>Attention</code> class had to be redefined because there weren’t any existing models with an <code>Attention</code> layer that included a <code>RMSNorm</code> layer.",Ts,dl,Cs,Tl,st="The modular <code>DecoderLayer</code> is shown below.",cs,Cl,Js,cl,Mt="The norm type is switched in <code>__init__</code> by overwriting <code>self.post_attention_layernorm</code> after the call to <code>super().__init__(...)</code>. Delete the <code>self.input_layernorm</code> attributed and replace it with <code>self.post_feedforward_layernorm</code> because it is applied after in Olmo2. The forward method is overwritten to reflect this change.",js,Jl,tt="If you only switched <code>self.post_feedforward_layernorm</code> and <code>self.input_layernorm</code> from <code>LayerNorm</code> to <code>RMSNorm</code> without also changing the name and logic of <code>self.input_layernorm</code>, then you wouldn’t have to rewrite the forward method.",rs,jl,ms,rl,at="The modular <code>Olmo2Model</code> class is shown below.",hs,ml,Is,hl,nt="You only need to change the <em>type</em> of the <code>self.norm</code> attribute to use <code>RMSNorm</code> instead of <code>LayerNorm</code>. This change doesn’t affect the logic in the forward method (layer name and usage is identical to the parent class), so you don’t need to overwrite it. The linter automatically unravels it.",us,Il,fs,ul,yt="The modular causal modeling head is shown below.",bs,fl,As,bl,it="The logic is identical to <code>OlmoForCausalLM</code> which means you don’t need to make any changes here.",_s,Al,Zs,_l,Ut='The <a href="https://github.com/huggingface/transformers/blob/main/src/transformers/models/olmo2/modeling_olmo2.py" rel="nofollow">modeling_olmo2.py</a> generated by the linter also contains some classes (<code>Olmo2MLP</code>, <code>Olmo2RotaryEmbedding</code>, <code>Olmo2PreTrainedModel</code>) that weren’t explicitly defined in <code>modular_olmo2.py</code>.',Gs,Zl,ot="Classes that are a dependency of an inherited class but aren’t explicitly defined are automatically added as a part of dependency tracing. This is similar to how some functions were added to the <code>Attention</code> class without directly importing them.",Bs,Gl,pt="For example, <code>OlmoDecoderLayer</code> has an attribute defined as <code>self.mlp = OlmoMLP(config)</code>. This class was never explicitly redefined in <code>Olmo2MLP</code>, so the linter automatically created a <code>Olmo2MLP</code> class similar to <code>OlmoMLP</code>. It is identical to the code below if it was explicitly written in <code>modular_olmo2.py</code>.",ks,Bl,Rs,kl,wt="However, it was necessary to rewrite <code>Olmo2RMSNorm</code> because the layer norm needed to be redefined in the <code>Attention</code> and <code>DecoderLayer</code> classes. Similarly, this is why you didn’t need to create the <code>Olmo2PreTrainedModel</code> and <code>Olmo2RotaryEmbedding</code> classes.",gs,Rl,dt="Classes that aren’t rewritten are copied from the file where the inherited module first uses them. This means if you wanted <code>Olmo2MLP</code> to inherit from <code>MistralMLP</code> instead, you would need to be more explicit as shown below.",vs,gl,Ws,vl,Ns,Wl,Tt="You can <code>del</code> to remove attributes defined in the parent after using <code>super().__init__()</code>. However, this doesn’t work if the attribute is also used somewhere else as shown below. It only suppresses the assignment. The <code>self.attribute = config.attribute</code> line is removed, but the <code>if</code> statement remains and references the attribute.",Xs,Nl,Es,Xl,Vs,El,Ct="If you want to inherit from a module <code>DummyModule</code> and want to call <code>super()</code> WITHOUT unravelling the parent’s code (that is, you want to call <code>super()</code> on the <em>generated</em> class parent), be explicit about which class’ <code>super()</code> you’re calling. The example below shows how to call the <code>super()</code> of <code>nn.Module</code> (unraveled code shown on the right). In this example, as <code>DummyModule</code> is itself a <code>nn.Module</code>, it makes sense to call <code>nn.Module.__init__(self)</code> as it’s what was the initial intention. It’s then unravelled as <code>super()</code> in <code>MyNewDummyModule</code> to follow Python’s best-practices.",$s,Vl,Ys,$l,Qs,Yl,ct="Remove an attribute by overwriting it with a <code>raise AttributeError(&quot;&quot;)</code> statement to mimic the behavior you want when you remove a parent function in Python. The example below removes the methods in the unraveled code.",Ss,Ql,xs,Sl,zs,xl,Jt="By default, if you inherit from a class and override a method with one or more decorators in the parent method, the decorators are also added to the unraveled code <em>only if you don’t add any yourself</em>. Otherwise, the redefined decorator is used.",Ls,zl,jt="For example, if you had a parent class shown below and you overwrite it, the parent decorator is kept.",Hs,Ll,Fs,Hl,rt="Modular code is shown on the left, and the unraveled code is shown on the right.",Os,Fl,Ds,Ol,mt="But if you add a new decorator, your new decorator is used instead.",Ps,Dl,Ks,Pl,qs,Kl,ht="In scenarios where a forward method is really long and you want to switch decorators, you don’t need to redefine everything and copy/paste the function. You can use <code>super().forward(...)</code> to unravel the parent body. When there are a lot of arguments in the function signature, use the special <code>**super_kwargs</code> syntax in the overwritten signature.",lM,ql,It='This syntax indicates to the linter to unravel all the parent signature arguments here. An example signature in a <a href="/docs/transformers/v4.56.2/en/model_doc/auto#transformers.AutoModelForCausalLM">AutoModelForCausalLM</a> model is shown below, with lots of arguments.',eM,le,sM,ee,ut="Instead of rewriting and copying/pasting all of those arguments, use the <code>super().forward(**super_kwargs)</code> statement (modular code shown on the left, unraveled code on the right).",MM,se,tM,Me,ft="This makes it very easy to switch decorators and makes it explicit that the only change you want to apply is the decorator.",aM,te,bt="<code>**super_kwargs</code> should not be used to avoid being explicit when redefining methods though. If you overwrite a method, you should explicitly write the signature as you normally would. The <code>**super_kwargs</code> syntax is a shortcut for switching decorators and a few other niche cases.",nM,ae,yM,I,iM,ne,At="If an object defined in both the modular and modeling file from which it inherits, the modular definition has precedence unless for assignments containing the pattern <code>DOCSTRING</code>. These variables are typically used in <code>MODEL_START_DOCSTRING</code> and <code>MODEL_INPUT_DOCSTRING</code> in the modeling files. They are big blocks of docstrings and the linter rewrites the names everywhere. For this reason, assignments containing the <code>DOCSTRING</code> variable can use the definition found in the source file without copying the whole docstring, by simply setting the variable to <code>None</code> in the modular file.",UM,ye,_t='This is very useful if you need the variable reference somewhere but you don’t want to clutter the modular file with docstrings which are always the same. The example code below allows you to automatically use the same docstrings from <a href="./model_doc/mistral">Mistral</a> in <a href="./model_doc/starcoder2">Starcoder2</a>.',oM,ie,pM,Ue,Zt="Setting the variable to anything other than <code>None</code> will override the docstring, so that you can customize the docstrings if needed.",wM,oe,dM,pe,Gt="The linter automatically renames everything when inheriting from a class. For consistency, you should always use the same class name prefix when inheriting from different classes from the same file.",TM,we,Bt="The example below is not recommended. It breaks standards in the library, <code>MyModelIncredibleMLP</code> instead of <code>LlamaMLP</code>, and because the linter doesn’t know how to rename potential higher-order dependencies (<code>MyModelIncredible</code> or just <code>MyModel</code>).",CM,de,cM,Te,kt='However, if there aren’t any <a href="#other-classes">implicit dependencies</a>, then you can locally rename a single class. Make sure you still explicitly redefine every other mention of the class with the new name pattern though. For example, all mentions of <code>LlamaMLP</code> should be renamed to <code>MyModelIncredibleMLP</code> otherwise the linter may add a new and unwanted <code>MyModelMLP</code> class.',JM,Ce,Rt="The linter raises a warning if an ambiguous case is detected. It explains what is happening and which prefix is used by default for getting the dependencies. These warning and renaming pattern complications usually only come up when defining multimodal models. For example, adding <code>Text</code> to class names in a multimodal model to make it clear which modality it refers to.",jM,ce,rM,Je,gt="If there are automatic dependencies with a prefix, but you want another one, explicitly rename the classes locally with a <code>pass</code> class as shown in the following.",mM,je,hM,re,IM,me,vt="When inheriting a <code>Config</code> class or adding and deleting attributes, you may want to only redefine the new attributes in the docstring. However, the linter doesn’t support this yet. You need to directly add the while docstring directly in the modular file under the class definition.",uM,he,fM,ue,bM;return u=new J({props:{title:"Contributing a new model to Transformers",local:"contributing-a-new-model-to-transformers",headingTag:"h1"}}),_=new J({props:{title:"Motivation",local:"motivation",headingTag:"h2"}}),h=new Vt({props:{warning:!1,$$slots:{default:[Ft]},$$scope:{ctx:Ie}}}),k=new J({props:{title:"Create a modeling.py file",local:"create-a-modelingpy-file",headingTag:"h2"}}),v=new c({props:{code:"cHl0aG9uJTIwdXRpbHMlMkZtb2R1bGFyX21vZGVsX2NvbnZlcnRlci5weSUyMCUyMHlvdXJfbW9kZWw=",highlighted:"python utils/modular_model_converter.py  your_model",wrap:!1}}),V=new J({props:{title:"BERT and RoBERTa",local:"bert-and-roberta",headingTag:"h3"}}),Q=new c({props:{code:"ZnJvbSUyMHRvcmNoJTIwaW1wb3J0JTIwbm4lMEFmcm9tJTIwLi5iZXJ0LmNvbmZpZ3VyYXRpb25fYmVydCUyMGltcG9ydCUyMEJlcnRDb25maWclMEFmcm9tJTIwLi5iZXJ0Lm1vZGVsaW5nX2JlcnQlMjBpbXBvcnQlMjAoJTBBJTIwJTIwJTIwJTIwQmVydE1vZGVsJTJDJTBBJTIwJTIwJTIwJTIwQmVydEVtYmVkZGluZ3MlMkMlMEElMjAlMjAlMjAlMjBCZXJ0Rm9yTWFza2VkTE0lMEEpJTBBJTBBJTIzJTIwUm9CRVJUYSUyMGFuZCUyMEJFUlQlMjBjb25maWclMjBpcyUyMGlkZW50aWNhbCUwQWNsYXNzJTIwUm9iZXJ0YUNvbmZpZyhCZXJ0Q29uZmlnKSUzQSUwQSUyMCUyMG1vZGVsX3R5cGUlMjAlM0QlMjAncm9iZXJ0YSclMEElMEElMjMlMjBSZWRlZmluZSUyMHRoZSUyMGVtYmVkZGluZ3MlMjB0byUyMGhpZ2hsaWdodCUyMHRoZSUyMHBhZGRpbmclMjBpZCUyMGRpZmZlcmVuY2UlMkMlMjBhbmQlMjByZWRlZmluZSUyMHRoZSUyMHBvc2l0aW9uJTIwZW1iZWRkaW5ncyUwQWNsYXNzJTIwUm9iZXJ0YUVtYmVkZGluZ3MoQmVydEVtYmVkZGluZ3MpJTNBJTBBJTIwJTIwJTIwJTIwZGVmJTIwX19pbml0X18oc2VsZiUyQyUyMGNvbmZpZyklM0ElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzdXBlcigpLl9faW5pdF9fKGNvbmZpZygpKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYucGFkZGluZ19pZHglMjAlM0QlMjBjb25maWcucGFkX3Rva2VuX2lkJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwc2VsZi5wb3NpdGlvbl9lbWJlZGRpbmdzJTIwJTNEJTIwbm4uRW1iZWRkaW5nKCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGNvbmZpZy5tYXhfcG9zaXRpb25fZW1iZWRkaW5ncyUyQyUyMGNvbmZpZy5oaWRkZW5fc2l6ZSUyQyUyMHBhZGRpbmdfaWR4JTNEc2VsZi5wYWRkaW5nX2lkeCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCklMEElMEElMjMlMjBSb0JFUlRhJTIwYW5kJTIwQkVSVCUyMG1vZGVsJTIwaXMlMjBpZGVudGljYWwlMjBleGNlcHQlMjBmb3IlMjB0aGUlMjBlbWJlZGRpbmclMjBsYXllciUyQyUyMHdoaWNoJTIwaXMlMjBkZWZpbmVkJTIwYWJvdmUlMkMlMjBzbyUyMG5vJTIwbmVlZCUyMGZvciUyMGFkZGl0aW9uYWwlMjBjaGFuZ2VzJTIwaGVyZSUwQWNsYXNzJTIwUm9iZXJ0YU1vZGVsKEJlcnRNb2RlbCklM0ElMEElMjAlMjBkZWYlMjBfX2luaXRfXyhzZWxmJTJDJTIwY29uZmlnKSUzQSUwQSUyMCUyMCUyMCUyMHN1cGVyKCkuX19pbml0X18oY29uZmlnKSUwQSUyMCUyMCUyMCUyMHNlbGYuZW1iZWRkaW5ncyUyMCUzRCUyMFJvYmVydGFFbWJlZGRpbmdzKGNvbmZpZyklMEElMEElMEElMjMlMjBUaGUlMjBtb2RlbCUyMGhlYWRzJTIwbm93JTIwb25seSUyMG5lZWQlMjB0byUyMHJlZGVmaW5lJTIwdGhlJTIwbW9kZWwlMjBpbnNpZGUlMjB0byUyMCU2MFJvYmVydGFNb2RlbCU2MCUwQWNsYXNzJTIwUm9iZXJ0YUZvck1hc2tlZExNKEJlcnRGb3JNYXNrZWRMTSklM0ElMEElMjAlMjBkZWYlMjBfX2luaXRfXyhzZWxmJTJDJTIwY29uZmlnKSUzQSUwQSUyMCUyMCUyMCUyMHN1cGVyKCkuX19pbml0X18oY29uZmlnKSUwQSUyMCUyMCUyMCUyMHNlbGYubW9kZWwlMjAlM0QlMjBSb2JlcnRhTW9kZWwoY29uZmlnKQ==",highlighted:`<span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn
<span class="hljs-keyword">from</span> ..bert.configuration_bert <span class="hljs-keyword">import</span> BertConfig
<span class="hljs-keyword">from</span> ..bert.modeling_bert <span class="hljs-keyword">import</span> (
    BertModel,
    BertEmbeddings,
    BertForMaskedLM
)

<span class="hljs-comment"># RoBERTa and BERT config is identical</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RobertaConfig</span>(<span class="hljs-title class_ inherited__">BertConfig</span>):
  model_type = <span class="hljs-string">&#x27;roberta&#x27;</span>

<span class="hljs-comment"># Redefine the embeddings to highlight the padding id difference, and redefine the position embeddings</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RobertaEmbeddings</span>(<span class="hljs-title class_ inherited__">BertEmbeddings</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
        <span class="hljs-built_in">super</span>().__init__(config())

        self.padding_idx = config.pad_token_id
        self.position_embeddings = nn.Embedding(
            config.max_position_embeddings, config.hidden_size, padding_idx=self.padding_idx
        )

<span class="hljs-comment"># RoBERTa and BERT model is identical except for the embedding layer, which is defined above, so no need for additional changes here</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RobertaModel</span>(<span class="hljs-title class_ inherited__">BertModel</span>):
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
    <span class="hljs-built_in">super</span>().__init__(config)
    self.embeddings = RobertaEmbeddings(config)


<span class="hljs-comment"># The model heads now only need to redefine the model inside to \`RobertaModel\`</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RobertaForMaskedLM</span>(<span class="hljs-title class_ inherited__">BertForMaskedLM</span>):
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
    <span class="hljs-built_in">super</span>().__init__(config)
    self.model = RobertaModel(config)`,wrap:!1}}),x=new c({props:{code:"VmFsdWVFcnJvciUzQSUyMFlvdSUyMGRlZmluZWQlMjAlNjBSb2JlcnRhRW1iZWRkaW5ncyU2MCUyMGluJTIwdGhlJTIwbW9kdWxhcl9yb2JlcnRhLnB5JTJDJTIwaXQlMjBzaG91bGQlMjBiZSUyMHVzZWQlMjB3aGVuJTIweW91JTIwZGVmaW5lJTIwJTYwQmVydE1vZGVsJTYwJTJDJTIwYXMlMjBpdCUyMGlzJTIwb25lJTIwb2YlMjBpdCdzJTIwZGlyZWN0JTIwZGVwZW5kZW5jaWVzLiUyME1ha2UlMjBzdXJlJTIweW91JTIwdXNlJTIwaXQlMjBpbiUyMHRoZSUyMCU2MF9faW5pdF9fJTYwJTIwZnVuY3Rpb24u",highlighted:'<span class="hljs-symbol">ValueError:</span> You defined `RobertaEmbeddings` <span class="hljs-keyword">in</span> the modular_roberta.py, it should be used <span class="hljs-keyword">when</span> you define `BertModel`, <span class="hljs-keyword">as</span> it <span class="hljs-built_in">is</span> one <span class="hljs-keyword">of</span> it<span class="hljs-comment">&#x27;s direct dependencies. Make sure you use it in the `__init__` function.</span>',wrap:!1}}),z=new J({props:{title:"Implementing a modular file",local:"implementing-a-modular-file",headingTag:"h2"}}),O=new J({props:{title:"Config",local:"config",headingTag:"h3"}}),P=new c({props:{code:"ZnJvbSUyMC4ub2xtby5jb25maWd1cmF0aW9uX29sbW8lMjBpbXBvcnQlMjBPbG1vQ29uZmlnJTBBJTBBY2xhc3MlMjBPbG1vMkNvbmZpZyhPbG1vQ29uZmlnKSUzQSUwQSUyMCUyMCUyMCUyMHIlMjIlMjIlMjIlMEElMjAlMjAlMjAlMjBUaGlzJTIwaXMlMjB0aGUlMjBjb25maWd1cmF0aW9uJTIwY2xhc3MlMjB0byUyMHN0b3JlJTIwdGhlJTIwY29uZmlndXJhdGlvbiUyMG9mJTIwYSUyMCU1Qk9sbW8yTW9kZWwlNUQoJTJGZG9jcyUyRnRyYW5zZm9ybWVycyUyRm1haW4lMkZlbiUyRm1vZGVsX2RvYyUyRm9sbW8yJTIzdHJhbnNmb3JtZXJzLk9sbW8yTW9kZWwpLiUwQSUyMCUyMCUyMCUyMCUyMiUyMiUyMiUwQSUwQSUyMCUyMCUyMCUyMGRlZiUyMF9faW5pdF9fKCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjB2b2NhYl9zaXplJTNENTAzMDQlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc2l6ZSUzRDQwOTYlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBpbnRlcm1lZGlhdGVfc2l6ZSUzRDExMDA4JTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwbnVtX2hpZGRlbl9sYXllcnMlM0QzMiUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMG51bV9hdHRlbnRpb25faGVhZHMlM0QzMiUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMG51bV9rZXlfdmFsdWVfaGVhZHMlM0ROb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX2FjdCUzRCUyMnNpbHUlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBtYXhfcG9zaXRpb25fZW1iZWRkaW5ncyUzRDIwNDglMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBpbml0aWFsaXplcl9yYW5nZSUzRDAuMDIlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjB1c2VfY2FjaGUlM0RUcnVlJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcGFkX3Rva2VuX2lkJTNEMSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGJvc190b2tlbl9pZCUzRE5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBlb3NfdG9rZW5faWQlM0Q1MDI3OSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHRpZV93b3JkX2VtYmVkZGluZ3MlM0RGYWxzZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJvcGVfdGhldGElM0QxMDAwMC4wJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcm9wZV9zY2FsaW5nJTNETm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dGVudGlvbl9iaWFzJTNERmFsc2UlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBhdHRlbnRpb25fZHJvcG91dCUzRDAuMCUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJtc19ub3JtX2VwcyUzRDFlLTUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAqKmt3YXJncyUyQyUwQSUyMCUyMCUyMCUyMCklM0ElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzdXBlcigpLl9faW5pdF9fKCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHZvY2FiX3NpemUlM0R2b2NhYl9zaXplJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX3NpemUlM0RoaWRkZW5fc2l6ZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGludGVybWVkaWF0ZV9zaXplJTNEaW50ZXJtZWRpYXRlX3NpemUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBudW1faGlkZGVuX2xheWVycyUzRG51bV9oaWRkZW5fbGF5ZXJzJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwbnVtX2F0dGVudGlvbl9oZWFkcyUzRG51bV9hdHRlbnRpb25faGVhZHMlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBudW1fa2V5X3ZhbHVlX2hlYWRzJTNEbnVtX2tleV92YWx1ZV9oZWFkcyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGhpZGRlbl9hY3QlM0RoaWRkZW5fYWN0JTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwbWF4X3Bvc2l0aW9uX2VtYmVkZGluZ3MlM0RtYXhfcG9zaXRpb25fZW1iZWRkaW5ncyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGluaXRpYWxpemVyX3JhbmdlJTNEaW5pdGlhbGl6ZXJfcmFuZ2UlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjB1c2VfY2FjaGUlM0R1c2VfY2FjaGUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBwYWRfdG9rZW5faWQlM0RwYWRfdG9rZW5faWQlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBib3NfdG9rZW5faWQlM0Rib3NfdG9rZW5faWQlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBlb3NfdG9rZW5faWQlM0Rlb3NfdG9rZW5faWQlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjB0aWVfd29yZF9lbWJlZGRpbmdzJTNEdGllX3dvcmRfZW1iZWRkaW5ncyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJvcGVfdGhldGElM0Ryb3BlX3RoZXRhJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcm9wZV9zY2FsaW5nJTNEcm9wZV9zY2FsaW5nJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwYXR0ZW50aW9uX2JpYXMlM0RhdHRlbnRpb25fYmlhcyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dGVudGlvbl9kcm9wb3V0JTNEYXR0ZW50aW9uX2Ryb3BvdXQlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAqKmt3YXJncyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCklMEElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzZWxmLnJtc19ub3JtX2VwcyUyMCUzRCUyMHJtc19ub3JtX2VwcyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGRlbCUyMHNlbGYuY2xpcF9xa3Y=",highlighted:`<span class="hljs-keyword">from</span> ..olmo.configuration_olmo <span class="hljs-keyword">import</span> OlmoConfig

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2Config</span>(<span class="hljs-title class_ inherited__">OlmoConfig</span>):
    <span class="hljs-string">r&quot;&quot;&quot;
    This is the configuration class to store the configuration of a [Olmo2Model](/docs/transformers/main/en/model_doc/olmo2#transformers.Olmo2Model).
    &quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">
        self,
        vocab_size=<span class="hljs-number">50304</span>,
        hidden_size=<span class="hljs-number">4096</span>,
        intermediate_size=<span class="hljs-number">11008</span>,
        num_hidden_layers=<span class="hljs-number">32</span>,
        num_attention_heads=<span class="hljs-number">32</span>,
        num_key_value_heads=<span class="hljs-literal">None</span>,
        hidden_act=<span class="hljs-string">&quot;silu&quot;</span>,
        max_position_embeddings=<span class="hljs-number">2048</span>,
        initializer_range=<span class="hljs-number">0.02</span>,
        use_cache=<span class="hljs-literal">True</span>,
        pad_token_id=<span class="hljs-number">1</span>,
        bos_token_id=<span class="hljs-literal">None</span>,
        eos_token_id=<span class="hljs-number">50279</span>,
        tie_word_embeddings=<span class="hljs-literal">False</span>,
        rope_theta=<span class="hljs-number">10000.0</span>,
        rope_scaling=<span class="hljs-literal">None</span>,
        attention_bias=<span class="hljs-literal">False</span>,
        attention_dropout=<span class="hljs-number">0.0</span>,
        rms_norm_eps=<span class="hljs-number">1e-5</span>,
        **kwargs,
    </span>):
        <span class="hljs-built_in">super</span>().__init__(
            vocab_size=vocab_size,
            hidden_size=hidden_size,
            intermediate_size=intermediate_size,
            num_hidden_layers=num_hidden_layers,
            num_attention_heads=num_attention_heads,
            num_key_value_heads=num_key_value_heads,
            hidden_act=hidden_act,
            max_position_embeddings=max_position_embeddings,
            initializer_range=initializer_range,
            use_cache=use_cache,
            pad_token_id=pad_token_id,
            bos_token_id=bos_token_id,
            eos_token_id=eos_token_id,
            tie_word_embeddings=tie_word_embeddings,
            rope_theta=rope_theta,
            rope_scaling=rope_scaling,
            attention_bias=attention_bias,
            attention_dropout=attention_dropout,
            **kwargs,
        )

        self.rms_norm_eps = rms_norm_eps
        <span class="hljs-keyword">del</span> self.clip_qkv`,wrap:!1}}),tl=new J({props:{title:"Norm",local:"norm",headingTag:"h3"}}),al=new c({props:{code:"ZnJvbSUyMC4ubGxhbWEubW9kZWxpbmdfbGxhbWElMjBpbXBvcnQlMjBMbGFtYVJNU05vcm0lMEElMEFjbGFzcyUyME9sbW8yUk1TTm9ybShMbGFtYVJNU05vcm0pJTNBJTBBJTIwJTIwJTIwJTIwcGFzcw==",highlighted:`<span class="hljs-keyword">from</span> ..llama.modeling_llama <span class="hljs-keyword">import</span> LlamaRMSNorm

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2RMSNorm</span>(<span class="hljs-title class_ inherited__">LlamaRMSNorm</span>):
    <span class="hljs-keyword">pass</span>`,wrap:!1}}),yl=new J({props:{title:"Attention",local:"attention",headingTag:"h3"}}),Ul=new c({props:{code:"ZnJvbSUyMC4ubGxhbWEubW9kZWxpbmdfbGxhbWElMjBpbXBvcnQlMjBlYWdlcl9hdHRlbnRpb25fZm9yd2FyZCUwQWZyb20lMjAuLm9sbW8ubW9kZWxpbmdfb2xtbyUyMGltcG9ydCUyME9sbW9BdHRlbnRpb24lMkMlMjBhcHBseV9yb3RhcnlfcG9zX2VtYiUwQSUwQSUwQSUyMyUyME9sbW8yJTIwYXR0ZW50aW9uJTIwaXMlMjBpZGVudGljYWwlMjB0byUyME9MTW8lMjBhdHRlbnRpb24lMjBleGNlcHQlM0ElMEElMjMlMjAtJTIwTm9ybSUyMGlzJTIwYXBwbGllZCUyMHRvJTIwYXR0ZW50aW9uJTIwcXVlcmllcyUyMGFuZCUyMGtleXMuJTBBJTIzJTIwLSUyME5vJTIwcWt2JTIwY2xpcHBpbmcuJTBBY2xhc3MlMjBPbG1vMkF0dGVudGlvbihPbG1vQXR0ZW50aW9uKSUzQSUwQSUyMCUyMCUyMCUyMGRlZiUyMF9faW5pdF9fKHNlbGYlMkMlMjBjb25maWclM0ElMjBPbG1vMkNvbmZpZyUyQyUyMGxheWVyX2lkeCUzQSUyME9wdGlvbmFsJTVCaW50JTVEJTIwJTNEJTIwTm9uZSklM0ElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzdXBlcigpLl9faW5pdF9fKGNvbmZpZyUyQyUyMGxheWVyX2lkeCUzRGxheWVyX2lkeCklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzZWxmLnFfbm9ybSUyMCUzRCUyME9sbW8yUk1TTm9ybShjb25maWcubnVtX2F0dGVudGlvbl9oZWFkcyUyMColMjBzZWxmLmhlYWRfZGltJTJDJTIwY29uZmlnLnJtc19ub3JtX2VwcyklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzZWxmLmtfbm9ybSUyMCUzRCUyME9sbW8yUk1TTm9ybShjb25maWcubnVtX2tleV92YWx1ZV9oZWFkcyUyMColMjBzZWxmLmhlYWRfZGltJTJDJTIwY29uZmlnLnJtc19ub3JtX2VwcyklMEElMEElMjAlMjAlMjAlMjBkZWYlMjBmb3J3YXJkKCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc3RhdGVzJTNBJTIwdG9yY2guVGVuc29yJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcG9zaXRpb25fZW1iZWRkaW5ncyUzQSUyMHR1cGxlJTVCdG9yY2guVGVuc29yJTJDJTIwdG9yY2guVGVuc29yJTVEJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwYXR0ZW50aW9uX21hc2slM0ElMjBPcHRpb25hbCU1QnRvcmNoLlRlbnNvciU1RCUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHBhc3Rfa2V5X3ZhbHVlcyUzQSUyME9wdGlvbmFsJTVCQ2FjaGUlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwY2FjaGVfcG9zaXRpb24lM0ElMjBPcHRpb25hbCU1QnRvcmNoLkxvbmdUZW5zb3IlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwKiprd2FyZ3MlMkMlMEElMjAlMjAlMjAlMjApJTIwLSUzRSUyMHR1cGxlJTVCdG9yY2guVGVuc29yJTJDJTIwT3B0aW9uYWwlNUJ0b3JjaC5UZW5zb3IlNUQlMkMlMjBPcHRpb25hbCU1QnR1cGxlJTVCdG9yY2guVGVuc29yJTVEJTVEJTVEJTNBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaW5wdXRfc2hhcGUlMjAlM0QlMjBoaWRkZW5fc3RhdGVzLnNoYXBlJTVCJTNBLTElNUQlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc2hhcGUlMjAlM0QlMjAoKmlucHV0X3NoYXBlJTJDJTIwLTElMkMlMjBzZWxmLmhlYWRfZGltKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHF1ZXJ5X3N0YXRlcyUyMCUzRCUyMHNlbGYucV9ub3JtKHNlbGYucV9wcm9qKGhpZGRlbl9zdGF0ZXMpKSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGtleV9zdGF0ZXMlMjAlM0QlMjBzZWxmLmtfbm9ybShzZWxmLmtfcHJvaihoaWRkZW5fc3RhdGVzKSklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjB2YWx1ZV9zdGF0ZXMlMjAlM0QlMjBzZWxmLnZfcHJvaihoaWRkZW5fc3RhdGVzKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHF1ZXJ5X3N0YXRlcyUyMCUzRCUyMHF1ZXJ5X3N0YXRlcy52aWV3KGhpZGRlbl9zaGFwZSkudHJhbnNwb3NlKDElMkMlMjAyKSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGtleV9zdGF0ZXMlMjAlM0QlMjBrZXlfc3RhdGVzLnZpZXcoaGlkZGVuX3NoYXBlKS50cmFuc3Bvc2UoMSUyQyUyMDIpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwdmFsdWVfc3RhdGVzJTIwJTNEJTIwdmFsdWVfc3RhdGVzLnZpZXcoaGlkZGVuX3NoYXBlKS50cmFuc3Bvc2UoMSUyQyUyMDIpJTBBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwY29zJTJDJTIwc2luJTIwJTNEJTIwcG9zaXRpb25fZW1iZWRkaW5ncyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHF1ZXJ5X3N0YXRlcyUyQyUyMGtleV9zdGF0ZXMlMjAlM0QlMjBhcHBseV9yb3RhcnlfcG9zX2VtYihxdWVyeV9zdGF0ZXMlMkMlMjBrZXlfc3RhdGVzJTJDJTIwY29zJTJDJTIwc2luKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGlmJTIwcGFzdF9rZXlfdmFsdWVzJTIwaXMlMjBub3QlMjBOb25lJTNBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIzJTIwc2luJTIwYW5kJTIwY29zJTIwYXJlJTIwc3BlY2lmaWMlMjB0byUyMFJvUEUlMjBtb2RlbHMlM0IlMjBjYWNoZV9wb3NpdGlvbiUyMG5lZWRlZCUyMGZvciUyMHRoZSUyMHN0YXRpYyUyMGNhY2hlJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwY2FjaGVfa3dhcmdzJTIwJTNEJTIwJTdCJTIyc2luJTIyJTNBJTIwc2luJTJDJTIwJTIyY29zJTIyJTNBJTIwY29zJTJDJTIwJTIyY2FjaGVfcG9zaXRpb24lMjIlM0ElMjBjYWNoZV9wb3NpdGlvbiU3RCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGtleV9zdGF0ZXMlMkMlMjB2YWx1ZV9zdGF0ZXMlMjAlM0QlMjBwYXN0X2tleV92YWx1ZXMudXBkYXRlKGtleV9zdGF0ZXMlMkMlMjB2YWx1ZV9zdGF0ZXMlMkMlMjBzZWxmLmxheWVyX2lkeCUyQyUyMGNhY2hlX2t3YXJncyklMEElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBhdHRlbnRpb25faW50ZXJmYWNlJTNBJTIwQ2FsbGFibGUlMjAlM0QlMjBlYWdlcl9hdHRlbnRpb25fZm9yd2FyZCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGlmJTIwc2VsZi5jb25maWcuX2F0dG5faW1wbGVtZW50YXRpb24lMjAhJTNEJTIwJTIyZWFnZXIlMjIlM0ElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBhdHRlbnRpb25faW50ZXJmYWNlJTIwJTNEJTIwQUxMX0FUVEVOVElPTl9GVU5DVElPTlMlNUJzZWxmLmNvbmZpZy5fYXR0bl9pbXBsZW1lbnRhdGlvbiU1RCUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dG5fb3V0cHV0JTJDJTIwYXR0bl93ZWlnaHRzJTIwJTNEJTIwYXR0ZW50aW9uX2ludGVyZmFjZSglMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzZWxmJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcXVlcnlfc3RhdGVzJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwa2V5X3N0YXRlcyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHZhbHVlX3N0YXRlcyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dGVudGlvbl9tYXNrJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwZHJvcG91dCUzRDAuMCUyMGlmJTIwbm90JTIwc2VsZi50cmFpbmluZyUyMGVsc2UlMjBzZWxmLmF0dGVudGlvbl9kcm9wb3V0JTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwc2NhbGluZyUzRHNlbGYuc2NhbGluZyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCoqa3dhcmdzJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dG5fb3V0cHV0JTIwJTNEJTIwYXR0bl9vdXRwdXQucmVzaGFwZSgqaW5wdXRfc2hhcGUlMkMlMjAtMSkuY29udGlndW91cygpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwYXR0bl9vdXRwdXQlMjAlM0QlMjBzZWxmLm9fcHJvaihhdHRuX291dHB1dCklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjByZXR1cm4lMjBhdHRuX291dHB1dCUyQyUyMGF0dG5fd2VpZ2h0cw==",highlighted:`<span class="hljs-keyword">from</span> ..llama.modeling_llama <span class="hljs-keyword">import</span> eager_attention_forward
<span class="hljs-keyword">from</span> ..olmo.modeling_olmo <span class="hljs-keyword">import</span> OlmoAttention, apply_rotary_pos_emb


<span class="hljs-comment"># Olmo2 attention is identical to OLMo attention except:</span>
<span class="hljs-comment"># - Norm is applied to attention queries and keys.</span>
<span class="hljs-comment"># - No qkv clipping.</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2Attention</span>(<span class="hljs-title class_ inherited__">OlmoAttention</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: Olmo2Config, layer_idx: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = <span class="hljs-literal">None</span></span>):
        <span class="hljs-built_in">super</span>().__init__(config, layer_idx=layer_idx)
        self.q_norm = Olmo2RMSNorm(config.num_attention_heads * self.head_dim, config.rms_norm_eps)
        self.k_norm = Olmo2RMSNorm(config.num_key_value_heads * self.head_dim, config.rms_norm_eps)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">
        self,
        hidden_states: torch.Tensor,
        position_embeddings: <span class="hljs-built_in">tuple</span>[torch.Tensor, torch.Tensor],
        attention_mask: <span class="hljs-type">Optional</span>[torch.Tensor],
        past_key_values: <span class="hljs-type">Optional</span>[Cache] = <span class="hljs-literal">None</span>,
        cache_position: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
        **kwargs,
    </span>) -&gt; <span class="hljs-built_in">tuple</span>[torch.Tensor, <span class="hljs-type">Optional</span>[torch.Tensor], <span class="hljs-type">Optional</span>[<span class="hljs-built_in">tuple</span>[torch.Tensor]]]:
        input_shape = hidden_states.shape[:-<span class="hljs-number">1</span>]
        hidden_shape = (*input_shape, -<span class="hljs-number">1</span>, self.head_dim)

        query_states = self.q_norm(self.q_proj(hidden_states))
        key_states = self.k_norm(self.k_proj(hidden_states))
        value_states = self.v_proj(hidden_states)

        query_states = query_states.view(hidden_shape).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
        key_states = key_states.view(hidden_shape).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
        value_states = value_states.view(hidden_shape).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)

        cos, sin = position_embeddings
        query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin)

        <span class="hljs-keyword">if</span> past_key_values <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-comment"># sin and cos are specific to RoPE models; cache_position needed for the static cache</span>
            cache_kwargs = {<span class="hljs-string">&quot;sin&quot;</span>: sin, <span class="hljs-string">&quot;cos&quot;</span>: cos, <span class="hljs-string">&quot;cache_position&quot;</span>: cache_position}
            key_states, value_states = past_key_values.update(key_states, value_states, self.layer_idx, cache_kwargs)

        attention_interface: <span class="hljs-type">Callable</span> = eager_attention_forward
        <span class="hljs-keyword">if</span> self.config._attn_implementation != <span class="hljs-string">&quot;eager&quot;</span>:
            attention_interface = ALL_ATTENTION_FUNCTIONS[self.config._attn_implementation]

        attn_output, attn_weights = attention_interface(
            self,
            query_states,
            key_states,
            value_states,
            attention_mask,
            dropout=<span class="hljs-number">0.0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.training <span class="hljs-keyword">else</span> self.attention_dropout,
            scaling=self.scaling,
            **kwargs,
        )

        attn_output = attn_output.reshape(*input_shape, -<span class="hljs-number">1</span>).contiguous()
        attn_output = self.o_proj(attn_output)
        <span class="hljs-keyword">return</span> attn_output, attn_weights`,wrap:!1}}),dl=new J({props:{title:"DecoderLayer",local:"decoderlayer",headingTag:"h3"}}),Cl=new c({props:{code:"ZnJvbSUyMC4ub2xtby5tb2RlbGluZ19vbG1vJTIwaW1wb3J0JTIwT2xtb0RlY29kZXJMYXllciUwQSUwQSUyMyUyMFRoZSUyME9MTW8yJTIwbGF5ZXJzJTIwYXJlJTIwaWRlbnRpY2FsJTIwdG8lMjB0aG9zZSUyMG9mJTIwdGhlJTIwT0xNbyUyMG1vZGVsJTIwZXhjZXB0JTNBJTBBJTIzJTIwLSUyMFJNU05vcm0lMjBpcyUyMHVzZWQlMjBpbnN0ZWFkJTIwb2YlMjBzdGFuZGFyZCUyMGxheWVyJTIwbm9ybS4lMEElMjMlMjAtJTIwTm9ybSUyMGlzJTIwYXBwbGllZCUyMGFmdGVyJTIwYXR0ZW50aW9uJTJGZmVlZGZvcndhcmQlMjByYXRoZXIlMjB0aGFuJTIwYmVmb3JlLiUwQWNsYXNzJTIwT2xtbzJEZWNvZGVyTGF5ZXIoT2xtb0RlY29kZXJMYXllciklM0ElMEElMjAlMjAlMjAlMjBkZWYlMjBfX2luaXRfXyhzZWxmJTJDJTIwY29uZmlnJTNBJTIwT2xtbzJDb25maWclMkMlMjBsYXllcl9pZHglM0ElMjBpbnQpJTNBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwc3VwZXIoKS5fX2luaXRfXyhjb25maWclMkMlMjBsYXllcl9pZHglM0RsYXllcl9pZHgpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwc2VsZi5wb3N0X2F0dGVudGlvbl9sYXllcm5vcm0lMjAlM0QlMjBPbG1vMlJNU05vcm0oY29uZmlnLmhpZGRlbl9zaXplJTJDJTIwZXBzJTNEY29uZmlnLnJtc19ub3JtX2VwcyklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBzZWxmLnBvc3RfZmVlZGZvcndhcmRfbGF5ZXJub3JtJTIwJTNEJTIwT2xtbzJSTVNOb3JtKGNvbmZpZy5oaWRkZW5fc2l6ZSUyQyUyMGVwcyUzRGNvbmZpZy5ybXNfbm9ybV9lcHMpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwc2VsZi5zZWxmX2F0dG4lMjAlM0QlMjBPbG1vMkF0dGVudGlvbihjb25maWclM0Rjb25maWclMkMlMjBsYXllcl9pZHglM0RsYXllcl9pZHgpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwZGVsJTIwc2VsZi5pbnB1dF9sYXllcm5vcm0lMEElMEElMjAlMjAlMjAlMjBkZWYlMjBmb3J3YXJkKCUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc3RhdGVzJTNBJTIwdG9yY2guVGVuc29yJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwYXR0ZW50aW9uX21hc2slM0ElMjBPcHRpb25hbCU1QnRvcmNoLlRlbnNvciU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBwb3NpdGlvbl9pZHMlM0ElMjBPcHRpb25hbCU1QnRvcmNoLkxvbmdUZW5zb3IlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcGFzdF9rZXlfdmFsdWVzJTNBJTIwT3B0aW9uYWwlNUJDYWNoZSU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBvdXRwdXRfYXR0ZW50aW9ucyUzQSUyME9wdGlvbmFsJTVCYm9vbCU1RCUyMCUzRCUyMEZhbHNlJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwdXNlX2NhY2hlJTNBJTIwT3B0aW9uYWwlNUJib29sJTVEJTIwJTNEJTIwRmFsc2UlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBjYWNoZV9wb3NpdGlvbiUzQSUyME9wdGlvbmFsJTVCdG9yY2guTG9uZ1RlbnNvciU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBwb3NpdGlvbl9lbWJlZGRpbmdzJTNBJTIwT3B0aW9uYWwlNUJ0dXBsZSU1QnRvcmNoLlRlbnNvciUyQyUyMHRvcmNoLlRlbnNvciU1RCU1RCUyMCUzRCUyME5vbmUlMkMlMjAlMjAlMjMlMjBuZWNlc3NhcnklMkMlMjBidXQlMjBrZXB0JTIwaGVyZSUyMGZvciUyMEJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwKiprd2FyZ3MlMkMlMEElMjAlMjAlMjAlMjApJTIwLSUzRSUyMHR1cGxlJTVCdG9yY2guRmxvYXRUZW5zb3IlMkMlMjBPcHRpb25hbCU1QnR1cGxlJTVCdG9yY2guRmxvYXRUZW5zb3IlMkMlMjB0b3JjaC5GbG9hdFRlbnNvciU1RCU1RCU1RCUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJlc2lkdWFsJTIwJTNEJTIwaGlkZGVuX3N0YXRlcyUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMyUyMFNlbGYlMjBBdHRlbnRpb24lMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc3RhdGVzJTJDJTIwc2VsZl9hdHRuX3dlaWdodHMlMjAlM0QlMjBzZWxmLnNlbGZfYXR0biglMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc3RhdGVzJTNEaGlkZGVuX3N0YXRlcyUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dGVudGlvbl9tYXNrJTNEYXR0ZW50aW9uX21hc2slMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBwb3NpdGlvbl9pZHMlM0Rwb3NpdGlvbl9pZHMlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBwYXN0X2tleV92YWx1ZXMlM0RwYXN0X2tleV92YWx1ZXMlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBvdXRwdXRfYXR0ZW50aW9ucyUzRG91dHB1dF9hdHRlbnRpb25zJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwdXNlX2NhY2hlJTNEdXNlX2NhY2hlJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwY2FjaGVfcG9zaXRpb24lM0RjYWNoZV9wb3NpdGlvbiUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHBvc2l0aW9uX2VtYmVkZGluZ3MlM0Rwb3NpdGlvbl9lbWJlZGRpbmdzJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwKiprd2FyZ3MlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjApJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX3N0YXRlcyUyMCUzRCUyMHNlbGYucG9zdF9hdHRlbnRpb25fbGF5ZXJub3JtKGhpZGRlbl9zdGF0ZXMpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX3N0YXRlcyUyMCUzRCUyMHJlc2lkdWFsJTIwJTJCJTIwaGlkZGVuX3N0YXRlcyUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMyUyMEZ1bGx5JTIwQ29ubmVjdGVkJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcmVzaWR1YWwlMjAlM0QlMjBoaWRkZW5fc3RhdGVzJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX3N0YXRlcyUyMCUzRCUyMHNlbGYubWxwKGhpZGRlbl9zdGF0ZXMpJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGlkZGVuX3N0YXRlcyUyMCUzRCUyMHNlbGYucG9zdF9mZWVkZm9yd2FyZF9sYXllcm5vcm0oaGlkZGVuX3N0YXRlcyklMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaWRkZW5fc3RhdGVzJTIwJTNEJTIwcmVzaWR1YWwlMjAlMkIlMjBoaWRkZW5fc3RhdGVzJTBBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwb3V0cHV0cyUyMCUzRCUyMChoaWRkZW5fc3RhdGVzJTJDKSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGlmJTIwb3V0cHV0X2F0dGVudGlvbnMlM0ElMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBvdXRwdXRzJTIwJTJCJTNEJTIwKHNlbGZfYXR0bl93ZWlnaHRzJTJDKSUwQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJldHVybiUyMG91dHB1dHM=",highlighted:`<span class="hljs-keyword">from</span> ..olmo.modeling_olmo <span class="hljs-keyword">import</span> OlmoDecoderLayer

<span class="hljs-comment"># The OLMo2 layers are identical to those of the OLMo model except:</span>
<span class="hljs-comment"># - RMSNorm is used instead of standard layer norm.</span>
<span class="hljs-comment"># - Norm is applied after attention/feedforward rather than before.</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2DecoderLayer</span>(<span class="hljs-title class_ inherited__">OlmoDecoderLayer</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: Olmo2Config, layer_idx: <span class="hljs-built_in">int</span></span>):
        <span class="hljs-built_in">super</span>().__init__(config, layer_idx=layer_idx)
        self.post_attention_layernorm = Olmo2RMSNorm(config.hidden_size, eps=config.rms_norm_eps)
        self.post_feedforward_layernorm = Olmo2RMSNorm(config.hidden_size, eps=config.rms_norm_eps)
        self.self_attn = Olmo2Attention(config=config, layer_idx=layer_idx)
        <span class="hljs-keyword">del</span> self.input_layernorm

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">
        self,
        hidden_states: torch.Tensor,
        attention_mask: <span class="hljs-type">Optional</span>[torch.Tensor] = <span class="hljs-literal">None</span>,
        position_ids: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
        past_key_values: <span class="hljs-type">Optional</span>[Cache] = <span class="hljs-literal">None</span>,
        output_attentions: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">False</span>,
        use_cache: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">False</span>,
        cache_position: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
        position_embeddings: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">tuple</span>[torch.Tensor, torch.Tensor]] = <span class="hljs-literal">None</span>,  <span class="hljs-comment"># necessary, but kept here for BC</span>
        **kwargs,
    </span>) -&gt; <span class="hljs-built_in">tuple</span>[torch.FloatTensor, <span class="hljs-type">Optional</span>[<span class="hljs-built_in">tuple</span>[torch.FloatTensor, torch.FloatTensor]]]:
        residual = hidden_states

        <span class="hljs-comment"># Self Attention</span>
        hidden_states, self_attn_weights = self.self_attn(
            hidden_states=hidden_states,
            attention_mask=attention_mask,
            position_ids=position_ids,
            past_key_values=past_key_values,
            output_attentions=output_attentions,
            use_cache=use_cache,
            cache_position=cache_position,
            position_embeddings=position_embeddings,
            **kwargs,
        )
        hidden_states = self.post_attention_layernorm(hidden_states)
        hidden_states = residual + hidden_states

        <span class="hljs-comment"># Fully Connected</span>
        residual = hidden_states
        hidden_states = self.mlp(hidden_states)
        hidden_states = self.post_feedforward_layernorm(hidden_states)
        hidden_states = residual + hidden_states

        outputs = (hidden_states,)
        <span class="hljs-keyword">if</span> output_attentions:
            outputs += (self_attn_weights,)

        <span class="hljs-keyword">return</span> outputs`,wrap:!1}}),jl=new J({props:{title:"Model",local:"model",headingTag:"h3"}}),ml=new c({props:{code:"ZnJvbSUyMC4ub2xtby5tb2RlbGluZ19vbG1vJTIwaW1wb3J0JTIwT2xtb01vZGVsJTBBJTBBJTIzJTIwVGhlJTIwT0xNbzIlMjBtb2RlbCUyMGlzJTIwaWRlbnRpY2FsJTIwdG8lMjB0aGUlMjBPTE1vJTIwbW9kZWwlMkMlMjBleGNlcHQlMjBSTVNOb3JtJTIwaXMlMjB1c2VkJTIwaW5zdGVhZCUyMG9mJTBBJTIzJTIwc3RhbmRhcmQlMjBsYXllciUyMG5vcm0lMjBmb3IlMjB0aGUlMjBvdXRwdXQlMjBub3JtLiUwQWNsYXNzJTIwT2xtbzJNb2RlbChPbG1vTW9kZWwpJTNBJTBBJTIwJTIwJTIwJTIwZGVmJTIwX19pbml0X18oc2VsZiUyQyUyMGNvbmZpZyUzQSUyME9sbW8yQ29uZmlnKSUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHN1cGVyKCkuX19pbml0X18oY29uZmlnKSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYubm9ybSUyMCUzRCUyME9sbW8yUk1TTm9ybShjb25maWcuaGlkZGVuX3NpemUlMkMlMjBlcHMlM0Rjb25maWcucm1zX25vcm1fZXBzKSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYubGF5ZXJzJTIwJTNEJTIwbm4uTW9kdWxlTGlzdCglMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlNUJPbG1vMkRlY29kZXJMYXllcihjb25maWclMkMlMjBsYXllcl9pZHgpJTIwZm9yJTIwbGF5ZXJfaWR4JTIwaW4lMjByYW5nZShjb25maWcubnVtX2hpZGRlbl9sYXllcnMpJTVEJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwKQ==",highlighted:`<span class="hljs-keyword">from</span> ..olmo.modeling_olmo <span class="hljs-keyword">import</span> OlmoModel

<span class="hljs-comment"># The OLMo2 model is identical to the OLMo model, except RMSNorm is used instead of</span>
<span class="hljs-comment"># standard layer norm for the output norm.</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2Model</span>(<span class="hljs-title class_ inherited__">OlmoModel</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: Olmo2Config</span>):
        <span class="hljs-built_in">super</span>().__init__(config)
        self.norm = Olmo2RMSNorm(config.hidden_size, eps=config.rms_norm_eps)
        self.layers = nn.ModuleList(
            [Olmo2DecoderLayer(config, layer_idx) <span class="hljs-keyword">for</span> layer_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(config.num_hidden_layers)]
        )`,wrap:!1}}),Il=new J({props:{title:"Model head",local:"model-head",headingTag:"h3"}}),fl=new c({props:{code:"ZnJvbSUyMC4ub2xtby5tb2RlbGluZ19vbG1vJTIwaW1wb3J0JTIwT2xtb0ZvckNhdXNhbExNJTBBJTBBY2xhc3MlMjBPbG1vMkZvckNhdXNhbExNKE9sbW9Gb3JDYXVzYWxMTSklM0ElMEElMjAlMjAlMjAlMjBwYXNz",highlighted:`<span class="hljs-keyword">from</span> ..olmo.modeling_olmo <span class="hljs-keyword">import</span> OlmoForCausalLM

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2ForCausalLM</span>(<span class="hljs-title class_ inherited__">OlmoForCausalLM</span>):
    <span class="hljs-keyword">pass</span>`,wrap:!1}}),Al=new J({props:{title:"Other classes",local:"other-classes",headingTag:"h3"}}),Bl=new c({props:{code:"ZnJvbSUyMC4ub2xtby5tb2RlbGluZ19vbG1vJTIwaW1wb3J0JTIwT2xtb01MUCUwQSUwQWNsYXNzJTIwT2xtbzJNTFAoT2xtb01MUCklM0ElMEElMjAlMjAlMjAlMjBwYXNz",highlighted:`<span class="hljs-keyword">from</span> ..olmo.modeling_olmo <span class="hljs-keyword">import</span> OlmoMLP

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2MLP</span>(<span class="hljs-title class_ inherited__">OlmoMLP</span>):
    <span class="hljs-keyword">pass</span>`,wrap:!1}}),gl=new c({props:{code:"JTIzJTIwc3dpdGNoJTIwdG8lMjBtaXN0cmFsJTIwZGVmaW5pdGlvbiUwQWZyb20lMjAuLm1pc3RyYWwubW9kZWxpbmdfbWlzdHJhbCUyMGltcG9ydCUyME1pc3RyYWxNTFAlMEElMEFjbGFzcyUyME9sbW8yTUxQKE1pc3RyYWxNTFApJTNBJTBBJTIwJTIwJTIwJTIwcGFzcw==",highlighted:`<span class="hljs-comment"># switch to mistral definition</span>
<span class="hljs-keyword">from</span> ..mistral.modeling_mistral <span class="hljs-keyword">import</span> MistralMLP

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Olmo2MLP</span>(<span class="hljs-title class_ inherited__">MistralMLP</span>):
    <span class="hljs-keyword">pass</span>`,wrap:!1}}),vl=new J({props:{title:"Removing attributes",local:"removing-attributes",headingTag:"h2"}}),Nl=new c({props:{code:"Y2xhc3MlMjBEdW1teU1vZGVsKG5uLk1vZHVsZSklM0ElMEElMEElMjAlMjBkZWYlMjBfX2luaXRfXyhzZWxmJTJDJTIwY29uZmlnJTNBJTIwRHVtbXlDb25maWcpJTNBJTBBJTIwJTIwJTIwJTIwc3VwZXIoKS5fX2luaXRfXygpJTBBJTIwJTIwJTIwJTIwc2VsZi5hdHRyaWJ1dGUlMjAlM0QlMjBjb25maWcuYXR0cmlidXRlJTBBJTIwJTIwJTIwJTIwaWYlMjBzZWxmLmF0dHJpYnV0ZSUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMyUyMGRvJTIwbW9yZSUyMHN0dWZmJTIwd2l0aCUyMCU2MHNlbGYuYXR0cmlidXRlJTYwJTIwaGVyZSUwQSUyMCUyMCUyMCUyMCUyMCUyMC4uLiUwQSUwQWNsYXNzJTIwTXlOZXdEdW1teU1vZGVsKER1bW15TW9kZWwpJTNBJTBBJTBBJTIwJTIwZGVmJTIwX19pbml0X18oc2VsZiUyQyUyMGNvbmZpZyUzQSUyME15TmV3RHVtbXlDb25maWcpJTNBJTBBJTIwJTIwJTIwJTIwc3VwZXIoKS5fX2luaXRfXyhjb25maWcpJTBBJTIwJTIwJTIwJTIwZGVsJTIwc2VsZi5hdHRyaWJ1dGU=",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">DummyModel</span>(nn.Module):

  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: DummyConfig</span>):
    <span class="hljs-built_in">super</span>().__init__()
    self.attribute = config.attribute
    <span class="hljs-keyword">if</span> self.attribute:
      <span class="hljs-comment"># do more stuff with \`self.attribute\` here</span>
      ...

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNewDummyModel</span>(<span class="hljs-title class_ inherited__">DummyModel</span>):

  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: MyNewDummyConfig</span>):
    <span class="hljs-built_in">super</span>().__init__(config)
    <span class="hljs-keyword">del</span> self.attribute`,wrap:!1}}),Xl=new J({props:{title:"Calling parent methods without unravelling their definition",local:"calling-parent-methods-without-unravelling-their-definition",headingTag:"h2"}}),Vl=new c({props:{code:"Y2xhc3MlMjBNeU5ld0R1bW15TW9kdWxlKER1bW15TW9kdWxlKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMGNsYXNzJTIwTXlOZXdEdW1teU1vZHVsZShubi5Nb2R1bGUpJTNBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTBBJTIwJTIwZGVmJTIwX19pbml0X18oc2VsZiklM0ElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAlMjBkZWYlMjBfX2luaXRfXyhzZWxmKSUzQSUwQSUyMCUyMCUyMCUyMG5uLk1vZHVsZS5fX2luaXRfXyhzZWxmKSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHN1cGVyKCkuX19pbml0X18oKSUwQSUyMCUyMCUyMCUyMHNlbGYuZm9vJTIwJTNEJTIwY29uZmlnLmZvbyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYuZm9vJTIwJTNEJTIwY29uZmlnLmZvbyUwQSUyMCUyMCUyMCUyMC4uLiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMC4uLg==",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNewDummyModule</span>(<span class="hljs-title class_ inherited__">DummyModule</span>):                   |     <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNewDummyModule</span>(nn.Module):
                                                       |
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):                                  |       <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
    nn.Module.__init__(self)                           |         <span class="hljs-built_in">super</span>().__init__()
    self.foo = config.foo                              |         self.foo = config.foo
    ...                                                |         ...`,wrap:!1}}),$l=new J({props:{title:"Deleting unused methods",local:"deleting-unused-methods",headingTag:"h2"}}),Ql=new c({props:{code:"Y2xhc3MlMjBHZW1tYVRva2VuaXplcihMbGFtYVRva2VuaXplciklM0ElMEElMjAlMjAlMjAlMjAuLi4lMEElMEElMjAlMjAlMjAlMjBkZWYlMjBnZXRfc3BtX3Byb2Nlc3NvcihzZWxmKSUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJhaXNlJTIwQXR0cmlidXRlRXJyb3IoJTIyTm90JTIwbmVlZGVkJTIwZm9yJTIwR2VtbWElMjIpJTBBJTBBJTIwJTIwJTIwJTIwZGVmJTIwdW5rX3Rva2VuX2xlbmd0aChzZWxmKSUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJhaXNlJTIwQXR0cmlidXRlRXJyb3IoJTIyTm90JTIwbmVlZGVkJTIwZm9yJTIwR2VtbWElMjIp",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">GemmaTokenizer</span>(<span class="hljs-title class_ inherited__">LlamaTokenizer</span>):
    ...

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_spm_processor</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Not needed for Gemma&quot;</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">unk_token_length</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Not needed for Gemma&quot;</span>)`,wrap:!1}}),Sl=new J({props:{title:"Defining new functions",local:"defining-new-functions",headingTag:"h2"}}),Ll=new c({props:{code:"Y2xhc3MlMjBEdW1teU1vZGVsKG5uLk1vZHVsZSklM0ElMEElMjAlMjAuLi4lMEElMEElMjAlMjAlNDBkZWNvcmF0b3IoLi4uKSUwQSUyMCUyMGRlZiUyMGZvcndhcmQoLi4uKSUwQSUyMCUyMCUyMCUyMCUyMyUyMGRvJTIwc3R1ZmYlMjBoZXJl",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">DummyModel</span>(nn.Module):
  ...

<span class="hljs-meta">  @decorator(<span class="hljs-params">...</span>)</span>
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>)
    <span class="hljs-comment"># do stuff here</span>`,wrap:!1}}),Fl=new c({props:{code:"Y2xhc3MlMjBOZXdNb2RlbChEdW1teU1vZGVsKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMGNsYXNzJTIwTmV3TW9kZWwobm4uTW9kdWxlKSUzQSUwQSUyMCUyMC4uLiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMC4uLiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUwQSUyMCUyMGRlZiUyMGZvcndhcmQoLi4uKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCU0MGRlY29yYXRvciguLi4pJTBBJTIwJTIwJTIwJTIwLi4uJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwZGVmJTIwZm9yd2FyZCguLi4pJTNBJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwJTIwJTIwLi4u",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModel</span>(<span class="hljs-title class_ inherited__">DummyModel</span>):       |   <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModel</span>(nn.Module):
  ...                             |     ...
                                  |
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>):               |     @decorator(...)
    ...                           |     <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>):
                                  |       ...`,wrap:!1}}),Dl=new c({props:{code:"Y2xhc3MlMjBOZXdNb2RlbChEdW1teU1vZGVsKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMGNsYXNzJTIwTmV3TW9kZWwobm4uTW9kdWxlKSUzQSUwQSUyMCUyMC4uLiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMC4uLiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUwQSUyMCUyMCU0MG15X25ld19kZWNvcmF0b3IoLi4uKSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCU0MG15X25ld19kZWNvcmF0b3IoLi4uKSUwQSUyMCUyMGRlZiUyMGZvcndhcmQoLi4uKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMGRlZiUyMGZvcndhcmQoLi4uKSUzQSUwQSUyMCUyMCUyMCUyMC4uLiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMC4uLg==",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModel</span>(<span class="hljs-title class_ inherited__">DummyModel</span>):       |   <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModel</span>(nn.Module):
  ...                             |     ...
                                  |
<span class="hljs-meta">  @my_new_decorator(<span class="hljs-params">...</span>)          |     @my_new_decorator(<span class="hljs-params">...</span>)</span>
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>):               |     <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>):
    ...                           |       ...`,wrap:!1}}),Pl=new J({props:{title:"super_kwargs",local:"superkwargs",headingTag:"h2"}}),le=new c({props:{code:"Y2xhc3MlMjBMbGFtYUZvckNhdXNhbExNKG5uLk1vZHVsZSklM0ElMEElMjAlMjAuLi4lMEElMEElMjAlMjAlNDBhZGRfc3RhcnRfZG9jc3RyaW5nc190b19tb2RlbF9mb3J3YXJkKExMQU1BX0lOUFVUU19ET0NTVFJJTkcpJTBBJTIwJTIwJTQwcmVwbGFjZV9yZXR1cm5fZG9jc3RyaW5ncyhvdXRwdXRfdHlwZSUzRENhdXNhbExNT3V0cHV0V2l0aFBhc3QlMkMlMjBjb25maWdfY2xhc3MlM0RfQ09ORklHX0ZPUl9ET0MpJTBBJTIwJTIwZGVmJTIwZm9yd2FyZCglMEElMjAlMjAlMjAlMjAlMjAlMjBzZWxmJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwaW5wdXRfaWRzJTNBJTIwdG9yY2guTG9uZ1RlbnNvciUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBhdHRlbnRpb25fbWFzayUzQSUyME9wdGlvbmFsJTVCdG9yY2guVGVuc29yJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMHBvc2l0aW9uX2lkcyUzQSUyME9wdGlvbmFsJTVCdG9yY2guTG9uZ1RlbnNvciU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBwYXN0X2tleV92YWx1ZXMlM0ElMjBPcHRpb25hbCU1QlVuaW9uJTVCQ2FjaGUlMkMlMjBsaXN0JTVCdG9yY2guRmxvYXRUZW5zb3IlNUQlNUQlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwaW5wdXRzX2VtYmVkcyUzQSUyME9wdGlvbmFsJTVCdG9yY2guRmxvYXRUZW5zb3IlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwbGFiZWxzJTNBJTIwT3B0aW9uYWwlNUJ0b3JjaC5Mb25nVGVuc29yJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMHVzZV9jYWNoZSUzQSUyME9wdGlvbmFsJTVCYm9vbCU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBvdXRwdXRfYXR0ZW50aW9ucyUzQSUyME9wdGlvbmFsJTVCYm9vbCU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBvdXRwdXRfaGlkZGVuX3N0YXRlcyUzQSUyME9wdGlvbmFsJTVCYm9vbCU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjByZXR1cm5fZGljdCUzQSUyME9wdGlvbmFsJTVCYm9vbCU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBjYWNoZV9wb3NpdGlvbiUzQSUyME9wdGlvbmFsJTVCdG9yY2guTG9uZ1RlbnNvciU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjBudW1fbG9naXRzX3RvX2tlZXAlM0ElMjBpbnQlMjAlM0QlMjAwJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwKiprd2FyZ3MlM0ElMjBVbnBhY2slNUJLd2FyZ3NGb3JDYXVzYWxMTSU1RCUyQyUwQSUyMCUyMCklMjAtJTNFJTIwVW5pb24lNUJUdXBsZSUyQyUyMENhdXNhbExNT3V0cHV0V2l0aFBhc3QlNUQlM0ElMEElMjAlMjAlMjAlMjAuLi4=",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">LlamaForCausalLM</span>(nn.Module):
  ...

<span class="hljs-meta">  @add_start_docstrings_to_model_forward(<span class="hljs-params">LLAMA_INPUTS_DOCSTRING</span>)</span>
<span class="hljs-meta">  @replace_return_docstrings(<span class="hljs-params">output_type=CausalLMOutputWithPast, config_class=_CONFIG_FOR_DOC</span>)</span>
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">
      self,
      input_ids: torch.LongTensor = <span class="hljs-literal">None</span>,
      attention_mask: <span class="hljs-type">Optional</span>[torch.Tensor] = <span class="hljs-literal">None</span>,
      position_ids: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
      past_key_values: <span class="hljs-type">Optional</span>[<span class="hljs-type">Union</span>[Cache, <span class="hljs-built_in">list</span>[torch.FloatTensor]]] = <span class="hljs-literal">None</span>,
      inputs_embeds: <span class="hljs-type">Optional</span>[torch.FloatTensor] = <span class="hljs-literal">None</span>,
      labels: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
      use_cache: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
      output_attentions: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
      output_hidden_states: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
      return_dict: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
      cache_position: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
      num_logits_to_keep: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>,
      **kwargs: Unpack[KwargsForCausalLM],
  </span>) -&gt; <span class="hljs-type">Union</span>[<span class="hljs-type">Tuple</span>, CausalLMOutputWithPast]:
    ...`,wrap:!1}}),se=new c({props:{code:"Y2xhc3MlMjBOZXdNb2RlbEZvckNhdXNhbExNKExsYW1hRm9yQ2F1c2FsTE0pJTNBJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwY2xhc3MlMjBMbGFtYUZvckNhdXNhbExNKG5uLk1vZHVsZSklM0ElMEElMjAlMjAuLi4lMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAuLi4lMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMEElMjAlMjAlNDBteV9uZXdfZGVjb3JhdG9yJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwJTQwbXlfbmV3X2RlY29yYXRvciUwQSUyMCUyMGRlZiUyMGZvcndhcmQoc2VsZiUyQyUyMCoqc3VwZXJfa3dhcmdzKSUzQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMGRlZiUyMGZvcndhcmQoJTBBJTIwJTIwJTIwJTIwc3VwZXIoKS5mb3J3YXJkKCoqc3VwZXJfa3dhcmdzKSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHNlbGYlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBpbnB1dF9pZHMlM0ElMjB0b3JjaC5Mb25nVGVuc29yJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGF0dGVudGlvbl9tYXNrJTNBJTIwT3B0aW9uYWwlNUJ0b3JjaC5UZW5zb3IlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcG9zaXRpb25faWRzJTNBJTIwT3B0aW9uYWwlNUJ0b3JjaC5Mb25nVGVuc29yJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHBhc3Rfa2V5X3ZhbHVlcyUzQSUyME9wdGlvbmFsJTVCVW5pb24lNUJDYWNoZSUyQyUyMGxpc3QlNUJ0b3JjaC5GbG9hdFRlbnNvciU1RCU1RCU1RCUyMCUzRCUyMCU3Q05vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBpbnB1dHNfZW1iZWRzJTNBJTIwT3B0aW9uYWwlNUJ0b3JjaC5GbG9hdFRlbnNvciU1RCUyMCUzRCUyME5vbmUlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBsYWJlbHMlM0ElMjBPcHRpb25hbCU1QnRvcmNoLkxvbmdUZW5zb3IlNUQlMjAlM0QlMjBOb25lJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwdXNlX2NhY2hlJTNBJTIwT3B0aW9uYWwlNUJib29sJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMG91dHB1dF9hdHRlbnRpb25zJTNBJTIwT3B0aW9uYWwlNUJib29sJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMG91dHB1dF9oaWRkZW5fc3RhdGVzJTNBJTIwT3B0aW9uYWwlNUJib29sJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHJldHVybl9kaWN0JTNBJTIwT3B0aW9uYWwlNUJib29sJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMGNhY2hlX3Bvc2l0aW9uJTNBJTIwT3B0aW9uYWwlNUJ0b3JjaC5Mb25nVGVuc29yJTVEJTIwJTNEJTIwTm9uZSUyQyUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMG51bV9sb2dpdHNfdG9fa2VlcCUzQSUyMGludCUyMCUzRCUyMDAlMkMlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlN0MlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAqKmt3YXJncyUzQSUyMFVucGFjayU1Qkt3YXJnc0ZvckNhdXNhbExNJTVEJTJDJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTIwJTIwJTIwJTIwJTIwKSUyMC0lM0UlMjBVbmlvbiU1QlR1cGxlJTJDJTIwQ2F1c2FsTE1PdXRwdXRXaXRoUGFzdCU1RCUzQSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU3QyUyMCUyMCUyMCUyMCUyMCUyMCUyMC4uLg==",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModelForCausalLM</span>(<span class="hljs-title class_ inherited__">LlamaForCausalLM</span>):    |    <span class="hljs-keyword">class</span> <span class="hljs-title class_">LlamaForCausalLM</span>(nn.Module):
  ...                                           |      ...
                                                |
<span class="hljs-meta">  @my_new_decorator                             |     @my_new_decorator</span>
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, **super_kwargs</span>):            |     <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">
    <span class="hljs-built_in">super</span>(<span class="hljs-params"></span>).forward(<span class="hljs-params">**super_kwargs</span>)             |         self,
                                                |         input_ids: torch.LongTensor = <span class="hljs-literal">None</span>,
                                                |         attention_mask: <span class="hljs-type">Optional</span>[torch.Tensor] = <span class="hljs-literal">None</span>,
                                                |         position_ids: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
                                                |         past_key_values: <span class="hljs-type">Optional</span>[<span class="hljs-type">Union</span>[Cache, <span class="hljs-built_in">list</span>[torch.FloatTensor]]] = |<span class="hljs-literal">None</span>,
                                                |         inputs_embeds: <span class="hljs-type">Optional</span>[torch.FloatTensor] = <span class="hljs-literal">None</span>,
                                                |         labels: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
                                                |         use_cache: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
                                                |         output_attentions: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
                                                |         output_hidden_states: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
                                                |         return_dict: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">None</span>,
                                                |         cache_position: <span class="hljs-type">Optional</span>[torch.LongTensor] = <span class="hljs-literal">None</span>,
                                                |         num_logits_to_keep: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>,
                                                |         **kwargs: Unpack[KwargsForCausalLM],
                                                |     </span>) -&gt; <span class="hljs-type">Union</span>[<span class="hljs-type">Tuple</span>, CausalLMOutputWithPast]:
                                                |       ...`,wrap:!1}}),ae=new J({props:{title:"Docstring variables",local:"docstring-variables",headingTag:"h2"}}),I=new Vt({props:{warning:!1,$$slots:{default:[Ot]},$$scope:{ctx:Ie}}}),ie=new c({props:{code:"U1RBUkNPREVSMl9JTlBVVFNfRE9DU1RSSU5HJTIwJTNEJTIwTm9uZSUyMCUyMCUyMyUyMHdpbGwlMjBiZSUyMGF1dG9tYXRpY2FsbHklMjByZWRlZmluZWQlMEElMEFjbGFzcyUyMFN0YXJjb2RlcjJNb2RlbChNaXN0cmFsTW9kZWwpJTNBJTBBJTIwJTIwJTIwJTIwLi4uJTBBJTBBJTIwJTIwJTIwJTIwJTQwYWRkX3N0YXJ0X2RvY3N0cmluZ3NfdG9fbW9kZWxfZm9yd2FyZChTVEFSQ09ERVIyX0lOUFVUU19ET0NTVFJJTkcpJTBBJTIwJTIwJTIwJTIwZGVmJTIwZm9yd2FyZCguLi4pJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwLi4u",highlighted:`STARCODER2_INPUTS_DOCSTRING = <span class="hljs-literal">None</span>  <span class="hljs-comment"># will be automatically redefined</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Starcoder2Model</span>(<span class="hljs-title class_ inherited__">MistralModel</span>):
    ...

<span class="hljs-meta">    @add_start_docstrings_to_model_forward(<span class="hljs-params">STARCODER2_INPUTS_DOCSTRING</span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">...</span>)
        ...`,wrap:!1}}),oe=new J({props:{title:"Special naming",local:"special-naming",headingTag:"h2"}}),de=new c({props:{code:"Y2xhc3MlMjBNeU1vZGVsSW5jcmVkaWJsZU1MUChMbGFtYU1MUCklM0ElMEElMjAlMjAlMjAlMjAuLi4lMEElMEFjbGFzcyUyME15TW9kZWxEZWNvZGVyTGF5ZXIoTGxhbWFEZWNvZGVyTGF5ZXIpJTNBJTBBJTIwJTIwJTIwJTIwLi4u",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModelIncredibleMLP</span>(<span class="hljs-title class_ inherited__">LlamaMLP</span>):
    ...

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModelDecoderLayer</span>(<span class="hljs-title class_ inherited__">LlamaDecoderLayer</span>):
    ...`,wrap:!1}}),ce=new c({props:{code:"V2UlMjBkZXRlY3RlZCUyMG11bHRpcGxlJTIwcHJlZml4JTIwbmFtZXMlMjB3aGVuJTIwaW5oZXJpdGluZyUyMGZyb20lMjB0cmFuc2Zvcm1lcnMubW9kZWxzLmxsYW1hLm1vZGVsaW5nX2xsYW1hJTNBJTIwKCdFbXUzVGV4dCclMkMlMjAnRW11MycpLiUyMFdlJTIwd2lsbCUyMG9ubHklMjB1c2UlMjB0aGUlMjBtb3N0JTIwdXNlZCUyMCdFbXUzJyUyMHByZWZpeCUyMHdoZW4lMjBncmFiYmluZyUyMGFyZ3MlMjBhbmQlMjBkZXBlbmRlbmNpZXMuJTIwTWFrZSUyMHN1cmUlMjB0byUyMHN1YmNsYXNzJTIwdGhlJTIwaW50ZXJtZWRpYXRlJTIwY2xhc3NlcyUyMHdpdGglMjB0aGUlMjBwcmVmaXglMjB5b3UlMjB3YW50JTIwKGlmJTIwZGlmZmVyZW50JTIwZnJvbSUyMCdFbXUzJyklMjBvciUyMHVzZSUyMGElMjBzaW5nbGUlMjBwcmVmaXglMjBpbiUyMGFsbCUyMHRoZSUyMG1vZHVsYXIlMjAoYmVzdCku",highlighted:'We detected multiple prefix names when inheriting <span class="hljs-keyword">from</span> transformers.models.llama.modeling_llama: (<span class="hljs-string">&#x27;Emu3Text&#x27;</span>, <span class="hljs-string">&#x27;Emu3&#x27;</span>). We will only use the most used <span class="hljs-string">&#x27;Emu3&#x27;</span> prefix when grabbing args <span class="hljs-keyword">and</span> dependencies. Make sure to subclass the intermediate classes <span class="hljs-keyword">with</span> the prefix you want (<span class="hljs-keyword">if</span> different <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;Emu3&#x27;</span>) <span class="hljs-keyword">or</span> use a single prefix <span class="hljs-keyword">in</span> <span class="hljs-built_in">all</span> the modular (best).',wrap:!1}}),je=new c({props:{code:"Y2xhc3MlMjBFbXUzVGV4dE1MUChMbGFtYU1MUCklM0ElMEElMjAlMjAlMjAlMjBwYXNz",highlighted:`<span class="hljs-keyword">class</span> <span class="hljs-title class_">Emu3TextMLP</span>(<span class="hljs-title class_ inherited__">LlamaMLP</span>):
    <span class="hljs-keyword">pass</span>`,wrap:!1}}),re=new J({props:{title:"Config docstrings",local:"config-docstrings",headingTag:"h2"}}),he=new Ht({props:{source:"https://github.com/huggingface/transformers/blob/main/docs/source/en/modular_transformers.md"}}),{c(){C=n("meta"),r=t(),j=n("p"),m=t(),U(u.$$.fragment),fe=t(),f=n("p"),f.textContent=AM,be=t(),b=n("p"),b.innerHTML=_M,Ae=t(),A=n("p"),A.innerHTML=ZM,_e=t(),U(_.$$.fragment),Ze=t(),Z=n("p"),Z.innerHTML=GM,Ge=t(),U(h.$$.fragment),Be=t(),G=n("p"),G.textContent=BM,ke=t(),B=n("p"),B.textContent=kM,Re=t(),U(k.$$.fragment),ge=t(),R=n("p"),R.innerHTML=RM,ve=t(),g=n("p"),g.innerHTML=gM,We=t(),U(v.$$.fragment),Ne=t(),W=n("p"),W.textContent=vM,Xe=t(),N=n("ul"),N.innerHTML=WM,Ee=t(),X=n("p"),X.textContent=NM,Ve=t(),E=n("p"),E.textContent=XM,$e=t(),U(V.$$.fragment),Ye=t(),$=n("p"),$.textContent=EM,Qe=t(),Y=n("p"),Y.innerHTML=VM,Se=t(),U(Q.$$.fragment),xe=t(),S=n("p"),S.textContent=$M,ze=t(),U(x.$$.fragment),Le=t(),U(z.$$.fragment),He=t(),L=n("p"),L.innerHTML=YM,Fe=t(),H=n("table"),H.innerHTML=QM,Oe=t(),F=n("p"),F.innerHTML=SM,De=t(),U(O.$$.fragment),Pe=t(),D=n("p"),D.innerHTML=xM,Ke=t(),U(P.$$.fragment),qe=t(),K=n("p"),K.innerHTML=zM,ls=t(),q=n("ol"),q.innerHTML=LM,es=t(),ll=n("p"),ll.innerHTML=HM,ss=t(),el=n("p"),el.innerHTML=FM,Ms=t(),sl=n("p"),sl.innerHTML=OM,ts=t(),Ml=n("p"),Ml.innerHTML=DM,as=t(),U(tl.$$.fragment),ns=t(),U(al.$$.fragment),ys=t(),nl=n("p"),nl.innerHTML=PM,is=t(),U(yl.$$.fragment),Us=t(),il=n("p"),il.innerHTML=KM,os=t(),U(Ul.$$.fragment),ps=t(),ol=n("p"),ol.innerHTML=qM,ws=t(),pl=n("p"),pl.innerHTML=lt,ds=t(),wl=n("p"),wl.innerHTML=et,Ts=t(),U(dl.$$.fragment),Cs=t(),Tl=n("p"),Tl.innerHTML=st,cs=t(),U(Cl.$$.fragment),Js=t(),cl=n("p"),cl.innerHTML=Mt,js=t(),Jl=n("p"),Jl.innerHTML=tt,rs=t(),U(jl.$$.fragment),ms=t(),rl=n("p"),rl.innerHTML=at,hs=t(),U(ml.$$.fragment),Is=t(),hl=n("p"),hl.innerHTML=nt,us=t(),U(Il.$$.fragment),fs=t(),ul=n("p"),ul.textContent=yt,bs=t(),U(fl.$$.fragment),As=t(),bl=n("p"),bl.innerHTML=it,_s=t(),U(Al.$$.fragment),Zs=t(),_l=n("p"),_l.innerHTML=Ut,Gs=t(),Zl=n("p"),Zl.innerHTML=ot,Bs=t(),Gl=n("p"),Gl.innerHTML=pt,ks=t(),U(Bl.$$.fragment),Rs=t(),kl=n("p"),kl.innerHTML=wt,gs=t(),Rl=n("p"),Rl.innerHTML=dt,vs=t(),U(gl.$$.fragment),Ws=t(),U(vl.$$.fragment),Ns=t(),Wl=n("p"),Wl.innerHTML=Tt,Xs=t(),U(Nl.$$.fragment),Es=t(),U(Xl.$$.fragment),Vs=t(),El=n("p"),El.innerHTML=Ct,$s=t(),U(Vl.$$.fragment),Ys=t(),U($l.$$.fragment),Qs=t(),Yl=n("p"),Yl.innerHTML=ct,Ss=t(),U(Ql.$$.fragment),xs=t(),U(Sl.$$.fragment),zs=t(),xl=n("p"),xl.innerHTML=Jt,Ls=t(),zl=n("p"),zl.textContent=jt,Hs=t(),U(Ll.$$.fragment),Fs=t(),Hl=n("p"),Hl.textContent=rt,Os=t(),U(Fl.$$.fragment),Ds=t(),Ol=n("p"),Ol.textContent=mt,Ps=t(),U(Dl.$$.fragment),Ks=t(),U(Pl.$$.fragment),qs=t(),Kl=n("p"),Kl.innerHTML=ht,lM=t(),ql=n("p"),ql.innerHTML=It,eM=t(),U(le.$$.fragment),sM=t(),ee=n("p"),ee.innerHTML=ut,MM=t(),U(se.$$.fragment),tM=t(),Me=n("p"),Me.textContent=ft,aM=t(),te=n("p"),te.innerHTML=bt,nM=t(),U(ae.$$.fragment),yM=t(),U(I.$$.fragment),iM=t(),ne=n("p"),ne.innerHTML=At,UM=t(),ye=n("p"),ye.innerHTML=_t,oM=t(),U(ie.$$.fragment),pM=t(),Ue=n("p"),Ue.innerHTML=Zt,wM=t(),U(oe.$$.fragment),dM=t(),pe=n("p"),pe.textContent=Gt,TM=t(),we=n("p"),we.innerHTML=Bt,CM=t(),U(de.$$.fragment),cM=t(),Te=n("p"),Te.innerHTML=kt,JM=t(),Ce=n("p"),Ce.innerHTML=Rt,jM=t(),U(ce.$$.fragment),rM=t(),Je=n("p"),Je.innerHTML=gt,mM=t(),U(je.$$.fragment),hM=t(),U(re.$$.fragment),IM=t(),me=n("p"),me.innerHTML=vt,uM=t(),U(he.$$.fragment),fM=t(),ue=n("p"),this.h()},l(l){const e=zt("svelte-u9bgzb",document.head);C=y(e,"META",{name:!0,content:!0}),e.forEach(s),r=a(l),j=y(l,"P",{}),Xt(j).forEach(s),m=a(l),o(u.$$.fragment,l),fe=a(l),f=y(l,"P",{"data-svelte-h":!0}),i(f)!=="svelte-lj81hr"&&(f.textContent=AM),be=a(l),b=y(l,"P",{"data-svelte-h":!0}),i(b)!=="svelte-1fibcpl"&&(b.innerHTML=_M),Ae=a(l),A=y(l,"P",{"data-svelte-h":!0}),i(A)!=="svelte-12jtllm"&&(A.innerHTML=ZM),_e=a(l),o(_.$$.fragment,l),Ze=a(l),Z=y(l,"P",{"data-svelte-h":!0}),i(Z)!=="svelte-wcqh4p"&&(Z.innerHTML=GM),Ge=a(l),o(h.$$.fragment,l),Be=a(l),G=y(l,"P",{"data-svelte-h":!0}),i(G)!=="svelte-sz29kf"&&(G.textContent=BM),ke=a(l),B=y(l,"P",{"data-svelte-h":!0}),i(B)!=="svelte-1n4f4or"&&(B.textContent=kM),Re=a(l),o(k.$$.fragment,l),ge=a(l),R=y(l,"P",{"data-svelte-h":!0}),i(R)!=="svelte-12wgxa8"&&(R.innerHTML=RM),ve=a(l),g=y(l,"P",{"data-svelte-h":!0}),i(g)!=="svelte-jegoy5"&&(g.innerHTML=gM),We=a(l),o(v.$$.fragment,l),Ne=a(l),W=y(l,"P",{"data-svelte-h":!0}),i(W)!=="svelte-1gkqha7"&&(W.textContent=vM),Xe=a(l),N=y(l,"UL",{"data-svelte-h":!0}),i(N)!=="svelte-2znzcv"&&(N.innerHTML=WM),Ee=a(l),X=y(l,"P",{"data-svelte-h":!0}),i(X)!=="svelte-1q8tpr3"&&(X.textContent=NM),Ve=a(l),E=y(l,"P",{"data-svelte-h":!0}),i(E)!=="svelte-fj797c"&&(E.textContent=XM),$e=a(l),o(V.$$.fragment,l),Ye=a(l),$=y(l,"P",{"data-svelte-h":!0}),i($)!=="svelte-1tajku"&&($.textContent=EM),Qe=a(l),Y=y(l,"P",{"data-svelte-h":!0}),i(Y)!=="svelte-1izmokq"&&(Y.innerHTML=VM),Se=a(l),o(Q.$$.fragment,l),xe=a(l),S=y(l,"P",{"data-svelte-h":!0}),i(S)!=="svelte-1hj80v9"&&(S.textContent=$M),ze=a(l),o(x.$$.fragment,l),Le=a(l),o(z.$$.fragment,l),He=a(l),L=y(l,"P",{"data-svelte-h":!0}),i(L)!=="svelte-jkrdf9"&&(L.innerHTML=YM),Fe=a(l),H=y(l,"TABLE",{"data-svelte-h":!0}),i(H)!=="svelte-smzi7r"&&(H.innerHTML=QM),Oe=a(l),F=y(l,"P",{"data-svelte-h":!0}),i(F)!=="svelte-vpi0ku"&&(F.innerHTML=SM),De=a(l),o(O.$$.fragment,l),Pe=a(l),D=y(l,"P",{"data-svelte-h":!0}),i(D)!=="svelte-1yjd5s7"&&(D.innerHTML=xM),Ke=a(l),o(P.$$.fragment,l),qe=a(l),K=y(l,"P",{"data-svelte-h":!0}),i(K)!=="svelte-q0b1mo"&&(K.innerHTML=zM),ls=a(l),q=y(l,"OL",{"data-svelte-h":!0}),i(q)!=="svelte-139or2s"&&(q.innerHTML=LM),es=a(l),ll=y(l,"P",{"data-svelte-h":!0}),i(ll)!=="svelte-3ks7rn"&&(ll.innerHTML=HM),ss=a(l),el=y(l,"P",{"data-svelte-h":!0}),i(el)!=="svelte-11wms29"&&(el.innerHTML=FM),Ms=a(l),sl=y(l,"P",{"data-svelte-h":!0}),i(sl)!=="svelte-yznf21"&&(sl.innerHTML=OM),ts=a(l),Ml=y(l,"P",{"data-svelte-h":!0}),i(Ml)!=="svelte-1i7o0i6"&&(Ml.innerHTML=DM),as=a(l),o(tl.$$.fragment,l),ns=a(l),o(al.$$.fragment,l),ys=a(l),nl=y(l,"P",{"data-svelte-h":!0}),i(nl)!=="svelte-12zqvql"&&(nl.innerHTML=PM),is=a(l),o(yl.$$.fragment,l),Us=a(l),il=y(l,"P",{"data-svelte-h":!0}),i(il)!=="svelte-suxygn"&&(il.innerHTML=KM),os=a(l),o(Ul.$$.fragment,l),ps=a(l),ol=y(l,"P",{"data-svelte-h":!0}),i(ol)!=="svelte-1k0gkac"&&(ol.innerHTML=qM),ws=a(l),pl=y(l,"P",{"data-svelte-h":!0}),i(pl)!=="svelte-10o1ggb"&&(pl.innerHTML=lt),ds=a(l),wl=y(l,"P",{"data-svelte-h":!0}),i(wl)!=="svelte-1y0dfl"&&(wl.innerHTML=et),Ts=a(l),o(dl.$$.fragment,l),Cs=a(l),Tl=y(l,"P",{"data-svelte-h":!0}),i(Tl)!=="svelte-jueczp"&&(Tl.innerHTML=st),cs=a(l),o(Cl.$$.fragment,l),Js=a(l),cl=y(l,"P",{"data-svelte-h":!0}),i(cl)!=="svelte-1grcsyb"&&(cl.innerHTML=Mt),js=a(l),Jl=y(l,"P",{"data-svelte-h":!0}),i(Jl)!=="svelte-krborp"&&(Jl.innerHTML=tt),rs=a(l),o(jl.$$.fragment,l),ms=a(l),rl=y(l,"P",{"data-svelte-h":!0}),i(rl)!=="svelte-12qws02"&&(rl.innerHTML=at),hs=a(l),o(ml.$$.fragment,l),Is=a(l),hl=y(l,"P",{"data-svelte-h":!0}),i(hl)!=="svelte-2efkpk"&&(hl.innerHTML=nt),us=a(l),o(Il.$$.fragment,l),fs=a(l),ul=y(l,"P",{"data-svelte-h":!0}),i(ul)!=="svelte-111k955"&&(ul.textContent=yt),bs=a(l),o(fl.$$.fragment,l),As=a(l),bl=y(l,"P",{"data-svelte-h":!0}),i(bl)!=="svelte-ue8kve"&&(bl.innerHTML=it),_s=a(l),o(Al.$$.fragment,l),Zs=a(l),_l=y(l,"P",{"data-svelte-h":!0}),i(_l)!=="svelte-j99j4d"&&(_l.innerHTML=Ut),Gs=a(l),Zl=y(l,"P",{"data-svelte-h":!0}),i(Zl)!=="svelte-1mv6aiq"&&(Zl.innerHTML=ot),Bs=a(l),Gl=y(l,"P",{"data-svelte-h":!0}),i(Gl)!=="svelte-li8sd3"&&(Gl.innerHTML=pt),ks=a(l),o(Bl.$$.fragment,l),Rs=a(l),kl=y(l,"P",{"data-svelte-h":!0}),i(kl)!=="svelte-1qoxxsw"&&(kl.innerHTML=wt),gs=a(l),Rl=y(l,"P",{"data-svelte-h":!0}),i(Rl)!=="svelte-16zifu2"&&(Rl.innerHTML=dt),vs=a(l),o(gl.$$.fragment,l),Ws=a(l),o(vl.$$.fragment,l),Ns=a(l),Wl=y(l,"P",{"data-svelte-h":!0}),i(Wl)!=="svelte-1reud8e"&&(Wl.innerHTML=Tt),Xs=a(l),o(Nl.$$.fragment,l),Es=a(l),o(Xl.$$.fragment,l),Vs=a(l),El=y(l,"P",{"data-svelte-h":!0}),i(El)!=="svelte-1nslgmc"&&(El.innerHTML=Ct),$s=a(l),o(Vl.$$.fragment,l),Ys=a(l),o($l.$$.fragment,l),Qs=a(l),Yl=y(l,"P",{"data-svelte-h":!0}),i(Yl)!=="svelte-ho137b"&&(Yl.innerHTML=ct),Ss=a(l),o(Ql.$$.fragment,l),xs=a(l),o(Sl.$$.fragment,l),zs=a(l),xl=y(l,"P",{"data-svelte-h":!0}),i(xl)!=="svelte-mwxhil"&&(xl.innerHTML=Jt),Ls=a(l),zl=y(l,"P",{"data-svelte-h":!0}),i(zl)!=="svelte-8g3zpp"&&(zl.textContent=jt),Hs=a(l),o(Ll.$$.fragment,l),Fs=a(l),Hl=y(l,"P",{"data-svelte-h":!0}),i(Hl)!=="svelte-hkv2ct"&&(Hl.textContent=rt),Os=a(l),o(Fl.$$.fragment,l),Ds=a(l),Ol=y(l,"P",{"data-svelte-h":!0}),i(Ol)!=="svelte-1b9k8jx"&&(Ol.textContent=mt),Ps=a(l),o(Dl.$$.fragment,l),Ks=a(l),o(Pl.$$.fragment,l),qs=a(l),Kl=y(l,"P",{"data-svelte-h":!0}),i(Kl)!=="svelte-ce3ins"&&(Kl.innerHTML=ht),lM=a(l),ql=y(l,"P",{"data-svelte-h":!0}),i(ql)!=="svelte-kakcd4"&&(ql.innerHTML=It),eM=a(l),o(le.$$.fragment,l),sM=a(l),ee=y(l,"P",{"data-svelte-h":!0}),i(ee)!=="svelte-161qf9e"&&(ee.innerHTML=ut),MM=a(l),o(se.$$.fragment,l),tM=a(l),Me=y(l,"P",{"data-svelte-h":!0}),i(Me)!=="svelte-1w35umg"&&(Me.textContent=ft),aM=a(l),te=y(l,"P",{"data-svelte-h":!0}),i(te)!=="svelte-1x7kbin"&&(te.innerHTML=bt),nM=a(l),o(ae.$$.fragment,l),yM=a(l),o(I.$$.fragment,l),iM=a(l),ne=y(l,"P",{"data-svelte-h":!0}),i(ne)!=="svelte-dnuz94"&&(ne.innerHTML=At),UM=a(l),ye=y(l,"P",{"data-svelte-h":!0}),i(ye)!=="svelte-1a2wp3o"&&(ye.innerHTML=_t),oM=a(l),o(ie.$$.fragment,l),pM=a(l),Ue=y(l,"P",{"data-svelte-h":!0}),i(Ue)!=="svelte-zwpgdq"&&(Ue.innerHTML=Zt),wM=a(l),o(oe.$$.fragment,l),dM=a(l),pe=y(l,"P",{"data-svelte-h":!0}),i(pe)!=="svelte-1r96udu"&&(pe.textContent=Gt),TM=a(l),we=y(l,"P",{"data-svelte-h":!0}),i(we)!=="svelte-1w8gdvq"&&(we.innerHTML=Bt),CM=a(l),o(de.$$.fragment,l),cM=a(l),Te=y(l,"P",{"data-svelte-h":!0}),i(Te)!=="svelte-ce2erv"&&(Te.innerHTML=kt),JM=a(l),Ce=y(l,"P",{"data-svelte-h":!0}),i(Ce)!=="svelte-1n8wdp0"&&(Ce.innerHTML=Rt),jM=a(l),o(ce.$$.fragment,l),rM=a(l),Je=y(l,"P",{"data-svelte-h":!0}),i(Je)!=="svelte-3dj83y"&&(Je.innerHTML=gt),mM=a(l),o(je.$$.fragment,l),hM=a(l),o(re.$$.fragment,l),IM=a(l),me=y(l,"P",{"data-svelte-h":!0}),i(me)!=="svelte-msrgaf"&&(me.innerHTML=vt),uM=a(l),o(he.$$.fragment,l),fM=a(l),ue=y(l,"P",{}),Xt(ue).forEach(s),this.h()},h(){Et(C,"name","hf:doc:metadata"),Et(C,"content",Pt)},m(l,e){Lt(document.head,C),M(l,r,e),M(l,j,e),M(l,m,e),p(u,l,e),M(l,fe,e),M(l,f,e),M(l,be,e),M(l,b,e),M(l,Ae,e),M(l,A,e),M(l,_e,e),p(_,l,e),M(l,Ze,e),M(l,Z,e),M(l,Ge,e),p(h,l,e),M(l,Be,e),M(l,G,e),M(l,ke,e),M(l,B,e),M(l,Re,e),p(k,l,e),M(l,ge,e),M(l,R,e),M(l,ve,e),M(l,g,e),M(l,We,e),p(v,l,e),M(l,Ne,e),M(l,W,e),M(l,Xe,e),M(l,N,e),M(l,Ee,e),M(l,X,e),M(l,Ve,e),M(l,E,e),M(l,$e,e),p(V,l,e),M(l,Ye,e),M(l,$,e),M(l,Qe,e),M(l,Y,e),M(l,Se,e),p(Q,l,e),M(l,xe,e),M(l,S,e),M(l,ze,e),p(x,l,e),M(l,Le,e),p(z,l,e),M(l,He,e),M(l,L,e),M(l,Fe,e),M(l,H,e),M(l,Oe,e),M(l,F,e),M(l,De,e),p(O,l,e),M(l,Pe,e),M(l,D,e),M(l,Ke,e),p(P,l,e),M(l,qe,e),M(l,K,e),M(l,ls,e),M(l,q,e),M(l,es,e),M(l,ll,e),M(l,ss,e),M(l,el,e),M(l,Ms,e),M(l,sl,e),M(l,ts,e),M(l,Ml,e),M(l,as,e),p(tl,l,e),M(l,ns,e),p(al,l,e),M(l,ys,e),M(l,nl,e),M(l,is,e),p(yl,l,e),M(l,Us,e),M(l,il,e),M(l,os,e),p(Ul,l,e),M(l,ps,e),M(l,ol,e),M(l,ws,e),M(l,pl,e),M(l,ds,e),M(l,wl,e),M(l,Ts,e),p(dl,l,e),M(l,Cs,e),M(l,Tl,e),M(l,cs,e),p(Cl,l,e),M(l,Js,e),M(l,cl,e),M(l,js,e),M(l,Jl,e),M(l,rs,e),p(jl,l,e),M(l,ms,e),M(l,rl,e),M(l,hs,e),p(ml,l,e),M(l,Is,e),M(l,hl,e),M(l,us,e),p(Il,l,e),M(l,fs,e),M(l,ul,e),M(l,bs,e),p(fl,l,e),M(l,As,e),M(l,bl,e),M(l,_s,e),p(Al,l,e),M(l,Zs,e),M(l,_l,e),M(l,Gs,e),M(l,Zl,e),M(l,Bs,e),M(l,Gl,e),M(l,ks,e),p(Bl,l,e),M(l,Rs,e),M(l,kl,e),M(l,gs,e),M(l,Rl,e),M(l,vs,e),p(gl,l,e),M(l,Ws,e),p(vl,l,e),M(l,Ns,e),M(l,Wl,e),M(l,Xs,e),p(Nl,l,e),M(l,Es,e),p(Xl,l,e),M(l,Vs,e),M(l,El,e),M(l,$s,e),p(Vl,l,e),M(l,Ys,e),p($l,l,e),M(l,Qs,e),M(l,Yl,e),M(l,Ss,e),p(Ql,l,e),M(l,xs,e),p(Sl,l,e),M(l,zs,e),M(l,xl,e),M(l,Ls,e),M(l,zl,e),M(l,Hs,e),p(Ll,l,e),M(l,Fs,e),M(l,Hl,e),M(l,Os,e),p(Fl,l,e),M(l,Ds,e),M(l,Ol,e),M(l,Ps,e),p(Dl,l,e),M(l,Ks,e),p(Pl,l,e),M(l,qs,e),M(l,Kl,e),M(l,lM,e),M(l,ql,e),M(l,eM,e),p(le,l,e),M(l,sM,e),M(l,ee,e),M(l,MM,e),p(se,l,e),M(l,tM,e),M(l,Me,e),M(l,aM,e),M(l,te,e),M(l,nM,e),p(ae,l,e),M(l,yM,e),p(I,l,e),M(l,iM,e),M(l,ne,e),M(l,UM,e),M(l,ye,e),M(l,oM,e),p(ie,l,e),M(l,pM,e),M(l,Ue,e),M(l,wM,e),p(oe,l,e),M(l,dM,e),M(l,pe,e),M(l,TM,e),M(l,we,e),M(l,CM,e),p(de,l,e),M(l,cM,e),M(l,Te,e),M(l,JM,e),M(l,Ce,e),M(l,jM,e),p(ce,l,e),M(l,rM,e),M(l,Je,e),M(l,mM,e),p(je,l,e),M(l,hM,e),p(re,l,e),M(l,IM,e),M(l,me,e),M(l,uM,e),p(he,l,e),M(l,fM,e),M(l,ue,e),bM=!0},p(l,[e]){const Wt={};e&2&&(Wt.$$scope={dirty:e,ctx:l}),h.$set(Wt);const Nt={};e&2&&(Nt.$$scope={dirty:e,ctx:l}),I.$set(Nt)},i(l){bM||(w(u.$$.fragment,l),w(_.$$.fragment,l),w(h.$$.fragment,l),w(k.$$.fragment,l),w(v.$$.fragment,l),w(V.$$.fragment,l),w(Q.$$.fragment,l),w(x.$$.fragment,l),w(z.$$.fragment,l),w(O.$$.fragment,l),w(P.$$.fragment,l),w(tl.$$.fragment,l),w(al.$$.fragment,l),w(yl.$$.fragment,l),w(Ul.$$.fragment,l),w(dl.$$.fragment,l),w(Cl.$$.fragment,l),w(jl.$$.fragment,l),w(ml.$$.fragment,l),w(Il.$$.fragment,l),w(fl.$$.fragment,l),w(Al.$$.fragment,l),w(Bl.$$.fragment,l),w(gl.$$.fragment,l),w(vl.$$.fragment,l),w(Nl.$$.fragment,l),w(Xl.$$.fragment,l),w(Vl.$$.fragment,l),w($l.$$.fragment,l),w(Ql.$$.fragment,l),w(Sl.$$.fragment,l),w(Ll.$$.fragment,l),w(Fl.$$.fragment,l),w(Dl.$$.fragment,l),w(Pl.$$.fragment,l),w(le.$$.fragment,l),w(se.$$.fragment,l),w(ae.$$.fragment,l),w(I.$$.fragment,l),w(ie.$$.fragment,l),w(oe.$$.fragment,l),w(de.$$.fragment,l),w(ce.$$.fragment,l),w(je.$$.fragment,l),w(re.$$.fragment,l),w(he.$$.fragment,l),bM=!0)},o(l){d(u.$$.fragment,l),d(_.$$.fragment,l),d(h.$$.fragment,l),d(k.$$.fragment,l),d(v.$$.fragment,l),d(V.$$.fragment,l),d(Q.$$.fragment,l),d(x.$$.fragment,l),d(z.$$.fragment,l),d(O.$$.fragment,l),d(P.$$.fragment,l),d(tl.$$.fragment,l),d(al.$$.fragment,l),d(yl.$$.fragment,l),d(Ul.$$.fragment,l),d(dl.$$.fragment,l),d(Cl.$$.fragment,l),d(jl.$$.fragment,l),d(ml.$$.fragment,l),d(Il.$$.fragment,l),d(fl.$$.fragment,l),d(Al.$$.fragment,l),d(Bl.$$.fragment,l),d(gl.$$.fragment,l),d(vl.$$.fragment,l),d(Nl.$$.fragment,l),d(Xl.$$.fragment,l),d(Vl.$$.fragment,l),d($l.$$.fragment,l),d(Ql.$$.fragment,l),d(Sl.$$.fragment,l),d(Ll.$$.fragment,l),d(Fl.$$.fragment,l),d(Dl.$$.fragment,l),d(Pl.$$.fragment,l),d(le.$$.fragment,l),d(se.$$.fragment,l),d(ae.$$.fragment,l),d(I.$$.fragment,l),d(ie.$$.fragment,l),d(oe.$$.fragment,l),d(de.$$.fragment,l),d(ce.$$.fragment,l),d(je.$$.fragment,l),d(re.$$.fragment,l),d(he.$$.fragment,l),bM=!1},d(l){l&&(s(r),s(j),s(m),s(fe),s(f),s(be),s(b),s(Ae),s(A),s(_e),s(Ze),s(Z),s(Ge),s(Be),s(G),s(ke),s(B),s(Re),s(ge),s(R),s(ve),s(g),s(We),s(Ne),s(W),s(Xe),s(N),s(Ee),s(X),s(Ve),s(E),s($e),s(Ye),s($),s(Qe),s(Y),s(Se),s(xe),s(S),s(ze),s(Le),s(He),s(L),s(Fe),s(H),s(Oe),s(F),s(De),s(Pe),s(D),s(Ke),s(qe),s(K),s(ls),s(q),s(es),s(ll),s(ss),s(el),s(Ms),s(sl),s(ts),s(Ml),s(as),s(ns),s(ys),s(nl),s(is),s(Us),s(il),s(os),s(ps),s(ol),s(ws),s(pl),s(ds),s(wl),s(Ts),s(Cs),s(Tl),s(cs),s(Js),s(cl),s(js),s(Jl),s(rs),s(ms),s(rl),s(hs),s(Is),s(hl),s(us),s(fs),s(ul),s(bs),s(As),s(bl),s(_s),s(Zs),s(_l),s(Gs),s(Zl),s(Bs),s(Gl),s(ks),s(Rs),s(kl),s(gs),s(Rl),s(vs),s(Ws),s(Ns),s(Wl),s(Xs),s(Es),s(Vs),s(El),s($s),s(Ys),s(Qs),s(Yl),s(Ss),s(xs),s(zs),s(xl),s(Ls),s(zl),s(Hs),s(Fs),s(Hl),s(Os),s(Ds),s(Ol),s(Ps),s(Ks),s(qs),s(Kl),s(lM),s(ql),s(eM),s(sM),s(ee),s(MM),s(tM),s(Me),s(aM),s(te),s(nM),s(yM),s(iM),s(ne),s(UM),s(ye),s(oM),s(pM),s(Ue),s(wM),s(dM),s(pe),s(TM),s(we),s(CM),s(cM),s(Te),s(JM),s(Ce),s(jM),s(rM),s(Je),s(mM),s(hM),s(IM),s(me),s(uM),s(fM),s(ue)),s(C),T(u,l),T(_,l),T(h,l),T(k,l),T(v,l),T(V,l),T(Q,l),T(x,l),T(z,l),T(O,l),T(P,l),T(tl,l),T(al,l),T(yl,l),T(Ul,l),T(dl,l),T(Cl,l),T(jl,l),T(ml,l),T(Il,l),T(fl,l),T(Al,l),T(Bl,l),T(gl,l),T(vl,l),T(Nl,l),T(Xl,l),T(Vl,l),T($l,l),T(Ql,l),T(Sl,l),T(Ll,l),T(Fl,l),T(Dl,l),T(Pl,l),T(le,l),T(se,l),T(ae,l),T(I,l),T(ie,l),T(oe,l),T(de,l),T(ce,l),T(je,l),T(re,l),T(he,l)}}}const Pt='{"title":"Contributing a new model to Transformers","local":"contributing-a-new-model-to-transformers","sections":[{"title":"Motivation","local":"motivation","sections":[],"depth":2},{"title":"Create a modeling.py file","local":"create-a-modelingpy-file","sections":[{"title":"BERT and RoBERTa","local":"bert-and-roberta","sections":[],"depth":3}],"depth":2},{"title":"Implementing a modular file","local":"implementing-a-modular-file","sections":[{"title":"Config","local":"config","sections":[],"depth":3},{"title":"Norm","local":"norm","sections":[],"depth":3},{"title":"Attention","local":"attention","sections":[],"depth":3},{"title":"DecoderLayer","local":"decoderlayer","sections":[],"depth":3},{"title":"Model","local":"model","sections":[],"depth":3},{"title":"Model head","local":"model-head","sections":[],"depth":3},{"title":"Other classes","local":"other-classes","sections":[],"depth":3}],"depth":2},{"title":"Removing attributes","local":"removing-attributes","sections":[],"depth":2},{"title":"Calling parent methods without unravelling their definition","local":"calling-parent-methods-without-unravelling-their-definition","sections":[],"depth":2},{"title":"Deleting unused methods","local":"deleting-unused-methods","sections":[],"depth":2},{"title":"Defining new functions","local":"defining-new-functions","sections":[],"depth":2},{"title":"super_kwargs","local":"superkwargs","sections":[],"depth":2},{"title":"Docstring variables","local":"docstring-variables","sections":[],"depth":2},{"title":"Special naming","local":"special-naming","sections":[],"depth":2},{"title":"Config docstrings","local":"config-docstrings","sections":[],"depth":2}],"depth":1}';function Kt(Ie){return Qt(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class ta extends St{constructor(C){super(),xt(this,C,Kt,Dt,Yt,{})}}export{ta as component};
