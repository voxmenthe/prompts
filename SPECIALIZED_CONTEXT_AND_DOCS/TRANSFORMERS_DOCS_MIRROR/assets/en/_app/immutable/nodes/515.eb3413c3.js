import{s as ft,o as ut,n as O}from"../chunks/scheduler.18a86fab.js";import{S as ct,i as dt,g as u,s as r,r as d,A as $t,h as c,f as n,c as p,j as it,u as $,x as C,k as rt,y as ht,a as o,v as h,d as g,t as M,w as b}from"../chunks/index.98837b22.js";import{T as gt}from"../chunks/Tip.77304350.js";import{C as D}from"../chunks/CodeBlock.8d0c2e8a.js";import{H as pt,E as Mt}from"../chunks/getInferenceSnippets.06c2775f.js";import{H as bt,a as mt}from"../chunks/HfOption.6641485e.js";function wt(w){let e,i;return e=new D({props:{code:"cGlwJTIwaW5zdGFsbCUyMGZsdXRlLWtlcm5lbA==",highlighted:"pip install flute-kernel",wrap:!1}}),{c(){d(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,m){h(e,l,m),i=!0},p:O,i(l){i||(g(e.$$.fragment,l),i=!0)},o(l){M(e.$$.fragment,l),i=!1},d(l){b(e,l)}}}function Tt(w){let e,i;return e=new D({props:{code:"cGlwJTIwaW5zdGFsbCUyMGZsdXRlLWtlcm5lbCUyMC1pJTIwaHR0cHMlM0ElMkYlMkZmbHV0ZS1haS5naXRodWIuaW8lMkZ3aGwlMkZjdTEyLjQ=",highlighted:"pip install flute-kernel -i https://flute-ai.github.io/whl/cu12.4",wrap:!1}}),{c(){d(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,m){h(e,l,m),i=!0},p:O,i(l){i||(g(e.$$.fragment,l),i=!0)},o(l){M(e.$$.fragment,l),i=!1},d(l){b(e,l)}}}function yt(w){let e,i,l,m;return e=new mt({props:{id:"install",option:"CUDA 12.1",$$slots:{default:[wt]},$$scope:{ctx:w}}}),l=new mt({props:{id:"install",option:"CUDA 11.8",$$slots:{default:[Tt]},$$scope:{ctx:w}}}),{c(){d(e.$$.fragment),i=r(),d(l.$$.fragment)},l(s){$(e.$$.fragment,s),i=p(s),$(l.$$.fragment,s)},m(s,f){h(e,s,f),o(s,i,f),h(l,s,f),m=!0},p(s,f){const T={};f&2&&(T.$$scope={dirty:f,ctx:s}),e.$set(T);const L={};f&2&&(L.$$scope={dirty:f,ctx:s}),l.$set(L)},i(s){m||(g(e.$$.fragment,s),g(l.$$.fragment,s),m=!0)},o(s){M(e.$$.fragment,s),M(l.$$.fragment,s),m=!1},d(s){s&&n(i),b(e,s),b(l,s)}}}function Jt(w){let e,i='Find models pre-quantized with HIGGS in the official ISTA-DASLab <a href="https://huggingface.co/collections/ISTA-DASLab/higgs-675308e432fd56b7f6dab94e" rel="nofollow">collection</a>.';return{c(){e=u("p"),e.innerHTML=i},l(l){e=c(l,"P",{"data-svelte-h":!0}),C(e)!=="svelte-clixu6"&&(e.innerHTML=i)},m(l,m){o(l,e,m)},p:O,d(l){l&&n(e)}}}function Ct(w){let e,i,l,m,s,f,T,L='<a href="https://huggingface.co/papers/2411.17525" rel="nofollow">HIGGS</a> is a zero-shot quantization algorithm that combines Hadamard preprocessing with MSE-Optimal quantization grids to achieve lower quantization error and state-of-the-art performance.',W,_,K='Runtime support for HIGGS is implemented through the <a href="https://github.com/HanGuo97/flute" rel="nofollow">FLUTE</a> library. Only the 70B and 405B variants of Llama 3 and Llama 3.0, and the 8B and 27B variants of Gemma 2 are currently supported. HIGGS also doesnâ€™t support quantized training and backward passes in general at the moment.',A,G,tt="Run the command below to install FLUTE.",R,y,z,H,et='Create a <a href="/docs/transformers/v4.56.2/en/main_classes/quantization#transformers.HiggsConfig">HiggsConfig</a> with the number of bits to quantize a model to.',B,v,X,J,x,U,q,Z,lt='HIGGS is fully compatible with <a href="https://pytorch.org/tutorials/intermediate/torch_compile_tutorial.html" rel="nofollow">torch.compile</a>.',F,I,Q,k,at="Refer to the table below for a benchmark of forward passes/sec for Llama-3.1-8B-Instruct on a RTX4090.",N,E,nt="<thead><tr><th>Batch Size</th> <th>BF16 (with <code>torch.compile</code>)</th> <th>HIGGS 4bit (without <code>torch.compile</code>)</th> <th>HIGGS 4bit (with <code>torch.compile</code>)</th></tr></thead> <tbody><tr><td>1</td> <td>59</td> <td>41</td> <td>124</td></tr> <tr><td>4</td> <td>57</td> <td>42</td> <td>123</td></tr> <tr><td>16</td> <td>56</td> <td>41</td> <td>120</td></tr></tbody>",V,j,Y,S,P;return s=new pt({props:{title:"HIGGS",local:"higgs",headingTag:"h1"}}),y=new bt({props:{id:"install",options:["CUDA 12.1","CUDA 11.8"],$$slots:{default:[yt]},$$scope:{ctx:w}}}),v=new D({props:{code:"ZnJvbSUyMHRyYW5zZm9ybWVycyUyMGltcG9ydCUyMEF1dG9Nb2RlbEZvckNhdXNhbExNJTJDJTIwQXV0b1Rva2VuaXplciUyQyUyMEhpZ2dzQ29uZmlnJTBBJTBBbW9kZWwlMjAlM0QlMjBBdXRvTW9kZWxGb3JDYXVzYWxMTS5mcm9tX3ByZXRyYWluZWQoJTBBJTIwJTIwJTIwJTIwJTIyZ29vZ2xlJTJGZ2VtbWEtMi05Yi1pdCUyMiUyQyUwQSUyMCUyMCUyMCUyMHF1YW50aXphdGlvbl9jb25maWclM0RIaWdnc0NvbmZpZyhiaXRzJTNENCklMkMlMEElMjAlMjAlMjAlMjBkZXZpY2VfbWFwJTNEJTIyYXV0byUyMiUyQyUwQSk=",highlighted:`<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer, HiggsConfig

model = AutoModelForCausalLM.from_pretrained(
    <span class="hljs-string">&quot;google/gemma-2-9b-it&quot;</span>,
    quantization_config=HiggsConfig(bits=<span class="hljs-number">4</span>),
    device_map=<span class="hljs-string">&quot;auto&quot;</span>,
)`,wrap:!1}}),J=new gt({props:{warning:!1,$$slots:{default:[Jt]},$$scope:{ctx:w}}}),U=new pt({props:{title:"torch.compile",local:"torchcompile",headingTag:"h2"}}),I=new D({props:{code:"aW1wb3J0JTIwdG9yY2glMEFmcm9tJTIwdHJhbnNmb3JtZXJzJTIwaW1wb3J0JTIwQXV0b01vZGVsRm9yQ2F1c2FsTE0lMkMlMjBBdXRvVG9rZW5pemVyJTJDJTIwSGlnZ3NDb25maWclMEElMEFtb2RlbCUyMCUzRCUyMEF1dG9Nb2RlbEZvckNhdXNhbExNLmZyb21fcHJldHJhaW5lZCglMEElMjAlMjAlMjAlMjAlMjJnb29nbGUlMkZnZW1tYS0yLTliLWl0JTIyJTJDJTBBJTIwJTIwJTIwJTIwcXVhbnRpemF0aW9uX2NvbmZpZyUzREhpZ2dzQ29uZmlnKGJpdHMlM0Q0KSUyQyUwQSUyMCUyMCUyMCUyMGRldmljZV9tYXAlM0QlMjJhdXRvJTIyJTJDJTBBKSUwQSUwQW1vZGVsJTIwJTNEJTIwdG9yY2guY29tcGlsZShtb2RlbCk=",highlighted:`<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer, HiggsConfig

model = AutoModelForCausalLM.from_pretrained(
    <span class="hljs-string">&quot;google/gemma-2-9b-it&quot;</span>,
    quantization_config=HiggsConfig(bits=<span class="hljs-number">4</span>),
    device_map=<span class="hljs-string">&quot;auto&quot;</span>,
)

model = torch.<span class="hljs-built_in">compile</span>(model)`,wrap:!1}}),j=new Mt({props:{source:"https://github.com/huggingface/transformers/blob/main/docs/source/en/quantization/higgs.md"}}),{c(){e=u("meta"),i=r(),l=u("p"),m=r(),d(s.$$.fragment),f=r(),T=u("p"),T.innerHTML=L,W=r(),_=u("p"),_.innerHTML=K,A=r(),G=u("p"),G.textContent=tt,R=r(),d(y.$$.fragment),z=r(),H=u("p"),H.innerHTML=et,B=r(),d(v.$$.fragment),X=r(),d(J.$$.fragment),x=r(),d(U.$$.fragment),q=r(),Z=u("p"),Z.innerHTML=lt,F=r(),d(I.$$.fragment),Q=r(),k=u("p"),k.textContent=at,N=r(),E=u("table"),E.innerHTML=nt,V=r(),d(j.$$.fragment),Y=r(),S=u("p"),this.h()},l(t){const a=$t("svelte-u9bgzb",document.head);e=c(a,"META",{name:!0,content:!0}),a.forEach(n),i=p(t),l=c(t,"P",{}),it(l).forEach(n),m=p(t),$(s.$$.fragment,t),f=p(t),T=c(t,"P",{"data-svelte-h":!0}),C(T)!=="svelte-1sfhvfa"&&(T.innerHTML=L),W=p(t),_=c(t,"P",{"data-svelte-h":!0}),C(_)!=="svelte-3s1oxe"&&(_.innerHTML=K),A=p(t),G=c(t,"P",{"data-svelte-h":!0}),C(G)!=="svelte-16kfr80"&&(G.textContent=tt),R=p(t),$(y.$$.fragment,t),z=p(t),H=c(t,"P",{"data-svelte-h":!0}),C(H)!=="svelte-1ktq08p"&&(H.innerHTML=et),B=p(t),$(v.$$.fragment,t),X=p(t),$(J.$$.fragment,t),x=p(t),$(U.$$.fragment,t),q=p(t),Z=c(t,"P",{"data-svelte-h":!0}),C(Z)!=="svelte-1l186xf"&&(Z.innerHTML=lt),F=p(t),$(I.$$.fragment,t),Q=p(t),k=c(t,"P",{"data-svelte-h":!0}),C(k)!=="svelte-mag783"&&(k.textContent=at),N=p(t),E=c(t,"TABLE",{"data-svelte-h":!0}),C(E)!=="svelte-13cjrw6"&&(E.innerHTML=nt),V=p(t),$(j.$$.fragment,t),Y=p(t),S=c(t,"P",{}),it(S).forEach(n),this.h()},h(){rt(e,"name","hf:doc:metadata"),rt(e,"content",_t)},m(t,a){ht(document.head,e),o(t,i,a),o(t,l,a),o(t,m,a),h(s,t,a),o(t,f,a),o(t,T,a),o(t,W,a),o(t,_,a),o(t,A,a),o(t,G,a),o(t,R,a),h(y,t,a),o(t,z,a),o(t,H,a),o(t,B,a),h(v,t,a),o(t,X,a),h(J,t,a),o(t,x,a),h(U,t,a),o(t,q,a),o(t,Z,a),o(t,F,a),h(I,t,a),o(t,Q,a),o(t,k,a),o(t,N,a),o(t,E,a),o(t,V,a),h(j,t,a),o(t,Y,a),o(t,S,a),P=!0},p(t,[a]){const st={};a&2&&(st.$$scope={dirty:a,ctx:t}),y.$set(st);const ot={};a&2&&(ot.$$scope={dirty:a,ctx:t}),J.$set(ot)},i(t){P||(g(s.$$.fragment,t),g(y.$$.fragment,t),g(v.$$.fragment,t),g(J.$$.fragment,t),g(U.$$.fragment,t),g(I.$$.fragment,t),g(j.$$.fragment,t),P=!0)},o(t){M(s.$$.fragment,t),M(y.$$.fragment,t),M(v.$$.fragment,t),M(J.$$.fragment,t),M(U.$$.fragment,t),M(I.$$.fragment,t),M(j.$$.fragment,t),P=!1},d(t){t&&(n(i),n(l),n(m),n(f),n(T),n(W),n(_),n(A),n(G),n(R),n(z),n(H),n(B),n(X),n(x),n(q),n(Z),n(F),n(Q),n(k),n(N),n(E),n(V),n(Y),n(S)),n(e),b(s,t),b(y,t),b(v,t),b(J,t),b(U,t),b(I,t),b(j,t)}}}const _t='{"title":"HIGGS","local":"higgs","sections":[{"title":"torch.compile","local":"torchcompile","sections":[],"depth":2}],"depth":1}';function Gt(w){return ut(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class Et extends ct{constructor(e){super(),dt(this,e,Gt,Ct,ft,{})}}export{Et as component};
