import{s as ue,o as ce,n as we}from"../chunks/scheduler.18a86fab.js";import{S as Me,i as he,g as M,s as f,r as T,A as de,h,f as t,c as w,j as pe,u as C,x as y,k as me,y as Ue,a as i,v as g,d as I,t as P,w as J}from"../chunks/index.98837b22.js";import{C as te}from"../chunks/CodeBlock.8d0c2e8a.js";import{H as ee,E as $e}from"../chunks/getInferenceSnippets.06c2775f.js";import{H as ye,a as fe}from"../chunks/HfOption.6641485e.js";function Te(v){let l,d='<a href="https://www.nvidia.com/en-us/design-visualization/nvlink-bridges/" rel="nofollow">NVLink</a> is a high-speed communication system designed by NVIDIA for connecting multiple NVIDIA GPUs. Training <a href="https://huggingface.co/openai-community/gpt2" rel="nofollow">openai-community/gpt2</a> on a small sample of the <a href="https://huggingface.co/datasets/Salesforce/wikitext" rel="nofollow">wikitext</a> dataset is ~23% faster with NVLink.',m,p,o="On a machine with two GPUs connected with NVLink, an example output of <code>nvidia-smi topo -m</code> is shown below.",r,u,U,a,c="<code>NV2</code> indicates <code>GPU0</code> and <code>GPU1</code> are connected by 2 NVLinks.",A;return u=new te({props:{code:"JTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwR1BVMCUyMCUyMCUyMCUyMEdQVTElMjAlMjAlMjAlMjBDUFUlMjBBZmZpbml0eSUyMCUyMCUyMCUyME5VTUElMjBBZmZpbml0eSUwQUdQVTAlMjAlMjAlMjAlMjAlMjBYJTIwJTIwJTIwJTIwJTIwJTIwTlYyJTIwJTIwJTIwJTIwJTIwMC0yMyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyME4lMkZBJTBBR1BVMSUyMCUyMCUyMCUyME5WMiUyMCUyMCUyMCUyMCUyMCUyMFglMjAlMjAlMjAlMjAlMjAlMjAwLTIzJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwTiUyRkE=",highlighted:`        GPU0    GPU1    CPU Affinity    NUMA Affinity
GPU0     X      NV2     0-23            N/A
GPU1    NV2      X      0-23            N/A`,wrap:!1}}),{c(){l=M("p"),l.innerHTML=d,m=f(),p=M("p"),p.innerHTML=o,r=f(),T(u.$$.fragment),U=f(),a=M("p"),a.innerHTML=c},l(s){l=h(s,"P",{"data-svelte-h":!0}),y(l)!=="svelte-1dcwdg9"&&(l.innerHTML=d),m=w(s),p=h(s,"P",{"data-svelte-h":!0}),y(p)!=="svelte-2sy7d0"&&(p.innerHTML=o),r=w(s),C(u.$$.fragment,s),U=w(s),a=h(s,"P",{"data-svelte-h":!0}),y(a)!=="svelte-pz42vg"&&(a.innerHTML=c)},m(s,$){i(s,l,$),i(s,m,$),i(s,p,$),i(s,r,$),g(u,s,$),i(s,U,$),i(s,a,$),A=!0},p:we,i(s){A||(I(u.$$.fragment,s),A=!0)},o(s){P(u.$$.fragment,s),A=!1},d(s){s&&(t(l),t(m),t(p),t(r),t(U),t(a)),J(u,s)}}}function Ce(v){let l,d="On a machine with two GPUs connected with a PCIe bridge, an example output of <code>nvidia-smi topo -m</code> is shown below.",m,p,o,r,u="<code>PHB</code> indicates <code>GPU0</code> and <code>GPU1</code> are connected by a PCIe bridge.",U;return p=new te({props:{code:"JTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwR1BVMCUyMCUyMCUyMCUyMEdQVTElMjAlMjAlMjAlMjBDUFUlMjBBZmZpbml0eSUyMCUyMCUyMCUyME5VTUElMjBBZmZpbml0eSUwQUdQVTAlMjAlMjAlMjAlMjAlMjBYJTIwJTIwJTIwJTIwJTIwJTIwUEhCJTIwJTIwJTIwJTIwJTIwMC0xMSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyME4lMkZBJTBBR1BVMSUyMCUyMCUyMCUyMFBIQiUyMCUyMCUyMCUyMCUyMCUyMFglMjAlMjAlMjAlMjAlMjAlMjAwLTExJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwTiUyRkE=",highlighted:`        GPU0    GPU1    CPU Affinity    NUMA Affinity
GPU0     X      PHB     0-11            N/A
GPU1    PHB      X      0-11            N/A`,wrap:!1}}),{c(){l=M("p"),l.innerHTML=d,m=f(),T(p.$$.fragment),o=f(),r=M("p"),r.innerHTML=u},l(a){l=h(a,"P",{"data-svelte-h":!0}),y(l)!=="svelte-1nomuh5"&&(l.innerHTML=d),m=w(a),C(p.$$.fragment,a),o=w(a),r=h(a,"P",{"data-svelte-h":!0}),y(r)!=="svelte-f97jqo"&&(r.innerHTML=u)},m(a,c){i(a,l,c),i(a,m,c),g(p,a,c),i(a,o,c),i(a,r,c),U=!0},p:we,i(a){U||(I(p.$$.fragment,a),U=!0)},o(a){P(p.$$.fragment,a),U=!1},d(a){a&&(t(l),t(m),t(o),t(r)),J(p,a)}}}function ge(v){let l,d,m,p;return l=new fe({props:{id:"nvlink",option:"NVLink",$$slots:{default:[Te]},$$scope:{ctx:v}}}),m=new fe({props:{id:"nvlink",option:"without NVLink",$$slots:{default:[Ce]},$$scope:{ctx:v}}}),{c(){T(l.$$.fragment),d=f(),T(m.$$.fragment)},l(o){C(l.$$.fragment,o),d=w(o),C(m.$$.fragment,o)},m(o,r){g(l,o,r),i(o,d,r),g(m,o,r),p=!0},p(o,r){const u={};r&2&&(u.$$scope={dirty:r,ctx:o}),l.$set(u);const U={};r&2&&(U.$$scope={dirty:r,ctx:o}),m.$set(U)},i(o){p||(I(l.$$.fragment,o),I(m.$$.fragment,o),p=!0)},o(o){P(l.$$.fragment,o),P(m.$$.fragment,o),p=!1},d(o){o&&t(d),J(l,o),J(m,o)}}}function Ie(v){let l,d,m,p,o,r,u,U="One of the most important considerations when building a machine for deep learning is the GPU choice. GPUs are the standard workhorse for deep learning owing to their tensor cores for performing very efficient matrix multiplication and high memory bandwidth. To train large models, you either need a more powerful GPU, multiple GPUs, or take advantage of techniques that offload some of the load to the CPU or NVMe.",a,c,A='This guide provides some practical tips for setting up a GPU for deep learning. For a more detailed discussion and comparison of GPUs, take a look at the <a href="https://timdettmers.com/2023/01/30/which-gpu-for-deep-learning/" rel="nofollow">Which GPU(s) to Get for Deep Learning</a> blog post.',s,$,S,_,ne="High-end consumer GPUs may have two or three PCIe 8-pin power sockets, and you should make sure you have the same number of 12V PCIe 8-pin cables connected to each socket. Don’t use a <em>pigtail cable</em>, a single cable with two splits at one end, to connect two sockets or else you won’t get full performance from your GPU.",Z,j,ie="Each PCIe 8-pin power cable should be connected to a 12V rail on the power supply unit (PSU) and can deliver up to 150W. Other GPUs may use a PCIe 12-pin connector which can deliver up to 500-600W. Lower-end GPUs may only use a PCIe 6-pin connector which supplies up to 75W.",R,G,oe="It is important that the PSU maintains stable voltage; otherwise, it may fail to supply the GPU with enough power during peak usage.",D,k,F,x,le="An overheated GPU throttles its performance and can even shutdown if it’s too hot to prevent damage. Keeping the GPU temperature low, anywhere between 158–167°F, is essential for delivering full performance and maintaining its lifespan. Once temperatures reach 183 - 194°F, the GPU may begin to throttle performance.",O,L,Q,B,ae='When your setup uses multiple GPUs, it is important to consider how they’re connected. <a href="https://www.nvidia.com/en-us/design-visualization/nvlink-bridges/" rel="nofollow">NVLink</a> connections are faster than PCIe bridges, but you should also consider the <a href="./perf_train_gpu_many">parallelism</a> strategy you’re using. For example, in DistributedDataParallel, GPUs communicate less frequently compared to ZeRO-DP. In this case, a slower connection is not as important.',W,V,se="Run the command below to check how your GPUs are connected.",q,H,z,b,X,E,Y,N,K;return o=new ee({props:{title:"Build your own machine",local:"build-your-own-machine",headingTag:"h1"}}),$=new ee({props:{title:"Power",local:"power",headingTag:"h2"}}),k=new ee({props:{title:"Cooling",local:"cooling",headingTag:"h2"}}),L=new ee({props:{title:"Multi-GPU connectivity",local:"multi-gpu-connectivity",headingTag:"h2"}}),H=new te({props:{code:"bnZpZGlhLXNtaSUyMHRvcG8lMjAtbQ==",highlighted:"nvidia-smi topo -m",wrap:!1}}),b=new ye({props:{id:"nvlink",options:["NVLink","without NVLink"],$$slots:{default:[ge]},$$scope:{ctx:v}}}),E=new $e({props:{source:"https://github.com/huggingface/transformers/blob/main/docs/source/en/perf_hardware.md"}}),{c(){l=M("meta"),d=f(),m=M("p"),p=f(),T(o.$$.fragment),r=f(),u=M("p"),u.textContent=U,a=f(),c=M("p"),c.innerHTML=A,s=f(),T($.$$.fragment),S=f(),_=M("p"),_.innerHTML=ne,Z=f(),j=M("p"),j.textContent=ie,R=f(),G=M("p"),G.textContent=oe,D=f(),T(k.$$.fragment),F=f(),x=M("p"),x.textContent=le,O=f(),T(L.$$.fragment),Q=f(),B=M("p"),B.innerHTML=ae,W=f(),V=M("p"),V.textContent=se,q=f(),T(H.$$.fragment),z=f(),T(b.$$.fragment),X=f(),T(E.$$.fragment),Y=f(),N=M("p"),this.h()},l(e){const n=de("svelte-u9bgzb",document.head);l=h(n,"META",{name:!0,content:!0}),n.forEach(t),d=w(e),m=h(e,"P",{}),pe(m).forEach(t),p=w(e),C(o.$$.fragment,e),r=w(e),u=h(e,"P",{"data-svelte-h":!0}),y(u)!=="svelte-1s8dmoh"&&(u.textContent=U),a=w(e),c=h(e,"P",{"data-svelte-h":!0}),y(c)!=="svelte-15osi2d"&&(c.innerHTML=A),s=w(e),C($.$$.fragment,e),S=w(e),_=h(e,"P",{"data-svelte-h":!0}),y(_)!=="svelte-1lfwb2r"&&(_.innerHTML=ne),Z=w(e),j=h(e,"P",{"data-svelte-h":!0}),y(j)!=="svelte-1oq9hng"&&(j.textContent=ie),R=w(e),G=h(e,"P",{"data-svelte-h":!0}),y(G)!=="svelte-c7jlcs"&&(G.textContent=oe),D=w(e),C(k.$$.fragment,e),F=w(e),x=h(e,"P",{"data-svelte-h":!0}),y(x)!=="svelte-58hjty"&&(x.textContent=le),O=w(e),C(L.$$.fragment,e),Q=w(e),B=h(e,"P",{"data-svelte-h":!0}),y(B)!=="svelte-1ggo6vh"&&(B.innerHTML=ae),W=w(e),V=h(e,"P",{"data-svelte-h":!0}),y(V)!=="svelte-1htw4vw"&&(V.textContent=se),q=w(e),C(H.$$.fragment,e),z=w(e),C(b.$$.fragment,e),X=w(e),C(E.$$.fragment,e),Y=w(e),N=h(e,"P",{}),pe(N).forEach(t),this.h()},h(){me(l,"name","hf:doc:metadata"),me(l,"content",Pe)},m(e,n){Ue(document.head,l),i(e,d,n),i(e,m,n),i(e,p,n),g(o,e,n),i(e,r,n),i(e,u,n),i(e,a,n),i(e,c,n),i(e,s,n),g($,e,n),i(e,S,n),i(e,_,n),i(e,Z,n),i(e,j,n),i(e,R,n),i(e,G,n),i(e,D,n),g(k,e,n),i(e,F,n),i(e,x,n),i(e,O,n),g(L,e,n),i(e,Q,n),i(e,B,n),i(e,W,n),i(e,V,n),i(e,q,n),g(H,e,n),i(e,z,n),g(b,e,n),i(e,X,n),g(E,e,n),i(e,Y,n),i(e,N,n),K=!0},p(e,[n]){const re={};n&2&&(re.$$scope={dirty:n,ctx:e}),b.$set(re)},i(e){K||(I(o.$$.fragment,e),I($.$$.fragment,e),I(k.$$.fragment,e),I(L.$$.fragment,e),I(H.$$.fragment,e),I(b.$$.fragment,e),I(E.$$.fragment,e),K=!0)},o(e){P(o.$$.fragment,e),P($.$$.fragment,e),P(k.$$.fragment,e),P(L.$$.fragment,e),P(H.$$.fragment,e),P(b.$$.fragment,e),P(E.$$.fragment,e),K=!1},d(e){e&&(t(d),t(m),t(p),t(r),t(u),t(a),t(c),t(s),t(S),t(_),t(Z),t(j),t(R),t(G),t(D),t(F),t(x),t(O),t(Q),t(B),t(W),t(V),t(q),t(z),t(X),t(Y),t(N)),t(l),J(o,e),J($,e),J(k,e),J(L,e),J(H,e),J(b,e),J(E,e)}}}const Pe='{"title":"Build your own machine","local":"build-your-own-machine","sections":[{"title":"Power","local":"power","sections":[],"depth":2},{"title":"Cooling","local":"cooling","sections":[],"depth":2},{"title":"Multi-GPU connectivity","local":"multi-gpu-connectivity","sections":[],"depth":2}],"depth":1}';function Je(v){return ce(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class Ge extends Me{constructor(l){super(),he(this,l,Je,Ie,ue,{})}}export{Ge as component};
