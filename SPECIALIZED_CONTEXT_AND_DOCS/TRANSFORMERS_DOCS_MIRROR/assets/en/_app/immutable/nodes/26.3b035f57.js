import{s as Je,o as $e,n as ve}from"../chunks/scheduler.18a86fab.js";import{S as Ue,i as We,g as o,s,r as u,A as _e,h as m,f as n,c as l,j as we,u as f,x as p,k as le,y as je,a,v as d,d as g,t as h,w as M}from"../chunks/index.98837b22.js";import{T as ke}from"../chunks/Tip.77304350.js";import{C as ie}from"../chunks/CodeBlock.8d0c2e8a.js";import{H as oe,E as Ze}from"../chunks/getInferenceSnippets.06c2775f.js";function Ce(B){let r,c='Learn more about streaming in the <a href="https://huggingface.co/docs/text-generation-inference/en/conceptual/streaming" rel="nofollow">Text Generation Inference</a> docs.';return{c(){r=o("p"),r.innerHTML=c},l(i){r=m(i,"P",{"data-svelte-h":!0}),p(r)!=="svelte-16cvhv6"&&(r.innerHTML=c)},m(i,y){a(i,r,y)},p:ve,d(i){i&&n(r)}}}function xe(B){let r,c='The <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkDetector">WatermarkDetector</a> class detects the proportion of green tokens in generated text, which is why it is recommended to strip the prompt text, if it is much longer than the generated text. Padding can also have an effect on <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkDetector">WatermarkDetector</a>.';return{c(){r=o("p"),r.innerHTML=c},l(i){r=m(i,"P",{"data-svelte-h":!0}),p(r)!=="svelte-16cejw2"&&(r.innerHTML=c)},m(i,y){a(i,r,y)},p:ve,d(i){i&&n(r)}}}function Re(B){let r,c,i,y,k,Q,v,me='The <a href="/docs/transformers/v4.56.2/en/main_classes/text_generation#transformers.GenerationMixin.generate">generate()</a> API supports a couple features for building applications on top of it.',F,J,pe="This guide will show you how to use these features.",z,$,S,U,ce="Streaming starts returning text as soon as it is generated so you don’t have to wait to see the entire generated response all at once. It is important in user-facing applications because it reduces perceived latency and allows users to see the generation progression.",N,T,ue='<img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/tgi/streaming-generation-visual-dark_360.gif"/>',q,b,E,W,fe='Create an instance of <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer">TextStreamer</a> with the tokenizer. Pass <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer">TextStreamer</a> to the <code>streamer</code> parameter in <a href="/docs/transformers/v4.56.2/en/main_classes/text_generation#transformers.GenerationMixin.generate">generate()</a> to stream the output one word at a time.',Y,_,L,j,de='The <code>streamer</code> parameter is compatible with any class with a <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer.put">put()</a> and <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer.end">end()</a> method. <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer.put">put()</a> pushes new tokens and <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.TextStreamer.end">end()</a> flags the end of generation. You can create your own streamer class as long as they include these two methods, or you can use Transformers’ basic streamer classes.',D,Z,P,C,ge='Watermarking is useful for detecting whether text is generated. The <a href="https://hf.co/papers/2306.04634" rel="nofollow">watermarking strategy</a> in Transformers randomly “colors” a subset of the tokens green. When green tokens are generated, they have a small bias added to their logits, and a higher probability of being generated. You can detect generated text by comparing the proportion of green tokens to the amount of green tokens typically found in human-generated text.',A,x,he="Watermarking is supported for any generative model in Transformers and doesn’t require an extra classification model to detect the watermarked text.",K,R,Me='Create a <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkingConfig">WatermarkingConfig</a> with the bias value to add to the logits and watermarking algorithm. The example below uses the <code>&quot;selfhash&quot;</code> algorithm, where the green token selection only depends on the current token. Pass the <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkingConfig">WatermarkingConfig</a> to <a href="/docs/transformers/v4.56.2/en/main_classes/text_generation#transformers.GenerationMixin.generate">generate()</a>.',O,w,ee,X,te,I,ye='Create an instance of <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkDetector">WatermarkDetector</a> and pass the model output to it to detect whether the text is machine-generated. The <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkDetector">WatermarkDetector</a> must have the same <a href="/docs/transformers/v4.56.2/en/internal/generation_utils#transformers.WatermarkingConfig">WatermarkingConfig</a> used during generation.',ne,G,ae,V,re,H,se;return k=new oe({props:{title:"Generation features",local:"generation-features",headingTag:"h1"}}),$=new oe({props:{title:"Streaming",local:"streaming",headingTag:"h2"}}),b=new ke({props:{warning:!1,$$slots:{default:[Ce]},$$scope:{ctx:B}}}),_=new ie({props:{code:"ZnJvbSUyMHRyYW5zZm9ybWVycyUyMGltcG9ydCUyMEF1dG9Nb2RlbEZvckNhdXNhbExNJTJDJTIwQXV0b1Rva2VuaXplciUyQyUyMFRleHRTdHJlYW1lciUwQSUwQXRva2VuaXplciUyMCUzRCUyMEF1dG9Ub2tlbml6ZXIuZnJvbV9wcmV0cmFpbmVkKCUyMm9wZW5haS1jb21tdW5pdHklMkZncHQyJTIyKSUwQW1vZGVsJTIwJTNEJTIwQXV0b01vZGVsRm9yQ2F1c2FsTE0uZnJvbV9wcmV0cmFpbmVkKCUyMm9wZW5haS1jb21tdW5pdHklMkZncHQyJTIyKSUwQWlucHV0cyUyMCUzRCUyMHRva2VuaXplciglNUIlMjJUaGUlMjBzZWNyZXQlMjB0byUyMGJha2luZyUyMGElMjBnb29kJTIwY2FrZSUyMGlzJTIwJTIyJTVEJTJDJTIwcmV0dXJuX3RlbnNvcnMlM0QlMjJwdCUyMiklMEFzdHJlYW1lciUyMCUzRCUyMFRleHRTdHJlYW1lcih0b2tlbml6ZXIpJTBBJTBBXyUyMCUzRCUyMG1vZGVsLmdlbmVyYXRlKCoqaW5wdXRzJTJDJTIwc3RyZWFtZXIlM0RzdHJlYW1lciUyQyUyMG1heF9uZXdfdG9rZW5zJTNEMjAp",highlighted:`<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer, TextStreamer

tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;openai-community/gpt2&quot;</span>)
model = AutoModelForCausalLM.from_pretrained(<span class="hljs-string">&quot;openai-community/gpt2&quot;</span>)
inputs = tokenizer([<span class="hljs-string">&quot;The secret to baking a good cake is &quot;</span>], return_tensors=<span class="hljs-string">&quot;pt&quot;</span>)
streamer = TextStreamer(tokenizer)

_ = model.generate(**inputs, streamer=streamer, max_new_tokens=<span class="hljs-number">20</span>)`,wrap:!1}}),Z=new oe({props:{title:"Watermarking",local:"watermarking",headingTag:"h2"}}),w=new ke({props:{warning:!1,$$slots:{default:[xe]},$$scope:{ctx:B}}}),X=new ie({props:{code:"ZnJvbSUyMHRyYW5zZm9ybWVycyUyMGltcG9ydCUyMEF1dG9Ub2tlbml6ZXIlMkMlMjBBdXRvTW9kZWxGb3JDYXVzYWxMTSUyQyUyMFdhdGVybWFya0RldGVjdG9yJTJDJTIwV2F0ZXJtYXJraW5nQ29uZmlnJTBBJTBBbW9kZWwlMjAlM0QlMjBBdXRvTW9kZWxGb3JDYXVzYWxMTS5mcm9tX3ByZXRyYWluZWQoJTIyb3BlbmFpLWNvbW11bml0eSUyRmdwdDIlMjIpJTBBdG9rZW5pemVyJTIwJTNEJTIwQXV0b1Rva2VuaXplci5mcm9tX3ByZXRyYWluZWQoJTIyb3BlbmFpLWNvbW11bml0eSUyRmdwdDIlMjIpJTBBdG9rZW5pemVyLnBhZF90b2tlbl9pZCUyMCUzRCUyMHRva2VuaXplci5lb3NfdG9rZW5faWQlMEF0b2tlbml6ZXIucGFkZGluZ19zaWRlJTIwJTNEJTIwJTIybGVmdCUyMiUwQSUwQWlucHV0cyUyMCUzRCUyMHRva2VuaXplciglNUIlMjJUaGlzJTIwaXMlMjB0aGUlMjBiZWdpbm5pbmclMjBvZiUyMGElMjBsb25nJTIwc3RvcnklMjIlMkMlMjAlMjJBbGljZSUyMGFuZCUyMEJvYiUyMGFyZSUyMiU1RCUyQyUyMHBhZGRpbmclM0RUcnVlJTJDJTIwcmV0dXJuX3RlbnNvcnMlM0QlMjJwdCUyMiklMEFpbnB1dF9sZW4lMjAlM0QlMjBpbnB1dHMlNUIlMjJpbnB1dF9pZHMlMjIlNUQuc2hhcGUlNUItMSU1RCUwQSUwQXdhdGVybWFya2luZ19jb25maWclMjAlM0QlMjBXYXRlcm1hcmtpbmdDb25maWcoYmlhcyUzRDIuNSUyQyUyMHNlZWRpbmdfc2NoZW1lJTNEJTIyc2VsZmhhc2glMjIpJTBBb3V0JTIwJTNEJTIwbW9kZWwuZ2VuZXJhdGUoKippbnB1dHMlMkMlMjB3YXRlcm1hcmtpbmdfY29uZmlnJTNEd2F0ZXJtYXJraW5nX2NvbmZpZyUyQyUyMGRvX3NhbXBsZSUzREZhbHNlJTJDJTIwbWF4X2xlbmd0aCUzRDIwKQ==",highlighted:`<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, AutoModelForCausalLM, WatermarkDetector, WatermarkingConfig

model = AutoModelForCausalLM.from_pretrained(<span class="hljs-string">&quot;openai-community/gpt2&quot;</span>)
tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;openai-community/gpt2&quot;</span>)
tokenizer.pad_token_id = tokenizer.eos_token_id
tokenizer.padding_side = <span class="hljs-string">&quot;left&quot;</span>

inputs = tokenizer([<span class="hljs-string">&quot;This is the beginning of a long story&quot;</span>, <span class="hljs-string">&quot;Alice and Bob are&quot;</span>], padding=<span class="hljs-literal">True</span>, return_tensors=<span class="hljs-string">&quot;pt&quot;</span>)
input_len = inputs[<span class="hljs-string">&quot;input_ids&quot;</span>].shape[-<span class="hljs-number">1</span>]

watermarking_config = WatermarkingConfig(bias=<span class="hljs-number">2.5</span>, seeding_scheme=<span class="hljs-string">&quot;selfhash&quot;</span>)
out = model.generate(**inputs, watermarking_config=watermarking_config, do_sample=<span class="hljs-literal">False</span>, max_length=<span class="hljs-number">20</span>)`,wrap:!1}}),G=new ie({props:{code:"ZGV0ZWN0b3IlMjAlM0QlMjBXYXRlcm1hcmtEZXRlY3Rvcihtb2RlbF9jb25maWclM0Rtb2RlbC5jb25maWclMkMlMjBkZXZpY2UlM0QlMjJjcHUlMjIlMkMlMjB3YXRlcm1hcmtpbmdfY29uZmlnJTNEd2F0ZXJtYXJraW5nX2NvbmZpZyklMEFkZXRlY3Rpb25fb3V0JTIwJTNEJTIwZGV0ZWN0b3Iob3V0JTJDJTIwcmV0dXJuX2RpY3QlM0RUcnVlKSUwQWRldGVjdGlvbl9vdXQucHJlZGljdGlvbiUwQWFycmF5KCU1QlRydWUlMkMlMjBUcnVlJTVEKQ==",highlighted:`detector = WatermarkDetector(model_config=model.config, device=<span class="hljs-string">&quot;cpu&quot;</span>, watermarking_config=watermarking_config)
detection_out = detector(out, return_dict=<span class="hljs-literal">True</span>)
detection_out.prediction
array([<span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>])`,wrap:!1}}),V=new Ze({props:{source:"https://github.com/huggingface/transformers/blob/main/docs/source/en/generation_features.md"}}),{c(){r=o("meta"),c=s(),i=o("p"),y=s(),u(k.$$.fragment),Q=s(),v=o("p"),v.innerHTML=me,F=s(),J=o("p"),J.textContent=pe,z=s(),u($.$$.fragment),S=s(),U=o("p"),U.textContent=ce,N=s(),T=o("div"),T.innerHTML=ue,q=s(),u(b.$$.fragment),E=s(),W=o("p"),W.innerHTML=fe,Y=s(),u(_.$$.fragment),L=s(),j=o("p"),j.innerHTML=de,D=s(),u(Z.$$.fragment),P=s(),C=o("p"),C.innerHTML=ge,A=s(),x=o("p"),x.textContent=he,K=s(),R=o("p"),R.innerHTML=Me,O=s(),u(w.$$.fragment),ee=s(),u(X.$$.fragment),te=s(),I=o("p"),I.innerHTML=ye,ne=s(),u(G.$$.fragment),ae=s(),u(V.$$.fragment),re=s(),H=o("p"),this.h()},l(e){const t=_e("svelte-u9bgzb",document.head);r=m(t,"META",{name:!0,content:!0}),t.forEach(n),c=l(e),i=m(e,"P",{}),we(i).forEach(n),y=l(e),f(k.$$.fragment,e),Q=l(e),v=m(e,"P",{"data-svelte-h":!0}),p(v)!=="svelte-kj4tpy"&&(v.innerHTML=me),F=l(e),J=m(e,"P",{"data-svelte-h":!0}),p(J)!=="svelte-fugxhy"&&(J.textContent=pe),z=l(e),f($.$$.fragment,e),S=l(e),U=m(e,"P",{"data-svelte-h":!0}),p(U)!=="svelte-1crgzf8"&&(U.textContent=ce),N=l(e),T=m(e,"DIV",{class:!0,"data-svelte-h":!0}),p(T)!=="svelte-cjtnoe"&&(T.innerHTML=ue),q=l(e),f(b.$$.fragment,e),E=l(e),W=m(e,"P",{"data-svelte-h":!0}),p(W)!=="svelte-t21osv"&&(W.innerHTML=fe),Y=l(e),f(_.$$.fragment,e),L=l(e),j=m(e,"P",{"data-svelte-h":!0}),p(j)!=="svelte-1jaov37"&&(j.innerHTML=de),D=l(e),f(Z.$$.fragment,e),P=l(e),C=m(e,"P",{"data-svelte-h":!0}),p(C)!=="svelte-len99d"&&(C.innerHTML=ge),A=l(e),x=m(e,"P",{"data-svelte-h":!0}),p(x)!=="svelte-aajjni"&&(x.textContent=he),K=l(e),R=m(e,"P",{"data-svelte-h":!0}),p(R)!=="svelte-1wgkjhq"&&(R.innerHTML=Me),O=l(e),f(w.$$.fragment,e),ee=l(e),f(X.$$.fragment,e),te=l(e),I=m(e,"P",{"data-svelte-h":!0}),p(I)!=="svelte-12y4h77"&&(I.innerHTML=ye),ne=l(e),f(G.$$.fragment,e),ae=l(e),f(V.$$.fragment,e),re=l(e),H=m(e,"P",{}),we(H).forEach(n),this.h()},h(){le(r,"name","hf:doc:metadata"),le(r,"content",Xe),le(T,"class","flex justify-center")},m(e,t){je(document.head,r),a(e,c,t),a(e,i,t),a(e,y,t),d(k,e,t),a(e,Q,t),a(e,v,t),a(e,F,t),a(e,J,t),a(e,z,t),d($,e,t),a(e,S,t),a(e,U,t),a(e,N,t),a(e,T,t),a(e,q,t),d(b,e,t),a(e,E,t),a(e,W,t),a(e,Y,t),d(_,e,t),a(e,L,t),a(e,j,t),a(e,D,t),d(Z,e,t),a(e,P,t),a(e,C,t),a(e,A,t),a(e,x,t),a(e,K,t),a(e,R,t),a(e,O,t),d(w,e,t),a(e,ee,t),d(X,e,t),a(e,te,t),a(e,I,t),a(e,ne,t),d(G,e,t),a(e,ae,t),d(V,e,t),a(e,re,t),a(e,H,t),se=!0},p(e,[t]){const Te={};t&2&&(Te.$$scope={dirty:t,ctx:e}),b.$set(Te);const be={};t&2&&(be.$$scope={dirty:t,ctx:e}),w.$set(be)},i(e){se||(g(k.$$.fragment,e),g($.$$.fragment,e),g(b.$$.fragment,e),g(_.$$.fragment,e),g(Z.$$.fragment,e),g(w.$$.fragment,e),g(X.$$.fragment,e),g(G.$$.fragment,e),g(V.$$.fragment,e),se=!0)},o(e){h(k.$$.fragment,e),h($.$$.fragment,e),h(b.$$.fragment,e),h(_.$$.fragment,e),h(Z.$$.fragment,e),h(w.$$.fragment,e),h(X.$$.fragment,e),h(G.$$.fragment,e),h(V.$$.fragment,e),se=!1},d(e){e&&(n(c),n(i),n(y),n(Q),n(v),n(F),n(J),n(z),n(S),n(U),n(N),n(T),n(q),n(E),n(W),n(Y),n(L),n(j),n(D),n(P),n(C),n(A),n(x),n(K),n(R),n(O),n(ee),n(te),n(I),n(ne),n(ae),n(re),n(H)),n(r),M(k,e),M($,e),M(b,e),M(_,e),M(Z,e),M(w,e),M(X,e),M(G,e),M(V,e)}}}const Xe='{"title":"Generation features","local":"generation-features","sections":[{"title":"Streaming","local":"streaming","sections":[],"depth":2},{"title":"Watermarking","local":"watermarking","sections":[],"depth":2}],"depth":1}';function Ie(B){return $e(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class Fe extends Ue{constructor(r){super(),We(this,r,Ie,Re,Je,{})}}export{Fe as component};
