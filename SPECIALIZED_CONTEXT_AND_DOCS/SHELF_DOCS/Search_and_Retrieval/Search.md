# Search

## Search Content For Autosuggestion

> Get up to 5 content items based on characters typed. Looks for content items based on title.\
> \
> Permissions: users will be able to search only across collections they have access to.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/autosuggest":{"post":{"operationId":"searchContentForAutosuggestion","summary":"Search Content For Autosuggestion","description":"Get up to 5 content items based on characters typed. Looks for content items based on title.\n\nPermissions: users will be able to search only across collections they have access to.\n","requestBody":{"content":{"application/json":{"schema":{"allOf":[{"type":"object","properties":{"fieldsFilters":{"type":"object","properties":{"type":{"type":"array","items":{"type":"string"}},"contentTypeId":{"type":"array","items":{"type":"string"}},"ownerId":{"type":"array","items":{"type":"string"}},"ratingMoreThan":{"type":"array","maxItems":1,"minItems":1,"items":{"type":"number","maximum":4,"minimum":0}},"shelf_categoryId":{"type":"array","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryIdToExclude":{"type":"array","description":"Filter content by ids of categories it does not belong to.","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryOp":{"type":"string","description":"Specifies how to filter content by ids of categories if multiple ids provided. \"and\" - matching content should have all provided category ids. \"or\" - matching content should have any one of provided category ids.","default":"or","enum":["and","or"]},"shelf_reviewStatus":{"type":"array","description":"Filter content by review status. Can be provided only if Content Review feature is enabled.","maxLength":3,"minLength":0,"items":{"type":"string","enum":["up-to-date","out-of-date","none"]}},"source":{"type":"array","items":{"type":"string"}}}}}},{"type":"object","properties":{"collectionIds":{"type":"array","description":"Filter content by ids of collections it belongs to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"collectionIdsToExclude":{"type":"array","description":"Filter content by ids of collections it does not belong to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"connectorIds":{"type":"array","description":"Filter content by ids of connectors it was synchronized with.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"createdAfter":{"type":"string","description":"Filter content that was created starting from the given date. Creation date from source system is used.","format":"date"},"createdBefore":{"type":"string","description":"Filter content that was created up to the given date. Creation date from source system is used.","format":"date"},"idsToExclude":{"type":"array","description":"Filter out specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"idsToInclude":{"type":"array","description":"Filter specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"includeDeepResults":{"type":"boolean","description":"If specified `parentId` would be also searched through grand parent locations"},"includePrivateContent":{"type":"boolean","description":"If specified private content would be included in search results","default":true},"parentId":{"type":"string","description":"Filter content that is in given location"},"query":{"type":"string","description":"Filters content by searchable text, like `title`, `description`, `text` and `tags` fields."},"queryFields":{"type":"array","description":"Filters content by specific fields by query provided. If not specified, all searchable fields are used.","maxItems":5,"minItems":1,"items":{"oneOf":[{"type":"string","enum":["title"]},{"type":"string","pattern":"^fields\\\\.shelf_customField_.+$"}]}},"searchLanguage":{"type":"string","description":"Filters content by language code. Specify `any` to search across all languages.","maxLength":5,"minLength":2},"tags":{"type":"array","description":"Filters content by tags. Uses `tagsOp` parameter to specify how to treat multiple tags.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"tagsOp":{"type":"string","description":"Specifies how to filter content by tags if multiple tags provided. \"and\" - matching content should have all provided tags. \"or\" - matching content should have any one of provided tags.","default":"or","enum":["and","or"]},"tagsToExclude":{"type":"array","description":"Filter content by tags it does not belong to.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"updatedAfter":{"type":"string","description":"Filter content that was updated after or equal the given date. Update date from source system is used.","format":"date"},"updatedAfterStrict":{"type":"string","description":"Filter content that was updated strictly after the given date. Update date from source system is used.","format":"date"},"updatedBefore":{"type":"string","description":"Filter content that was updated before or equal the given date. Update date from source system is used.","format":"date"},"updatedBeforeStrict":{"type":"string","description":"Filter content that was updated strictly before the given date. Update date from source system is used.","format":"date"}}},{"type":"object","required":["query"],"properties":{"query":{"type":"string","maxLength":256,"minLength":2}}}]}}}},"responses":{"200":{"description":"Content for autosuggestion","content":{"application/json":{"schema":{"type":"object","required":["id","title","titleHighlighted","updatedAt","collectionIds","iconURL","externalURL"],"properties":{"collectionIds":{"type":"array","description":"List of collection IDs this content item belongs to in the source system","items":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1}},"connectorId":{"type":"string","description":"Connector ID which synced this content item to CIL"},"externalId":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"},"externalURL":{"type":"string","description":"URL pointing to the content in the source system"},"iconURL":{"type":"string","description":"Icon URL for this content item.\nFor Shelf KMS content items it's a URL to the icon of the content type.\nFor other content items it's a URL to the connector's icon.\n"},"id":{"type":"string","description":"Content item ID (internal to CIL)"},"ownerUsername":{"type":"string","description":"Username of the owner of this content item in the source system"},"title":{"type":"string","description":"Content item title"},"titleHighlighted":{"type":"string","description":"Content item title with highlighted matching characters"},"updatedAt":{"type":"string","description":"Date when content was last updated in CIL","format":"date"}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```

## Search CIL Content Sections

> \*\*This endpoint is deprecated.\*\* Use \`/cil-search/content/semantic-sections\` instead.\
> \
> Returns search results over CIL content as sections to which items were split.\
> \
> Permissions: users will be able to search only across collections they have access to.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/content/sections":{"post":{"operationId":"searchContentSections","summary":"Search CIL Content Sections","description":"**This endpoint is deprecated.** Use `/cil-search/content/semantic-sections` instead.\n\nReturns search results over CIL content as sections to which items were split.\n\nPermissions: users will be able to search only across collections they have access to.\n","deprecated":true,"requestBody":{"content":{"application/json":{"schema":{"allOf":[{"type":"object","required":["origin"],"properties":{"origin":{"type":"string","description":"System where search request originated from."}}},{"type":"object","properties":{"format":{"description":"Specifies format of `content` field in response. `html` - text with html tags `markdown` - text with markdown tags `text` - plain text","default":"html","enum":["html","markdown","text"]}}},{"type":"object","properties":{"fieldsFilters":{"type":"object","properties":{"type":{"type":"array","items":{"type":"string"}},"contentTypeId":{"type":"array","items":{"type":"string"}},"ownerId":{"type":"array","items":{"type":"string"}},"ratingMoreThan":{"type":"array","maxItems":1,"minItems":1,"items":{"type":"number","maximum":4,"minimum":0}},"shelf_categoryId":{"type":"array","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryIdToExclude":{"type":"array","description":"Filter content by ids of categories it does not belong to.","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryOp":{"type":"string","description":"Specifies how to filter content by ids of categories if multiple ids provided. \"and\" - matching content should have all provided category ids. \"or\" - matching content should have any one of provided category ids.","default":"or","enum":["and","or"]},"shelf_reviewStatus":{"type":"array","description":"Filter content by review status. Can be provided only if Content Review feature is enabled.","maxLength":3,"minLength":0,"items":{"type":"string","enum":["up-to-date","out-of-date","none"]}},"source":{"type":"array","items":{"type":"string"}}}}}},{"type":"object","properties":{"enrichmentsFilters":{"type":"array","description":"Filter content by enrichments. Can be provided only if Content Enrichments feature is enabled.","maxItems":1,"minItems":1,"items":{"type":"object","required":["type"],"properties":{"type":{"type":"string","description":"Filter content by types of enrichments.","enum":["NER"]},"ids":{"type":"array","description":"Filter content by ids of enrichments instance ids.","items":{"type":"string"}},"values":{"type":"array","description":"Filter content by values of enrichments.","items":{"type":"object","required":["key","value"],"properties":{"key":{"type":"string","description":"Key of the enrichment"},"value":{"description":"Value of the enrichment. Can be a string, number, boolean or array of strings.","oneOf":[{"type":"array","items":{"type":"string"}},{"type":"number"},{"type":"string"},{"type":"boolean"}]}}}}}}}}},{"type":"object","properties":{"collectionIds":{"type":"array","description":"Filter content by ids of collections it belongs to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"collectionIdsToExclude":{"type":"array","description":"Filter content by ids of collections it does not belong to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"connectorIds":{"type":"array","description":"Filter content by ids of connectors it was synchronized with.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"createdAfter":{"type":"string","description":"Filter content that was created starting from the given date. Creation date from source system is used.","format":"date"},"createdBefore":{"type":"string","description":"Filter content that was created up to the given date. Creation date from source system is used.","format":"date"},"idsToExclude":{"type":"array","description":"Filter out specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"idsToInclude":{"type":"array","description":"Filter specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"includeDeepResults":{"type":"boolean","description":"If specified `parentId` would be also searched through grand parent locations"},"includePrivateContent":{"type":"boolean","description":"If specified private content would be included in search results","default":true},"parentId":{"type":"string","description":"Filter content that is in given location"},"query":{"type":"string","description":"Filters content by searchable text, like `title`, `description`, `text` and `tags` fields."},"queryFields":{"type":"array","description":"Filters content by specific fields by query provided. If not specified, all searchable fields are used.","maxItems":5,"minItems":1,"items":{"oneOf":[{"type":"string","enum":["title"]},{"type":"string","pattern":"^fields\\\\.shelf_customField_.+$"}]}},"searchLanguage":{"type":"string","description":"Filters content by language code. Specify `any` to search across all languages.","maxLength":5,"minLength":2},"tags":{"type":"array","description":"Filters content by tags. Uses `tagsOp` parameter to specify how to treat multiple tags.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"tagsOp":{"type":"string","description":"Specifies how to filter content by tags if multiple tags provided. \"and\" - matching content should have all provided tags. \"or\" - matching content should have any one of provided tags.","default":"or","enum":["and","or"]},"tagsToExclude":{"type":"array","description":"Filter content by tags it does not belong to.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"updatedAfter":{"type":"string","description":"Filter content that was updated after or equal the given date. Update date from source system is used.","format":"date"},"updatedAfterStrict":{"type":"string","description":"Filter content that was updated strictly after the given date. Update date from source system is used.","format":"date"},"updatedBefore":{"type":"string","description":"Filter content that was updated before or equal the given date. Update date from source system is used.","format":"date"},"updatedBeforeStrict":{"type":"string","description":"Filter content that was updated strictly before the given date. Update date from source system is used.","format":"date"}}},{"type":"object","properties":{"sortBy":{"type":"string","description":"Specify how (by what) to sort search results.","enum":["TITLE","CREATED_DATE","UPDATED_DATE","RELEVANCE","VIEWS","RATING"]},"sortOrder":{"type":"string","description":"Specify either ascending or descnding sort order to apply to `sortBy` parameter.","enum":["ASC","DESC"]}}},{"type":"object","properties":{"from":{"type":"integer","description":"Filters out content by numbered position in the search results, for example if the value is `3`, then the first item of the search will be the 4th one, meaning that the first three were skipped.","maximum":10000,"minimum":0},"nextToken":{"type":"string","description":"Next token should be used to retrieve next portion of the results (next page). Next token from the response of this API can be used correctly ONLY if filters & sorting in new request have not changed comparing to the request where next token was returned. If filters or sorting have changed, use this API without next token, and after retrieving first page with changed filters or sorting next token will be returned by this API and can be used. Use only nextToken returned by this API, do not change it."},"size":{"type":"integer","description":"Using this parameter it's possible to filter out the amount of gems in response.","maximum":1000,"minimum":0}}}]}}}},"responses":{"200":{"description":"Search results","content":{"application/json":{"schema":{"type":"object","required":["items","pageInfo"],"properties":{"pageInfo":{"allOf":[{"type":"object","description":"This object holds information about pagination. Use it to know how to iterate over array of results","properties":{"currentPage":{"type":"number","default":1,"maximum":100,"minimum":1},"hasNextPage":{"type":"boolean"},"hasPreviousPage":{"type":"boolean"},"pageSize":{"type":"number"},"totalPages":{"type":"number","maximum":100,"minimum":1},"totalResultsCount":{"type":"number","maximum":999999,"minimum":0}}},{"type":"object","properties":{"nextToken":{"type":"string"}}}]},"items":{"type":"array","items":{"allOf":[{"allOf":[{"type":"object","required":["fields"],"properties":{"accountId":{"type":"string","description":"ID of account","maxLength":64,"minLength":6},"collectionIds":{"type":"array","description":"List of collection IDs this content item belongs to in external system","items":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1}},"connectorId":{"type":"string","description":"Connector ID which synced this content item to CIL"},"createdAt":{"type":"string","description":"Date when content was first created in CIL","format":"date"},"externalId":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"},"externalURL":{"type":"string","description":"Url pointing to content in source system"},"fields":{"type":"array","items":{"type":"object","required":["key","value","type","label"],"properties":{"type":{"type":"string"},"data":{"type":"object","additionalProperties":true},"key":{"type":"string"},"label":{"type":"string"},"value":{"type":"string"}}}},"iconURL":{"type":"string","description":"Icon url for this content item. Present if this content item corresponds to Shelf KMS gem."},"id":{"type":"string","description":"Content item ID (internal to CIL)"},"internalCollectionIds":{"type":"array","description":"List of internal collection IDs this content item belongs to in CIL","items":{"type":"string","maxLength":26,"minLength":26}},"internalId":{"type":"string","description":"Content item ID (internal to CIL)"},"lang":{"type":"string","description":"Language code of content item"},"lastViewedAt":{"type":"string","description":"Date when content was last viewed at","format":"date"},"locations":{"type":"array","description":"List of locations of this content item belongs to an external system","items":{"type":"object","required":["grandParentIds","collectionId"],"properties":{"collectionId":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1},"grandParentIds":{"type":"array","items":{"type":"string","maxLength":64,"minLength":6}},"parentId":{"type":"string","maxLength":64,"minLength":6}}}},"originalCreatedAt":{"type":"string","description":"Date when content was first created in source system","format":"date"},"originalUpdatedAt":{"type":"string","description":"Date when content was last updated in source system","format":"date"},"tags":{"type":"array","description":"List of tags for this content item","items":{"type":"string"}},"title":{"type":"string","description":"Content item title"},"updatedAt":{"type":"string","description":"Date when content was last updated in CIL","format":"date"}}},{"type":"object","properties":{"description":{"type":"string","description":"Content item description"},"iconURL":{"type":"string","description":"Icon url for this content item. Present if this content item corresponds to Shelf KMS gem."},"jobId":{"type":"string","description":"Job ID that synced this content item to CIL"},"syncFlowId":{"allOf":[{"type":"string","maxLength":26,"minLength":26},{"description":"Sync Flow ID"}]}}},{"type":"object","properties":{"enrichments":{"type":"array","description":"List of enrichments for this content item, list is limited to up to 5 items.","items":{"type":"object","required":["id","type","values"],"properties":{"type":{"type":"string"},"id":{"type":"string"},"values":{"type":"array","items":{"type":"object","required":["key","label","value"],"properties":{"key":{"type":"string"},"label":{"type":"string"},"value":{"oneOf":[{"type":"string"},{"type":"number"},{"type":"boolean"},{"type":"array","items":{"type":"string"}}]}}}}}}},"enrichmentsCount":{"type":"object","description":"Count of enrichments for this content item","properties":{"NER":{"type":"number","description":"Count of NER enrichments for this content item"}}}}}]},{"type":"object","properties":{"type":{"type":"string","description":"Specifies that this is a content section","enum":["content-section"]},"content":{"type":"string","description":"Raw content of this content section"},"text":{"type":"string","description":"Plain text of this content section"}}}]}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```

## Search CIL Semantic Sections

> Returns search results over CIL content as semantic sections to which items were split.\
> \
> Permissions: users will be able to search only across collections they have access to.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/content/semantic-sections":{"post":{"operationId":"searchSemanticSections","summary":"Search CIL Semantic Sections","description":"Returns search results over CIL content as semantic sections to which items were split.\n\nPermissions: users will be able to search only across collections they have access to.\n","requestBody":{"content":{"application/json":{"schema":{"allOf":[{"allOf":[{"type":"object","required":["origin"],"properties":{"origin":{"type":"string","description":"System where search request originated from."}}},{"type":"object","properties":{"format":{"description":"Specifies format of `content` field in response. `html` - text with html tags `markdown` - text with markdown tags `text` - plain text","default":"html","enum":["html","markdown","text"]}}},{"type":"object","properties":{"fieldsFilters":{"type":"object","properties":{"type":{"type":"array","items":{"type":"string"}},"contentTypeId":{"type":"array","items":{"type":"string"}},"ownerId":{"type":"array","items":{"type":"string"}},"ratingMoreThan":{"type":"array","maxItems":1,"minItems":1,"items":{"type":"number","maximum":4,"minimum":0}},"shelf_categoryId":{"type":"array","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryIdToExclude":{"type":"array","description":"Filter content by ids of categories it does not belong to.","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryOp":{"type":"string","description":"Specifies how to filter content by ids of categories if multiple ids provided. \"and\" - matching content should have all provided category ids. \"or\" - matching content should have any one of provided category ids.","default":"or","enum":["and","or"]},"shelf_reviewStatus":{"type":"array","description":"Filter content by review status. Can be provided only if Content Review feature is enabled.","maxLength":3,"minLength":0,"items":{"type":"string","enum":["up-to-date","out-of-date","none"]}},"source":{"type":"array","items":{"type":"string"}}}}}},{"type":"object","properties":{"enrichmentsFilters":{"type":"array","description":"Filter content by enrichments. Can be provided only if Content Enrichments feature is enabled.","maxItems":1,"minItems":1,"items":{"type":"object","required":["type"],"properties":{"type":{"type":"string","description":"Filter content by types of enrichments.","enum":["NER"]},"ids":{"type":"array","description":"Filter content by ids of enrichments instance ids.","items":{"type":"string"}},"values":{"type":"array","description":"Filter content by values of enrichments.","items":{"type":"object","required":["key","value"],"properties":{"key":{"type":"string","description":"Key of the enrichment"},"value":{"description":"Value of the enrichment. Can be a string, number, boolean or array of strings.","oneOf":[{"type":"array","items":{"type":"string"}},{"type":"number"},{"type":"string"},{"type":"boolean"}]}}}}}}}}},{"type":"object","properties":{"collectionIds":{"type":"array","description":"Filter content by ids of collections it belongs to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"collectionIdsToExclude":{"type":"array","description":"Filter content by ids of collections it does not belong to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"connectorIds":{"type":"array","description":"Filter content by ids of connectors it was synchronized with.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"createdAfter":{"type":"string","description":"Filter content that was created starting from the given date. Creation date from source system is used.","format":"date"},"createdBefore":{"type":"string","description":"Filter content that was created up to the given date. Creation date from source system is used.","format":"date"},"idsToExclude":{"type":"array","description":"Filter out specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"idsToInclude":{"type":"array","description":"Filter specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"includeDeepResults":{"type":"boolean","description":"If specified `parentId` would be also searched through grand parent locations"},"includePrivateContent":{"type":"boolean","description":"If specified private content would be included in search results","default":true},"parentId":{"type":"string","description":"Filter content that is in given location"},"query":{"type":"string","description":"Filters content by searchable text, like `title`, `description`, `text` and `tags` fields."},"queryFields":{"type":"array","description":"Filters content by specific fields by query provided. If not specified, all searchable fields are used.","maxItems":5,"minItems":1,"items":{"oneOf":[{"type":"string","enum":["title"]},{"type":"string","pattern":"^fields\\\\.shelf_customField_.+$"}]}},"searchLanguage":{"type":"string","description":"Filters content by language code. Specify `any` to search across all languages.","maxLength":5,"minLength":2},"tags":{"type":"array","description":"Filters content by tags. Uses `tagsOp` parameter to specify how to treat multiple tags.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"tagsOp":{"type":"string","description":"Specifies how to filter content by tags if multiple tags provided. \"and\" - matching content should have all provided tags. \"or\" - matching content should have any one of provided tags.","default":"or","enum":["and","or"]},"tagsToExclude":{"type":"array","description":"Filter content by tags it does not belong to.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"updatedAfter":{"type":"string","description":"Filter content that was updated after or equal the given date. Update date from source system is used.","format":"date"},"updatedAfterStrict":{"type":"string","description":"Filter content that was updated strictly after the given date. Update date from source system is used.","format":"date"},"updatedBefore":{"type":"string","description":"Filter content that was updated before or equal the given date. Update date from source system is used.","format":"date"},"updatedBeforeStrict":{"type":"string","description":"Filter content that was updated strictly before the given date. Update date from source system is used.","format":"date"}}},{"type":"object","properties":{"sortBy":{"type":"string","description":"Specify how (by what) to sort search results.","enum":["TITLE","CREATED_DATE","UPDATED_DATE","RELEVANCE","VIEWS","RATING"]},"sortOrder":{"type":"string","description":"Specify either ascending or descnding sort order to apply to `sortBy` parameter.","enum":["ASC","DESC"]}}},{"type":"object","properties":{"from":{"type":"integer","description":"Filters out content by numbered position in the search results, for example if the value is `3`, then the first item of the search will be the 4th one, meaning that the first three were skipped.","maximum":10000,"minimum":0},"nextToken":{"type":"string","description":"Next token should be used to retrieve next portion of the results (next page). Next token from the response of this API can be used correctly ONLY if filters & sorting in new request have not changed comparing to the request where next token was returned. If filters or sorting have changed, use this API without next token, and after retrieving first page with changed filters or sorting next token will be returned by this API and can be used. Use only nextToken returned by this API, do not change it."},"size":{"type":"integer","description":"Using this parameter it's possible to filter out the amount of gems in response.","maximum":1000,"minimum":0}}}]},{"type":"object","properties":{"ranking":{"type":"object","description":"Optional Re-ranking step configuration to be additionally performed after getting page of search results. Requires OpenAI feature to be enabled.","required":["scoring"],"properties":{"reorder":{"type":"boolean","description":"If true will reorder page of search results based on ranking similarity","default":false},"scoring":{"type":"string","enum":["similarity"]}}}}}]}}}},"responses":{"200":{"description":"Search results","content":{"application/json":{"schema":{"type":"object","required":["sections","pageInfo"],"properties":{"pageInfo":{"allOf":[{"type":"object","description":"This object holds information about pagination. Use it to know how to iterate over array of results","properties":{"currentPage":{"type":"number","default":1,"maximum":100,"minimum":1},"hasNextPage":{"type":"boolean"},"hasPreviousPage":{"type":"boolean"},"pageSize":{"type":"number"},"totalPages":{"type":"number","maximum":100,"minimum":1},"totalResultsCount":{"type":"number","maximum":999999,"minimum":0}}},{"type":"object","properties":{"nextToken":{"type":"string"}}}]},"sections":{"type":"array","items":{"allOf":[{"type":"object","properties":{"id":{"type":"string","description":"Semantic section ID"}}},{"allOf":[{"type":"object","required":["fields"],"properties":{"accountId":{"type":"string","description":"ID of account","maxLength":64,"minLength":6},"collectionIds":{"type":"array","description":"List of collection IDs this content item belongs to in external system","items":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1}},"connectorId":{"type":"string","description":"Connector ID which synced this content item to CIL"},"createdAt":{"type":"string","description":"Date when content was first created in CIL","format":"date"},"externalId":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"},"externalURL":{"type":"string","description":"Url pointing to content in source system"},"fields":{"type":"array","items":{"type":"object","required":["key","value","type","label"],"properties":{"type":{"type":"string"},"data":{"type":"object","additionalProperties":true},"key":{"type":"string"},"label":{"type":"string"},"value":{"type":"string"}}}},"iconURL":{"type":"string","description":"Icon url for this content item. Present if this content item corresponds to Shelf KMS gem."},"id":{"type":"string","description":"Content item ID (internal to CIL)"},"internalCollectionIds":{"type":"array","description":"List of internal collection IDs this content item belongs to in CIL","items":{"type":"string","maxLength":26,"minLength":26}},"internalId":{"type":"string","description":"Content item ID (internal to CIL)"},"lang":{"type":"string","description":"Language code of content item"},"lastViewedAt":{"type":"string","description":"Date when content was last viewed at","format":"date"},"locations":{"type":"array","description":"List of locations of this content item belongs to an external system","items":{"type":"object","required":["grandParentIds","collectionId"],"properties":{"collectionId":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1},"grandParentIds":{"type":"array","items":{"type":"string","maxLength":64,"minLength":6}},"parentId":{"type":"string","maxLength":64,"minLength":6}}}},"originalCreatedAt":{"type":"string","description":"Date when content was first created in source system","format":"date"},"originalUpdatedAt":{"type":"string","description":"Date when content was last updated in source system","format":"date"},"tags":{"type":"array","description":"List of tags for this content item","items":{"type":"string"}},"title":{"type":"string","description":"Content item title"},"updatedAt":{"type":"string","description":"Date when content was last updated in CIL","format":"date"}}},{"type":"object","properties":{"description":{"type":"string","description":"Content item description"},"iconURL":{"type":"string","description":"Icon url for this content item. Present if this content item corresponds to Shelf KMS gem."},"jobId":{"type":"string","description":"Job ID that synced this content item to CIL"},"syncFlowId":{"allOf":[{"type":"string","maxLength":26,"minLength":26},{"description":"Sync Flow ID"}]}}},{"type":"object","properties":{"enrichments":{"type":"array","description":"List of enrichments for this content item, list is limited to up to 5 items.","items":{"type":"object","required":["id","type","values"],"properties":{"type":{"type":"string"},"id":{"type":"string"},"values":{"type":"array","items":{"type":"object","required":["key","label","value"],"properties":{"key":{"type":"string"},"label":{"type":"string"},"value":{"oneOf":[{"type":"string"},{"type":"number"},{"type":"boolean"},{"type":"array","items":{"type":"string"}}]}}}}}}},"enrichmentsCount":{"type":"object","description":"Count of enrichments for this content item","properties":{"NER":{"type":"number","description":"Count of NER enrichments for this content item"}}}}}]},{"type":"object","required":["sectionId"],"properties":{"type":{"type":"string","description":"Specifies that this is a content section","enum":["content-section"]},"content":{"type":"string","description":"Content of this content section in requested format"},"ranking":{"type":"object","description":"Ranking information for this section, present if ranking was requested","required":["similarity"],"properties":{"isAvailable":{"type":"boolean","description":"Equals to false if ranking information is not available for this section"},"similarity":{"type":"number","description":"Similarity score showing how relevant this section is to the search query","maximum":1,"minimum":0}}},"sectionHash":{"type":"string","description":"Fingerprint for the content"},"sectionId":{"type":"string","description":"Semantic section ID"},"sectionLevel":{"type":"integer","description":"Hierarchical level of the section"},"sectionNextId":{"type":"string","description":"ID of the next section"},"sectionOrder":{"type":"integer","description":"The order of the section in the document"},"sectionParentId":{"type":"string","description":"ID of the parent section"},"sectionPreviousId":{"type":"string","description":"ID of the previous section"},"sectionTitle":{"type":"string","description":"The title of the section"},"sectionTitleBreadcrumbs":{"type":"array","description":"List of section titles from parent section titles to title of this section","items":{"type":"string"}},"sectionTitleHTML":{"type":"string","description":"The HTML version of the section title"},"sectionType":{"type":"string","description":"Type of the section","enum":["table","text","image"]}}}]}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```

## Search CIL Facets

> Returns facets (aggregations, summary) of CIL content items.\
> \
> Permissions: users will be able to query only across collections they have access to.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/facets":{"post":{"operationId":"searchFacets","summary":"Search CIL Facets","description":"Returns facets (aggregations, summary) of CIL content items.\n\nPermissions: users will be able to query only across collections they have access to.\n","requestBody":{"content":{"application/json":{"schema":{"allOf":[{"type":"object","anyOf":[{"required":["facets"]},{"required":["fieldsFacets"]},{"required":["enrichmentsFacets"]}],"properties":{"enrichmentsFacets":{"type":"array","description":"Enrichments to return in response.","items":{"type":"string","enum":["NER"]}},"enrichmentsFilters":{"type":"array","description":"Filter content by enrichments. Can be provided only if Content Enrichments feature is enabled.","maxItems":1,"minItems":1,"items":{"type":"object","required":["type"],"properties":{"type":{"type":"string","description":"Filter content by types of enrichments.","enum":["NER"]},"ids":{"type":"array","description":"Filter content by ids of enrichments instance ids.","items":{"type":"string"}},"values":{"type":"array","description":"Filter content by values of enrichments.","items":{"type":"object","required":["key","value"],"properties":{"key":{"type":"string","description":"Key of the enrichment"},"value":{"description":"Value of the enrichment. Can be a string, number, boolean or array of strings.","oneOf":[{"type":"array","items":{"type":"string"}},{"type":"number"},{"type":"string"},{"type":"boolean"}]}}}}}}},"facetQuery":{"type":"string","description":"Query to filter labels in facets. For example, when providing `facetQuery: \"My Library\"`,  only facets with labels containing \"My Library\" will be returned.  This filter will be applied to all returned facets."},"facets":{"type":"array","description":"Facets to return in response, specifying by what dimensions to summarize content.","items":{"type":"string","enum":["collection","tag","lang","connector","mimeType"]}},"fieldsFacets":{"type":"array","description":"CIL custom fields facets to return in response.","items":{"type":"string","enum":["contentTypeId","shelf_categoryId","type","source","ownerId","ratingMoreThan"]}},"fieldsFilters":{"type":"object","properties":{"type":{"type":"array","items":{"type":"string"}},"contentTypeId":{"type":"array","items":{"type":"string"}},"ownerId":{"type":"array","items":{"type":"string"}},"ratingMoreThan":{"type":"array","maxItems":1,"minItems":1,"items":{"type":"number","maximum":4,"minimum":0}},"shelf_categoryId":{"type":"array","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryIdToExclude":{"type":"array","description":"Filter content by ids of categories it does not belong to.","maxItems":20,"minItems":0,"items":{"type":"string"}},"shelf_categoryOp":{"type":"string","description":"Specifies how to filter content by ids of categories if multiple ids provided. \"and\" - matching content should have all provided category ids. \"or\" - matching content should have any one of provided category ids.","default":"or","enum":["and","or"]},"shelf_reviewStatus":{"type":"array","description":"Filter content by review status. Can be provided only if Content Review feature is enabled.","maxLength":3,"minLength":0,"items":{"type":"string","enum":["up-to-date","out-of-date","none"]}},"source":{"type":"array","items":{"type":"string"}}}},"size":{"type":"integer","description":"Number of items to return in each facet.","maximum":10000,"minimum":1}}},{"type":"object","properties":{"collectionIds":{"type":"array","description":"Filter content by ids of collections it belongs to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"collectionIdsToExclude":{"type":"array","description":"Filter content by ids of collections it does not belong to.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"connectorIds":{"type":"array","description":"Filter content by ids of connectors it was synchronized with.","maxItems":50,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"createdAfter":{"type":"string","description":"Filter content that was created starting from the given date. Creation date from source system is used.","format":"date"},"createdBefore":{"type":"string","description":"Filter content that was created up to the given date. Creation date from source system is used.","format":"date"},"idsToExclude":{"type":"array","description":"Filter out specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"idsToInclude":{"type":"array","description":"Filter specific external ids","maxItems":1000,"minItems":0,"items":{"type":"string","maxLength":64,"minLength":6}},"includeDeepResults":{"type":"boolean","description":"If specified `parentId` would be also searched through grand parent locations"},"includePrivateContent":{"type":"boolean","description":"If specified private content would be included in search results","default":true},"parentId":{"type":"string","description":"Filter content that is in given location"},"query":{"type":"string","description":"Filters content by searchable text, like `title`, `description`, `text` and `tags` fields."},"queryFields":{"type":"array","description":"Filters content by specific fields by query provided. If not specified, all searchable fields are used.","maxItems":5,"minItems":1,"items":{"oneOf":[{"type":"string","enum":["title"]},{"type":"string","pattern":"^fields\\\\.shelf_customField_.+$"}]}},"searchLanguage":{"type":"string","description":"Filters content by language code. Specify `any` to search across all languages.","maxLength":5,"minLength":2},"tags":{"type":"array","description":"Filters content by tags. Uses `tagsOp` parameter to specify how to treat multiple tags.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"tagsOp":{"type":"string","description":"Specifies how to filter content by tags if multiple tags provided. \"and\" - matching content should have all provided tags. \"or\" - matching content should have any one of provided tags.","default":"or","enum":["and","or"]},"tagsToExclude":{"type":"array","description":"Filter content by tags it does not belong to.","maxItems":200,"minItems":0,"items":{"type":"string","maxLength":40,"minLength":1}},"updatedAfter":{"type":"string","description":"Filter content that was updated after or equal the given date. Update date from source system is used.","format":"date"},"updatedAfterStrict":{"type":"string","description":"Filter content that was updated strictly after the given date. Update date from source system is used.","format":"date"},"updatedBefore":{"type":"string","description":"Filter content that was updated before or equal the given date. Update date from source system is used.","format":"date"},"updatedBeforeStrict":{"type":"string","description":"Filter content that was updated strictly before the given date. Update date from source system is used.","format":"date"}}}]}}}},"responses":{"200":{"description":"Search results","content":{"application/json":{"schema":{"type":"object","properties":{"results":{"type":"object","properties":{"collection":{"type":"array","description":"Summary of content split by collections","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}},"connector":{"type":"array","description":"Summary of content split by connector that synced that content","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}},"enrichments":{"type":"object","description":"Summary of content split by enrichments","properties":{"NER":{"type":"array","items":{"type":"object","properties":{"count":{"type":"number","description":"Number of entity instances grouped by this entity type"},"data":{"type":"object","description":"Instances of the NER Type","additionalProperties":false,"required":["instances"],"properties":{"instances":{"type":"array","items":{"type":"object","required":["value","label","count"],"properties":{"count":{"type":"number","description":"Number of items for this entity instance"},"label":{"type":"string","description":"Entity instance name"},"value":{"type":"string","description":"Id of entity instance"}}}}}},"label":{"type":"string","description":"Entity type name"},"value":{"type":"string","description":"Id of the NER Type"}}}}}},"fields":{"type":"object","description":"Summary of content split by CIL custom fields","properties":{"contentTypeId":{"type":"array","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}},"shelf_categoryId":{"type":"array","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}}}},"lang":{"type":"array","description":"Summary of content split by language codes","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}},"tag":{"type":"array","description":"Summary of content split by tags","items":{"type":"object","required":["value","count"],"properties":{"count":{"type":"number","description":"Number of items grouped by this value."},"data":{"type":"object","description":"Additional optional facet data.","additionalProperties":true},"label":{"type":"string","description":"Label of this group (instead of deprecated `data.displayName`)"},"value":{"type":"string","description":"Identifying value of this group. Could be an ID or a name."}}}}}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```

## Calculate Relevance Score

> Calculate a relevance score for each search content item result. \
> Arrange the results in order from most to least relevant. \
> Relevance is calculated on a scale of 0 to 1 and rounded to two decimal places.\
> \
> Permissions: users will be able to calculate relevance score only across collections they have access to.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/relevance":{"post":{"operationId":"calculateRelevanceScore","summary":"Calculate Relevance Score","description":"Calculate a relevance score for each search content item result. \nArrange the results in order from most to least relevant. \nRelevance is calculated on a scale of 0 to 1 and rounded to two decimal places.\n\nPermissions: users will be able to calculate relevance score only across collections they have access to.\n","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["query","externalIds"],"properties":{"externalIds":{"type":"array","description":"List of external ids of content items for which relevance score should be calculated","maxItems":100,"minItems":1,"items":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"}},"query":{"type":"string","description":"Search query used in Search Content Items"}}}}}},"responses":{"200":{"description":"Relevance score calculated","content":{"application/json":{"schema":{"type":"object","properties":{"results":{"type":"array","items":{"type":"object","properties":{"externalId":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"},"relevance":{"type":"number","description":"Relevance score for this content item. Rounded to two decimal places.","format":"float"}}}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```

## Get structural gems tree

> Get structural tree\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Search"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-search/tree":{"get":{"operationId":"getStructuresTree","summary":"Get structural gems tree","description":"Get structural tree\n","parameters":[{"description":"'By default `false`, when a `true` private library is included in the response'","schema":{"type":"boolean"},"in":"query","name":"includePrivateLib"},{"description":"'The `libraryId` or `folderId` where gem already exists'","schema":{"type":"string"},"in":"query","name":"locationId"},{"description":"'By default `true`, when `false` SSP libraries are excluded from the response'","schema":{"type":"boolean"},"in":"query","name":"includeSSPLibs"},{"description":"Titles will be translated to this language. If not passed, \"user's preferred search language\" or source title will be used","schema":{"type":"string"},"in":"query","name":"language"},{"description":"'Query to filter by gems titles, ignores deep nesting limit if this parameter is passed.'","schema":{"type":"string","maxLength":255,"minLength":3},"in":"query","name":"searchQuery"},{"description":"'Get gems of certain connector'","schema":{"type":"string","maxLength":60,"minLength":8},"in":"query","name":"connectorId"},{"description":"Filters libs by policy value","schema":{"type":"array","items":{"type":"string","maxLength":128,"minLength":4}},"in":"query","name":"filterLibsByPolicyActions"},{"description":"The `libraryIds` or `folderIds` where gem already exists. (will be ignored if the `locationId` parameter was passed)","schema":{"type":"array","maxItems":5,"minItems":0,"items":{"type":"string"}},"in":"query","name":"locationIds","required":false}],"responses":{"200":{"description":"The structural gems tree","content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","enum":["account_library","private_library","group","self-service_library"]},"children":{"type":"array","description":"Path to parent","items":{"type":"object","properties":{"type":{"type":"string","enum":["account_library","private_library","group","self-service_library"]},"key":{"type":"string","description":"Library id"},"parent":{"type":"string","description":"Parent id"},"path":{"type":"string","description":"Path to parent"},"title":{"type":"string","description":"Title of a gem"}}}},"key":{"type":"string","description":"Library id"},"parent":{"type":"string","description":"Parent id"},"path":{"type":"string","description":"Path to parent"},"title":{"type":"string","description":"Title of a gem"}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Search"]}}}}
```
