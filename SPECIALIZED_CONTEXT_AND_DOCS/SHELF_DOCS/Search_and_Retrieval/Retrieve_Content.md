# Retrieve Content

## List of deleted CIL Content

> Returns deleted items sorted by deletion date with filtering by deletion date.\
> \
> This API is designed for maintaining synchronization between the Shelf platform and external databases. This API endpoint provides a list of content items that have been deleted from Shelf, sorted by their deletion dates.\
> \
> It is particularly useful for applications that need to keep a 1:1 sync with their Shelf database, ensuring that deletions in Shelf are accurately reflected in the external system.\
> \
> \*\*Pagination Mechanics\*\*\
> 1\. \*\*Filter by Deletion Date\*\*: The primary method of narrowing down the list of deleted items is through the \`deletedAfter\` parameter in the request body. This parameter allows users to specify a date, returning only those items that were deleted after the given date.\
> \
> 2\. \*\*Response Data Structure\*\*: The response consists of an array of deleted items, each with details such as collection IDs, the deletion date, and the external ID of the deleted item.\
> \
> 3\. \*\*Iterative Requests for Synchronization\*\*: For applications looking to maintain synchronization, they can iteratively make requests using updated \`deletedAfter\` dates. By systematically moving the deletedAfter date forward with each request, applications can effectively track and synchronize deletions that have occurred since the last check.\
> \
> 4\. \*\*Efficient Synchronization\*\*: This approach allows for efficient and targeted data retrieval, particularly useful for systems that need to stay in sync with the Shelf platform regarding content deletions. It ensures that only relevant deletions are fetched, based on the specified deletion date.

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-content/items/list-deleted":{"post":{"operationId":"listDeletedContentItems","summary":"List of deleted CIL Content","description":"Returns deleted items sorted by deletion date with filtering by deletion date.\n\nThis API is designed for maintaining synchronization between the Shelf platform and external databases. This API endpoint provides a list of content items that have been deleted from Shelf, sorted by their deletion dates.\n\nIt is particularly useful for applications that need to keep a 1:1 sync with their Shelf database, ensuring that deletions in Shelf are accurately reflected in the external system.\n\n**Pagination Mechanics**\n1. **Filter by Deletion Date**: The primary method of narrowing down the list of deleted items is through the `deletedAfter` parameter in the request body. This parameter allows users to specify a date, returning only those items that were deleted after the given date.\n\n2. **Response Data Structure**: The response consists of an array of deleted items, each with details such as collection IDs, the deletion date, and the external ID of the deleted item.\n\n3. **Iterative Requests for Synchronization**: For applications looking to maintain synchronization, they can iteratively make requests using updated `deletedAfter` dates. By systematically moving the deletedAfter date forward with each request, applications can effectively track and synchronize deletions that have occurred since the last check.\n\n4. **Efficient Synchronization**: This approach allows for efficient and targeted data retrieval, particularly useful for systems that need to stay in sync with the Shelf platform regarding content deletions. It ensures that only relevant deletions are fetched, based on the specified deletion date.","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":false,"required":["deletedAfter"],"properties":{"deletedAfter":{"type":"string","description":"Date of deletion"}}}}}},"responses":{"200":{"description":"List of deleted CIL items","content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","maxItems":1000,"minItems":0,"items":{"type":"object","required":["collectionIds","deletedAt","externalId"],"properties":{"collectionIds":{"type":"array","description":"Collection ids where Item exists","items":{"type":"string","maxLength":64,"minLength":6}},"deletedAt":{"type":"string","description":"Deletion date"},"externalId":{"type":"string","description":"External Id"}}}}}}}}}},"tags":["Retrieve Content"]}}}}
```

## Get Content Item Locations

> Get Content Locations

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-content/items/{id}/locations":{"get":{"operationId":"getContentItemLocations","summary":"Get Content Item Locations","description":"Get Content Locations","parameters":[{"description":"External Content ID","schema":{"type":"string","maxLength":64,"minLength":1},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","required":["data"],"properties":{"data":{"type":"array","description":"Content Locations","items":{"type":"object","required":["collectionId","parentId","grandParentIds","breadcrumbs"],"properties":{"breadcrumbs":{"type":"array","description":"Locations path","items":{"type":"object","required":["id","title"],"properties":{"id":{"type":"string","description":"Collection or Folder Id","maxLength":64,"minLength":1},"title":{"type":"string","description":"Collection or Folder Title","maxLength":255,"minLength":1}}}},"collectionId":{"type":"string","description":"External Collection ID","maxLength":64,"minLength":1},"grandParentIds":{"type":"array","description":"Collection ID first and the rest of ids are external folder IDs","items":{"type":"string","maxLength":64,"minLength":1}},"parentId":{"type":"string","description":"External Parent Location ID (Collection or Folder)","maxLength":64,"minLength":1}}}}}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}},"404":{"description":"Not found","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Retrieve Content"]}}}}
```

## Get single CIL Content Item

> Used to fetch basic metadata about a single CIL content item.\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-content/items/{itemId}":{"get":{"operationId":"getCILItem","summary":"Get single CIL Content Item","description":"Used to fetch basic metadata about a single CIL content item.\n","parameters":[{"description":"External Content ID","schema":{"type":"string","maxLength":26,"minLength":26},"in":"path","name":"itemId","required":true},{"description":"Content type of the request payload.","schema":{"type":"string","default":"application/json"},"in":"header","name":"Content-Type","required":true}],"responses":{"200":{"description":"CIL Item Metadata","content":{"application/json":{"schema":{"allOf":[{"type":"object","required":["fields"],"properties":{"accountId":{"type":"string","description":"ID of account","maxLength":64,"minLength":6},"collectionIds":{"type":"array","description":"List of collection IDs this content item belongs to in external system","items":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1}},"connectorId":{"type":"string","description":"Connector ID which synced this content item to CIL"},"createdAt":{"type":"string","description":"Date when content was first created in CIL","format":"date"},"externalId":{"type":"string","description":"External content item ID, provided by CIL Connector, corresponding to id in source system"},"externalURL":{"type":"string","description":"Url pointing to content in source system"},"fields":{"type":"array","items":{"type":"object","required":["key","value","type","label"],"properties":{"type":{"type":"string"},"data":{"type":"object","additionalProperties":true},"key":{"type":"string"},"label":{"type":"string"},"value":{"type":"string"}}}},"iconURL":{"type":"string","description":"Icon url for this content item. Present if this content item corresponds to Shelf KMS gem."},"id":{"type":"string","description":"Content item ID (internal to CIL)"},"internalCollectionIds":{"type":"array","description":"List of internal collection IDs this content item belongs to in CIL","items":{"type":"string","maxLength":26,"minLength":26}},"internalId":{"type":"string","description":"Content item ID (internal to CIL)"},"lang":{"type":"string","description":"Language code of content item"},"lastViewedAt":{"type":"string","description":"Date when content was last viewed at","format":"date"},"locations":{"type":"array","description":"List of locations of this content item belongs to an external system","items":{"type":"object","required":["grandParentIds","collectionId"],"properties":{"collectionId":{"type":"string","description":"Collection ID from external system","maxLength":512,"minLength":1},"grandParentIds":{"type":"array","items":{"type":"string","maxLength":64,"minLength":6}},"parentId":{"type":"string","maxLength":64,"minLength":6}}}},"originalCreatedAt":{"type":"string","description":"Date when content was first created in source system","format":"date"},"originalUpdatedAt":{"type":"string","description":"Date when content was last updated in source system","format":"date"},"tags":{"type":"array","description":"List of tags for this content item","items":{"type":"string"}},"title":{"type":"string","description":"Content item title"},"updatedAt":{"type":"string","description":"Date when content was last updated in CIL","format":"date"}}},{"type":"object","properties":{"description":{"type":"string","description":"CIL item description"},"attachments":{"type":"array","description":"List of attachments for this content item","items":{"type":"object","description":"Attachments","properties":{"attachmentId":{"type":"string","description":"Attachment ID"},"converted":{"type":"array","description":"An array of objects, each representing a converted file format available for the attachment","items":{"type":"object","properties":{"attachmentId":{"type":"string","description":"Attachment ID"},"extension":{"type":"string","description":"The file extension of the attachment","enum":["md","txt","html","json"]}}}},"extension":{"type":"string","description":"The file extension of the attachment","enum":["pdf","docx","txt","md","html","pptx"]}}}}}}]}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"oneOf":[{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}},{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}]}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Retrieve Content"]}}}}
```

## Download Attachment

> Download Content Item Attachment\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-content/items/{itemId}/attachments/{attachmentId}/content":{"get":{"operationId":"getItemAttachmentContent","summary":"Download Attachment","description":"Download Content Item Attachment\n","parameters":[{"description":"Content Item ID","schema":{"type":"string","maxLength":64,"minLength":6},"in":"path","name":"itemId","required":true},{"description":"Attachment ID. Could be obtained from API to get 1 item.","schema":{"type":"string","maxLength":26,"minLength":26},"in":"path","name":"attachmentId","required":true}],"responses":{"200":{"description":"Success - download url","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","description":"URL to download the file. It is temporary and will expire after some time.","format":"uri"}}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"object","required":["error"],"properties":{"error":{"type":"object","description":"API Error","required":["status","message","code"],"properties":{"code":{"type":"string","description":"ERROR_CODE"},"detail":{"description":"Detail info","oneOf":[{"type":"string"},{"type":"array","items":{"type":"object","properties":{"dataPath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}}]},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Retrieve Content"]}}}}
```

## Download Attachment By Extension Format

> Download Content Item Attachment By Extension Format\
>

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/cil-content/items/{itemId}/attachments/{attachmentId}/content/converted/{extension}":{"get":{"operationId":"getItemAttachmentContentByExtensions","summary":"Download Attachment By Extension Format","description":"Download Content Item Attachment By Extension Format\n","parameters":[{"description":"Content Item ID","schema":{"type":"string","maxLength":64,"minLength":6},"in":"path","name":"itemId","required":true},{"description":"Attachment ID. Could be obtained from API to get 1 item.","schema":{"type":"string","maxLength":26,"minLength":26},"in":"path","name":"attachmentId","required":true},{"description":"The file extension of the converted file","schema":{"enum":["txt","html","md"]},"in":"path","name":"extension","required":true}],"responses":{"200":{"description":"Success - download url","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","description":"URL to download the file. It is temporary and will expire after some time.","format":"uri"}}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"object","required":["error"],"properties":{"error":{"type":"object","description":"API Error","required":["status","message","code"],"properties":{"code":{"type":"string","description":"ERROR_CODE"},"detail":{"description":"Detail info","oneOf":[{"type":"string"},{"type":"array","items":{"type":"object","properties":{"dataPath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}}]},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Retrieve Content"]}}}}
```

## Get CIL Collections

> Return all CIL collections for a given connector. To get all collections, first fetch list of available connectors via \[Get Connectors List API]\(/cil-management#tag/Connectors/operation/getConnectors)

OpenAPI:

```json
{"openapi":"3.1.0","info":{"title":"Shelf Content Integration Layer API","version":"1.0.0"},"tags":[{"name":"Retrieve Content"}],"servers":[{"description":"US region","url":"https://api.shelf.io"},{"description":"EU region","url":"https://api.shelf-eu.com"},{"description":"CA region","url":"https://api.shelf-ca.com"}],"security":[{"auth_token":[]}],"components":{"securitySchemes":{"auth_token":{"type":"apiKey","description":"Shelf API Token. See [Create API Token](https://docs.shelf.io/dev-portal/authentication/create-api-token) for more details.","in":"header","name":"Authorization"}}},"paths":{"/content-ingestion/collections/{connectorId}":{"get":{"operationId":"getCILCollectionsByConnectorId","summary":"Get CIL Collections","description":"Return all CIL collections for a given connector. To get all collections, first fetch list of available connectors via [Get Connectors List API](/cil-management#tag/Connectors/operation/getConnectors)","parameters":[{"description":"Connector ID","schema":{"type":"string","maxLength":26,"minLength":26},"in":"path","name":"connectorId","required":true}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","required":["collections"],"properties":{"collections":{"type":"array","items":{"type":"object","required":["accountId","createdAt","updatedAt","connectorId","internalId","externalId","title","syncFlowId"],"properties":{"accountId":{"type":"string","description":"ID of account","maxLength":64,"minLength":6},"connectorId":{"type":"string","maxLength":26,"minLength":26},"createdAt":{"type":"string","description":"Date of creation","format":"date-time"},"externalId":{"type":"string","maxLength":128,"minLength":1},"internalId":{"type":"string","description":"ID of collection","format":"ulid"},"syncFlowId":{"allOf":[{"type":"string","maxLength":26,"minLength":26},{"description":"Sync Flow ID"}]},"title":{"type":"string","description":"Name of collection","maxLength":255,"minLength":1},"updatedAt":{"type":"string","description":"Date of updating","format":"date-time"}}}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","title":"Bad request payload (AJV)","required":["error"],"properties":{"error":{"type":"object","description":"API Error With detail","required":["status","message","detail"],"properties":{"detail":{"type":"array","description":"Detail info","items":{"type":"object","properties":{"instancePath":{"type":"string"},"keyword":{"type":"string"},"message":{"type":"string"},"params":{"type":"object"},"schemaPath":{"type":"string"}}}},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"object","title":"API Error with code","required":["error"],"properties":{"error":{"type":"object","description":"API Error with code","required":["status","message","code"],"properties":{"code":{"type":"string","description":"Error code"},"message":{"type":"string","description":"Error message"},"status":{"type":"number","description":"Status code"}}}}}}}}},"tags":["Retrieve Content"]}}}}
```
